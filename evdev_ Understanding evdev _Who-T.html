<!DOCTYPE html> <html class=v2 dir=ltr lang=en><!--
 Page saved with SingleFile 
 url: http://who-t.blogspot.com/2016/09/understanding-evdev.html 
 saved date: Sat Jan 25 2020 18:09:25 GMT+0000 (Coordinated Universal Time)
--><meta charset=utf-8><style>:root{--sf-img-3:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACMAAAAjCAYAAAAe2bNZAAAABHNCSVQICAgIfAhkiAAABp1JREFUWIW1mE2MHEcVgL9XVd2zszvj3fWGOATZEdiREfKBSyyIFBMFByXYgRCiIBSjKNrkAEY55ARS7jkgS3BCaGUhHHvlXAyElQxYQQpeEEYCDrGEnBiMED+x117/7OzMznRXPQ7dM9M9P9YuiNLUqLqr6r2v33v1qrqFLRY9XX+VMPEYIrsJlVkkmkJNFZM28UkTNm6i6WWk87YcaX13K7JlUwA/rd5Po3YS7MNYqeAVQrdTs4r2JxgFC6RhA/zy0tduH35KaP/PMLo4t4TGhwAIWtLZH5TDaLdT+9Xk19p5S15Y/+J/BaNvTB7C1k+A2U46iqAI0lVYtNAAnAUI12k3jsjL/hejRJmR8k/VX8FOL+Hl7iBbKamCl3uo1M7qYvTSpmD0VP0VXO17pGNcMrLcbWChTxVShDC5oKei+cGRJTdlrpleGmsNvQ4hRUPxXqFtQKQOEveVj4wlwKrSaD4hR/0vu9NdSZmtn8CPAumgG6to7XH8ri8Tah9DChQKSEiR639CrryGGDBu7i4BqeARapWT0Ly3e7s3XhfnliA+NGQVvYN2mrQPnCfZ+VCuODBYFBDrkKSJ/cMi9uI3cJPbEaPIuMB2CiH5ibzY/lIPJssjM/8ctkpmkebT/8BPzSE+GfeshSIQT8DFs8S//QJRbRZTXOpdy3TbRpEX1wW6AdyonRwlVturtD/z6y2A5E/eacG+J7lz/2ukyc1yeKsOtfVH8c/7MNiHCYPuuY5OHSTZuX8IRKzNXDJYpbA4kzby0AvcuAmqYxYEZIk02AMATk/XX4U8xReLT0k/+kwWCyUSYeXi7yBNQbI+ATR4pnbtpTq7A9UAGqju2MVKJ2aitcHsZKVsvWLTSlWPu6OOMPEYo8gVQn13KVjFWq6/+xuuvfk5JqYhsn0YgDs3YM93Ar7VyCc4bH0fa60/EtkqtYovyC/o9ApWDpps9x1jwsG1GZT6R/ZgLdg1cA1wTYjWIboFc4++Tkj7LtW0Q33/t0n/BXf+fYv15lrZKr2ABpS9Dm9mR3GMNJYG4pl72fe6B5GiuOwBkwRN+puz+oT6Jw8z8ylFfcramW+hK8eoVafKQApgtjlUp1DJb/RFj09YgaS1Pq53eLhPSNeTLMB3P8na345hnaEaDbhMqRmCVofOI5vflLZUNHgQaKfQSQWk4CY0Nhia2c2BxPR/LAal44UklcwqmRs6Dg1N1NSHgmQMk4jBTkwiMh5bFfxGk/KOmoNoFm5GlNQLAjirIDQcVm+S6o7NWETE0Fr9gL8e24NTcCYT3Kua1xh2fPMy0ex9JSDJ/zIYgIAPgjOA8bcdIb2MiT6OL6rNwQazsgjtq1eoTsDUNogcGJPnmvyJBQgtCNeuwPYPD4Si5uAKBAzdNqBcckjnbUx0eCgDC3D7MphHe4dvDZ6ZT3ya6Cu/wqQdrEh3hRemKbgY9+D+LGB7HQa/+j6RycZ0QUTIdu+NcC7btU9sbxGYKD/FKh3zCBvPnUPSTlmhsSAymA3Klg2+PMdFrP7gcWqyTDWq4mwGYlEwoWleTqbynS1Z7h9A8xUls9jmefjLBXBRWVXwqE/BpxBG1WGQ9UsXsI1lrJnCdGMMRawiRt/pOoOfKZXDb8xu9ONG81+bdqPFxrN/x818CE03e4wog7RXr7G28AD1GUs1rhDZgBHNzjlO1cwnBvIjxFNCG+28haWbDTNBxEST4E7vYv2934OLMVE8+vgwWKMYXETj0gXWFh5gchpiV8HlIIIiEQj+TA+8ZP4T0yt4uaeYc1QVr206jTYf6COYPc/h5h5ECpErhYbkgeRvvI9/703c+jITNUvsKsQuZOmAgDGACVdlPr2vO718IG83jlCpnSXVvnwBS4VKrcJOf56VP58nTUcs6cLZRgRiA+LAzkwRGcWZgO2CCGBUuZV+teTSQR/rYuUlQmWBzvB7k6qiwO2WJYQsi3bzhvRySH5Nds+YbFzXNUaAWMElz8sRFu8KA6CnonnSiQU8MnyWyK7XNmy26AiFzKq9zFrMI0IOYnKLVJIjgyAw5vVWnk+O02g+gfUrPUd2vzZo1q5XUozJs6HRnjVGgRgUEwEmXOVW8tlRIGMtU7LDDys/Bvc0MPAVIms0E5NbKAMyaC9+rGR5REVV8GdkPjx7N12b+j4D+etEsAewUsVrLzeiSicxKJrHBlgDOEXT0BTj35H58PnN6Ng0TA/quDuKlYMoezWYbd5LLQTiEOg4ow3j/G0jXKITzsnXw/e3Ivs/hvM0MVfTdzgAAAAASUVORK5CYII=")}</style><style class="darkreader darkreader--user-agent" media=screen>html{background-color:#2f2f2e!important}html,body{background-color:#2f2f2e}html,body{border-color:#837f79;color:#ffffff}a{color:#6ec8ff}::placeholder{color:#fffbe4}::selection{background-color:#2983ed;color:#ffffff}::-moz-selection{background-color:#2983ed;color:#ffffff}::-webkit-scrollbar{background-color:#343433;color:#fffff5}::-webkit-scrollbar-thumb{background-color:#474745}::-webkit-scrollbar-corner{background-color:#2f2f2e}*{scrollbar-color:#474745 #343433}</style>
<style>body{margin:0}.content-outer,.main-outer,.main-inner,.post,.comments,.widget,.date-header{position:relative;min-height:0}.main-inner{padding:30px 0}.widget{margin:30px 0}.section:first-child .widget:first-child{margin-top:0}.section:last-child .widget:last-child{margin-bottom:0}a img{border:0;position:relative}h2,h3,h4{margin:0;position:relative}.widget{line-height:1.4}.item-control a,.item-action a{text-decoration:none!important}.post-body{width:100%}.post-footer-line>*{margin-right:1em}.post-footer-line>*:last-child{margin-right:0}.post-timestamp{margin-left:-1em}.post-footer-line>*:first-child{margin-left:0}.comment-body{margin:.5em 25px}.comment-footer{margin:.5em 25px 1.5em}.comment-body p{margin:0}#comments .avatar-comment-indent .comment-author{margin-left:-45px;padding-left:45px}dt{font-weight:bold}html{height:100%}body{min-height:100%;position:relative}.content{position:relative;word-wrap:break-word}.content-outer,.region-inner{min-height:0;margin:0 auto}.columns-inner{min-height:0}.column-center-outer{position:relative;float:left}.column-center-outer{width:100%}.fauxcolumns{position:relative}.fauxborder-left{background-position:top left;background-repeat:repeat-y;position:relative}body{overflow-wrap:break-word;word-break:break-word;word-wrap:break-word}.post-footer abbr{border:0}#comments-block .avatar-image-container img{-ms-interpolation-mode:bicubic;float:right}#comments-block .avatar-image-container.avatar-stock img{border-width:0;padding:1px}#comments-block .avatar-image-container{height:37px;left:-45px;position:absolute;width:37px}#comments-block.avatar-comment-indent{margin-left:45px;position:relative}#comments-block.avatar-comment-indent dd{margin-left:0}.comments{clear:both;margin-top:10px;margin-bottom:0}.comments .avatar-image-container{float:left;max-height:36px;overflow:hidden}.comments .avatar-image-container img{max-width:36px}.icon-action{border-style:none!important;margin:0 0 0 .5em!important;vertical-align:middle}</style><style class="darkreader darkreader--sync" media=screen>body{margin:0;padding:0 0 1px}.content-outer,.main-outer,.main-inner,.post,.comments,.widget,.date-header{position:relative;min-height:0}.content-inner{padding:10px}.main-inner{padding:30px 0}.main-inner .column-center-inner{padding:0 15px}.section{margin:0 15px}.widget{margin:30px 0}.section:first-child .widget:first-child{margin-top:0}.section:last-child .widget:last-child{margin-bottom:0}a img{border:none;position:relative}h2,h3,h4{margin:0;position:relative}.widget{line-height:1.4}.item-control a,.item-action a{text-decoration:none!important}.post-body{width:100%}.post-header,.post-footer{line-height:1.6}.post-footer-line>*{margin-right:1em}.post-footer-line>*:last-child{margin-right:0}.post-timestamp{margin-left:-1em}.post-footer-line>*:first-child{margin-left:0}.comment-body{margin:.5em 25px}.comment-footer{margin:.5em 25px 1.5em}.comment-body p{margin:0}#comments .avatar-comment-indent .comment-author{margin-left:-45px;padding-left:45px}dt{font-weight:bold}html{height:100%}body{min-height:100%;position:relative}.content{position:relative;word-wrap:break-word}.content-outer,.region-inner{min-height:0;margin:0 auto}.columns-inner{min-height:0}.column-center-outer{position:relative;float:left}.column-center-outer{width:100%}.fauxcolumns{position:relative}.fauxborder-left{background-position:top left;background-repeat:repeat-y;position:relative}body{overflow-wrap:break-word;word-break:break-word;word-wrap:break-word}.post-footer abbr{border:none}#comments-block .avatar-image-container img{-ms-interpolation-mode:bicubic;border:1px solid #ccc;float:right}#comments-block .avatar-image-container.avatar-stock img{border-width:0;padding:1px}#comments-block .avatar-image-container{height:37px;left:-45px;position:absolute;width:37px}#comments-block.avatar-comment-indent{margin-left:45px;position:relative}#comments-block.avatar-comment-indent dd{margin-left:0}.comments{clear:both;margin-top:10px;margin-bottom:0}.comments .avatar-image-container{float:left;max-height:36px;overflow:hidden}.comments .avatar-image-container img{max-width:36px}.icon-action{border-style:none!important;margin:0 0 0 .5em!important;vertical-align:middle}a img{border-color:currentcolor}.item-control a,.item-action a{text-decoration-color:currentcolor!important}.post-footer abbr{border-color:currentcolor}#comments-block .avatar-image-container img{border-color:rgb(96,93,88)}</style>
<meta content="width=1100" name=viewport>
<meta content=blogger name=generator>
<style class="darkreader darkreader--override" media=screen>::placeholder{opacity:0.5!important}</style>
<link href=http://who-t.blogspot.com/2016/09/understanding-evdev.html rel=canonical>
<link rel=alternate type=application/atom+xml title="Who-T - Atom" href=http://who-t.blogspot.com/feeds/posts/default>
<link rel=alternate type=application/rss+xml title="Who-T - RSS" href="http://who-t.blogspot.com/feeds/posts/default?alt=rss">
<link rel=service.post type=application/atom+xml title="Who-T - Atom" href=https://www.blogger.com/feeds/6112936277054198647/posts/default>
<link rel=alternate type=application/atom+xml title="Who-T - Atom" href=http://who-t.blogspot.com/feeds/8060802352152647757/comments/default>
<!--[if IE]><script type="text/javascript" src="https://www.blogger.com/static/v1/jsbin/1366743480-ieretrofit.js"></script>
<![endif]-->
<meta content=http://who-t.blogspot.com/2016/09/understanding-evdev.html property=og:url>
<meta content="Understanding evdev" property=og:title>
<meta content=" This post explains how the evdev protocol works. After reading this post you should understand what evdev is and how to interpret evdev eve..." property=og:description>
<!--[if IE]> <script> (function() { var html5 = ("abbr,article,aside,audio,canvas,datalist,details," + "figure,footer,header,hgroup,mark,menu,meter,nav,output," + "progress,section,time,video").split(','); for (var i = 0; i < html5.length; i++) { document.createElement(html5[i]); } try { document.execCommand('BackgroundImageCache', false, true); } catch(e) {} })(); </script> <![endif]-->
<title>Who-T: Understanding evdev</title>
<style id=page-skin-1><!--body{font:normal normal 12px Arial,Tahoma,Helvetica,FreeSans,sans-serif;color:#222222;background:#66bbdd none repeat scroll top left;padding:0 40px 40px 40px}html body .region-inner{min-width:0;max-width:100%;width:auto}h2{font-size:22px}a:link{text-decoration:none;color:#2288bb}a:visited{text-decoration:none;color:#888888}a:hover{text-decoration:underline;color:#33aaff}.content-outer{-moz-box-shadow:0 0 40px rgba(0,0,0,.15);-webkit-box-shadow:0 0 5px rgba(0,0,0,.15);-goog-ms-box-shadow:0 0 10px #333333;box-shadow:0 0 40px rgba(0,0,0,.15);margin-bottom:1px}.content-inner{padding:10px 10px}.content-inner{background-color:#ffffff}.main-outer{border-top:0 solid #eeeeee}h2.date-header{font:normal bold 11px Arial,Tahoma,Helvetica,FreeSans,sans-serif}.date-header span{background-color:transparent;color:#222222;padding:inherit;letter-spacing:inherit;margin:inherit}.main-inner{padding-top:30px;padding-bottom:30px}.main-inner .column-center-inner{padding:0 15px}.main-inner .column-center-inner .section{margin:0 15px}.post{margin:0 0 25px 0}h3.post-title,.comments h4{font:normal normal 22px Arial,Tahoma,Helvetica,FreeSans,sans-serif;margin:.75em 0 0}.post-body{font-size:110%;line-height:1.4;position:relative}.post-header{margin:0 0 1.5em;line-height:1.6;font-size:90%}.post-footer{margin:20px -2px 0;padding:5px 10px;color:#666666;background-color:#f9f9f9;border-bottom:1px solid #eeeeee;line-height:1.6;font-size:90%}#comments .comment-author{padding-top:1.5em;border-top:1px solid #eeeeee;background-position:0 1.5em}#comments .comment-author:first-child{padding-top:0;border-top:none}.avatar-image-container{margin:.2em 0 0}#comments .avatar-image-container img{border:1px solid #eeeeee}--></style><style class="darkreader darkreader--sync" media=screen>body{color:rgb(255,255,255);background-color:rgb(66,128,148);background-image:none}a:link{text-decoration-color:currentcolor;color:rgb(184,255,255)}a:visited{text-decoration-color:currentcolor;color:rgb(255,251,228)}a:hover{text-decoration-color:currentcolor;color:rgb(115,229,255)}.content-outer{box-shadow:rgba(14,13,13,0.15) 0px 0px 40px}.content-inner{background-color:rgb(47,47,46)}.main-outer{border-top-color:rgb(86,84,80)}.date-header span{background-color:transparent;color:rgb(255,255,255)}.post-footer{color:rgb(255,255,241);background-color:rgb(49,50,48);border-bottom-color:rgb(86,84,80)}#comments .comment-author{border-top-color:rgb(86,84,80)}#comments .comment-author:first-child{border-top-color:currentcolor}#comments .avatar-image-container img{border-color:rgb(86,84,80)}</style>
<style id=template-skin-1><!--body{min-width:960px}.content-outer{min-width:960px;max-width:960px}.main-inner .columns{padding-left:0;padding-right:310px}--></style>
<noscript><link href='https://www.blogger.com/dyn-css/authorization.css?targetBlogID=6112936277054198647&amp;zx=fe7d077e-b627-42da-9426-1d23c86762d9' rel='stylesheet'/></noscript>
<meta content=6112936277054198647 itemprop=blogId data-single-file-selected-content><meta content=8060802352152647757 itemprop=postId data-single-file-selected-content><meta content=https://www.blogger.com/profile/17204066043271384535 itemprop=url data-single-file-selected-content><meta content=http://who-t.blogspot.com/2016/09/understanding-evdev.html itemprop=url data-single-file-selected-content><link href="data:image/x-icon;base64,AAABAAIAICAAAAEACACoCAAAJgAAABAQAAABAAgAaAUAAM4IAAAoAAAAIAAAAEAAAAABAAgAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAmb+AIKy/gDO4v4AWp7+AL7a/gDu9v4OInr+Dp7G/gAScv4Ajr7+AN7u/gByqv4A/v7+AAAAAA4AAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAAOAAAAAP//AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP///wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAgwMDAwMDAwMAgcAAAAAAAAAAAAAAAAAAAAAAAAJDAwMDAwMDAwMDAwMDAwJAAAAAAAAAAAAAAAAAAAACQwMDAwMDAwMDAwMDAwMDAwJAAAAAAAAAAAAAAAAAAEMDAwMDAwMDAwMDAwMDAwMDAwAAAAAAAAAAAAAAAAABwwMDAwMDAwMDAwMDAwMDAwMDAcAAAAAAAAAAAAAAAACDAwMDAwDAwMDAwMDAwwMDAwMAgAAAAAAAAAAAAAAAAwMDAwMAAAAAAAAAAAAAAwMDAwMAAAAAAAAAAAAAAAADAwMDAwMAwMDAwMDAwMMDAwMDAwAAAAAAAAAAAAAAAAMDAwMDAwMDAwMDAwMDAwMDAwMDAAAAAAAAAAAAAAAAAwMDAwMDAwMDAwMDAwMDAwMDAwMAAAAAAAAAAAAAAAADAwMDAwMDAwMDAwMDAwMDAwMDAwAAAAAAAAAAAAAAAAMDAwMDAwMDAwMDAwMDAwMDAwMCgAAAAAAAAAAAAAAAAwMDAwMDAMDAwMMDAwMDAwFAQEAAAAAAAAAAAAAAAAADAwMDAwAAAAAAAAMDAwMDAEAAAAAAAAAAAAAAAAAAAACDAwMDAwDAwMDDAwMDAwMAQAAAAAAAAAAAAAAAAAAAAcMDAwMDAwMDAwMDAwMDAwIAAAAAAAAAAAAAAAAAAAAAQwMDAwMDAwMDAwMDAwMBwAAAAAAAAAAAAAAAAAAAAAACQwMDAwMDAwMDAwMDAUGAAAAAAAAAAAAAAAAAAAAAAAACQwMDAwMDAwMDAwKAQAAAAAAAAAAAAAAAAAAAAAAAAAAAQcCDAwMDAUECwgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA///AAAADgAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAABwAAAAygAAAAQAAAAIAAAAAEACAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAACZv4CgrL+gu72/s5env5ars7+vjKC/u4Scv4ijr7+nv7+/hJuqv6Ovtr+3gAAAHIAAAD+AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA//8AAAAAAAAAAAAAAAD///8AAAAAAAAAAAAAAAAAAP8AAAAAAAAAAAAAAAAAAAAAAAAAAAcCCAgICAIHAAAAAAAAAAcICAgICAgICAcAAAAAAAACCAgDAwMDCAgCAAAAAAAACAgJAAAAAAkICAAAAAAAAAgICAgICAgICAgAAAAAAAAICAgICAgICAgIAAAAAAAACAgJAAADCAgBBQAAAAAAAAIICAMDAggIBQAAAAAAAAAHCAgICAgICgAAAAAAAAAAAAcCCAgIBAYAAAAAAAAAAAAAAAAAAAAAAAAAAAD/AAAAAAAAAAAAAAAAAAD///8AAAAAAAAAAAAAAAD//8ADQSCAAcADAACAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAEAAMADgAE=" rel=icon type=image/x-icon><style>.sf-hidden{display:none!important}</style></head>
<body class=variant-pale>
<div class="navbar section" id=navbar name=Navbar style=display:none!important></div>
<div class=body-fauxcolumns style=display:none!important>
</div>
<div class=content>
<div class=content-fauxcolumns style=display:none!important>
</div>
<div class=content-outer>
<div class="content-cap-top cap-top" style=display:none!important>
</div>
<div class="fauxborder-left content-fauxborder-left">
<div class="fauxborder-right content-fauxborder-right" style=display:none!important></div>
<div class=content-inner>
<header style=display:none!important>
</header>
<div class=tabs-outer style=display:none!important>
</div>
<div class=main-outer>
<div class="main-cap-top cap-top" style=display:none!important>
</div>
<div class="fauxborder-left main-fauxborder-left">
<div class="fauxborder-right main-fauxborder-right" style=display:none!important></div>
<div class="region-inner main-inner">
<div class="columns fauxcolumns">
<div class="fauxcolumn-outer fauxcolumn-center-outer" style=display:none!important>
</div>
<div class="fauxcolumn-outer fauxcolumn-left-outer" style=display:none!important>
</div>
<div class="fauxcolumn-outer fauxcolumn-right-outer" style=display:none!important>
</div>
<div class=columns-inner>
<div class=column-center-outer>
<div class=column-center-inner>
<div class="main section" id=main name=Main><div class="widget Blog" data-version=1 id=Blog1>
<div class="blog-posts hfeed">
 <div class=date-outer>
 
<h2 class=date-header><span>Monday, September 19, 2016</span></h2>
 <div class=date-posts>
 
<div class=post-outer>
<div class="post hentry uncustomized-post-template" itemprop=blogPost itemscope itemtype=http://schema.org/BlogPosting>
<a name=8060802352152647757></a>
<h3 class="post-title entry-title" itemprop=name>
Understanding evdev
</h3>
<div class=post-header>
<div class=post-header-line-1></div>
</div>
<div class="post-body entry-content" id=post-body-8060802352152647757 itemprop="description articleBody">
<p>
This post explains how the evdev protocol works. After reading this post you
should understand what evdev is and how to interpret evdev event dumps to
understand what your device is doing. The post is aimed mainly at users
having to debug a device, I will thus leave out or simplify some of the
technical details. I'll be using the output from <a href=http://www.freedesktop.org/wiki/Evemu>evemu-record</a> as example
because that is the primary debugging tool for evdev.
</p>
<h2>What is evdev?</h2>
<p>
evdev is a Linux-only generic protocol that the kernel uses to forward
information and events about input devices to userspace. It's not just for mice and keyboards but <i>any</i> device that has any sort of
axis, key or button, including things like webcams and remote controls. Each
device is represented as a device node in the form of
<b>/dev/input/event0</b>, with the trailing number increasing as you add
more devices. The node numbers are re-used after you unplug a device, so
don't hardcode the device node into a script. The device nodes are also
only readable by root, thus you need to run any debugging tools as root too.
</p>
<p>
evdev is the primary way to talk to input devices on Linux. All X.Org
drivers on Linux use evdev as protocol and libinput as well. Note that
"evdev" is also the shortcut used for xf86-input-evdev, the X.Org
driver to handle generic evdev devices, so watch out for context when you
read "evdev" on a mailing list.
</p>
<h2>Communicating with evdev devices</h2>
<p>
Communicating with a device is simple: open the device node and read from
it. Any data coming out is a <b>struct input_event</b>, defined in
<b>/usr/include/linux/input.h</b>:
<pre>struct input_event {
 struct timeval time;
 __u16 type;
 __u16 code;
 __s32 value;
};
</pre>
I'll describe the contents later, but you can see that it's a very simple
struct.<p></p>
<p>Static information about the device such
as its name and capabilities can be queried with a set of 
<a href=http://man7.org/linux/man-pages/man2/ioctl.2.html>ioctls</a>. Note
that you should always use
<a href=https://www.freedesktop.org/wiki/Software/libevdev/>libevdev</a>
to interact with a device, it blunts the few sharp edges evdev has.
See the <a href=https://www.freedesktop.org/software/libevdev/doc/latest/>libevdev
documentation</a> for usage examples.
</p>
<p>
<b>evemu-record</b>, our primary debugging tool for anything evdev is very
simple. It reads the static information about the device, prints it and then
simply reads and prints all events as they come in. The output is in
machine-readable format but it's annotated with human-readable comments
(starting with #). You can always ignore the non-comment bits. There's a
second command, <b>evemu-describe</b>, that only prints the description and
exits without waiting for events.
</p>
<h2>Relative devices and keyboards</h2>
<p>The top part of an evemu-record output is the device description. This is
a list of static properties that tells us what the device is capable of. For
example, the USB mouse I have plugged in here prints:
<pre># Input device name: "PIXART USB OPTICAL MOUSE"
# Input device ID: bus 0x03 vendor 0x93a product 0x2510 version 0x110
# Supported events:
#   Event type 0 (EV_SYN)
#     Event code 0 (SYN_REPORT)
#     Event code 1 (SYN_CONFIG)
#     Event code 2 (SYN_MT_REPORT)
#     Event code 3 (SYN_DROPPED)
#     Event code 4 ((null))
#     Event code 5 ((null))
#     Event code 6 ((null))
#     Event code 7 ((null))
#     Event code 8 ((null))
#     Event code 9 ((null))
#     Event code 10 ((null))
#     Event code 11 ((null))
#     Event code 12 ((null))
#     Event code 13 ((null))
#     Event code 14 ((null))
#   Event type 1 (EV_KEY)
#     Event code 272 (BTN_LEFT)
#     Event code 273 (BTN_RIGHT)
#     Event code 274 (BTN_MIDDLE)
#   Event type 2 (EV_REL)
#     Event code 0 (REL_X)
#     Event code 1 (REL_Y)
#     Event code 8 (REL_WHEEL)
#   Event type 4 (EV_MSC)
#     Event code 4 (MSC_SCAN)
# Properties:
</pre>
The device name is the one (usually) set by the manufacturer and so are the
vendor and product IDs. The bus is one of the "BUS_USB" and similar
constants defined in <b>/usr/include/linux/input.h</b>. The version is often
quite arbitrary, only a few devices have something meaningful here.
<p></p>
<p>
We also have a set of supported events, categorised by "event type" and
"event code" (note how type and code are also part of the struct input_event).
The type is a general category, and
<b>/usr/include/linux/input-event-codes.h</b> defines quite a few of those.
The most important types are EV_KEY (keys and buttons), EV_REL (relative
axes) and EV_ABS (absolute axes). In the output above we can see that we
have EV_KEY and EV_REL set.
<p>
As a subitem of each type we have the event code. The event codes for this device are
self-explanatory: BTN_LEFT, BTN_RIGHT and BTN_MIDDLE are the left, right and
middle button. The axes are a relative x axis,
a relative y axis and a wheel axis (i.e. a mouse wheel). EV_MSC/MSC_SCAN is
used for raw scancodes and you can usually ignore it.
And finally we have the EV_SYN bits but let's ignore those, they are always
set for all devices.
</p>
<p>
Note that an event code cannot be on its own, it must be a tuple of (type,
code). For example, REL_X and ABS_X have the same numerical value and
without the type you won't know which one is which.
</p>
<p>
That's pretty much it. A keyboard will have a lot of EV_KEY
bits set and the EV_REL axes are obviously missing (but not always...).
Instead of BTN_LEFT, a keyboard would have e.g. KEY_ESC, KEY_A, KEY_B, etc.
90% of device
debugging is looking at the event codes and figuring out which ones are
missing or shouldn't be there.
</p>
<p><b>Exercise:</b> You should now be able to read a evemu-record
description from any mouse or keyboard device connected to your computer and
understand what it means. This also applies
to most special devices such as remotes - the only thing that changes are
the names for the keys/buttons. Just run <b>sudo evemu-describe</b> and pick any
device in the list.</p>
<h2>The events from relative devices and keyboards</h2>
<p>
evdev is a serialised protocol. It sends a series of events and then a
synchronisation event to notify us that the preceeding events all belong
together. This synchronisation event is EV_SYN SYN_REPORT, is generated by
the kernel, not the device and hence all EV_SYN codes are always available
on all devices.
</p>
<p>
Let's have a look at a mouse movement. As explained above, half the line is
machine-readable but we can ignore that bit and look at the human-readable
output on the right.
<pre>E: 0.335996 0002 0000 0001      # EV_REL / REL_X                1
E: 0.335996 0002 0001 -002      # EV_REL / REL_Y                -2
E: 0.335996 0000 0000 0000      # ------------ SYN_REPORT (0) ----------
</pre>
This means that within one hardware event, we've moved 1 device unit to
the right (x axis) and two device units up (y axis). Note how all events
have the same timestamp (0.335996).
<p></p>
<p>
Let's have a look at a button press:
<pre>E: 0.656004 0004 0004 589825    # EV_MSC / MSC_SCAN             589825
E: 0.656004 0001 0110 0001      # EV_KEY / BTN_LEFT             1
E: 0.656004 0000 0000 0000      # ------------ SYN_REPORT (0) ----------
E: 0.727002 0004 0004 589825    # EV_MSC / MSC_SCAN             589825
E: 0.727002 0001 0110 0000      # EV_KEY / BTN_LEFT             0
E: 0.727002 0000 0000 0000      # ------------ SYN_REPORT (0) ----------
</pre>
For button events, the value 1 signals button pressed, button 0 signals
button released.
<p></p>
<p>
And key events look like this:
<pre>E: 0.000000 0004 0004 458792    # EV_MSC / MSC_SCAN             458792
E: 0.000000 0001 001c 0000      # EV_KEY / KEY_ENTER            0
E: 0.000000 0000 0000 0000      # ------------ SYN_REPORT (0) ----------
E: 0.560004 0004 0004 458976    # EV_MSC / MSC_SCAN             458976
E: 0.560004 0001 001d 0001      # EV_KEY / KEY_LEFTCTRL         1
E: 0.560004 0000 0000 0000      # ------------ SYN_REPORT (0) ----------
[....]
E: 1.172732 0001 001d 0002      # EV_KEY / KEY_LEFTCTRL         2
E: 1.172732 0000 0000 0001      # ------------ SYN_REPORT (1) ----------
E: 1.200004 0004 0004 458758    # EV_MSC / MSC_SCAN             458758
E: 1.200004 0001 002e 0001      # EV_KEY / KEY_C                1
E: 1.200004 0000 0000 0000      # ------------ SYN_REPORT (0) ----------
</pre>
Mostly the same as button events. But wait, there is one difference: we have
a value of 2 as well. For key events, a value 2 means "key repeat".
If you're on the tty, then this is what generates repeat keys for you. In X
and Wayland we ignore these repeat events and instead use XKB-based key
repeat.
<p></p>
<p>
Now look at the keyboard events again and see if you can make sense of the sequence.
We have an Enter release (but no press), then ctrl down (and repeat),
followed by a 'c' press - but no release. The explanation is simple - as
soon as I hit enter in the terminal, evemu-record started recording so it
captured the enter release too. And it stopped recording as soon as ctrl+c
was down because that's when it was cancelled by the terminal. One important
takeaway here: the evdev protocol is not guaranteed to be balanced. You may
see a release for a key you've never seen the press for, and you may be
missing a release for a key/button you've seen the press for (this happens
when you stop recording). Oh, and there's one danger:
if you record your keyboard and you type your password, the keys will show
up in the output. Security experts generally reocmmend not publishing event
logs with your password in it. 
<p> 
<p><b>Exercise:</b> You should now be able to read a evemu-record
events list from any mouse or keyboard device connected to your computer and
understand the event sequence.This also applies to most special devices such as
remotes - the only thing that changes are the names for the keys/buttons.
Just run <b>sudo evemu-record</b> and pick any device listed.</p>
<h2>Absolute devices</h2>
<p>Things get a bit more complicated when we look at absolute input devices
like a touchscreen or a touchpad. Yes, touchpads are absolute devices in
hardware and the conversion to relative events is done in userspace by e.g.
libinput. The output of my touchpad is below. Note that I've manually removed a few
bits to make it easier to grasp, they will appear later in the multitouch
discussion.
<pre># Input device name: "SynPS/2 Synaptics TouchPad"
# Input device ID: bus 0x11 vendor 0x02 product 0x07 version 0x1b1
# Supported events:
#   Event type 0 (EV_SYN)
#     Event code 0 (SYN_REPORT)
#     Event code 1 (SYN_CONFIG)
#     Event code 2 (SYN_MT_REPORT)
#     Event code 3 (SYN_DROPPED)
#     Event code 4 ((null))
#     Event code 5 ((null))
#     Event code 6 ((null))
#     Event code 7 ((null))
#     Event code 8 ((null))
#     Event code 9 ((null))
#     Event code 10 ((null))
#     Event code 11 ((null))
#     Event code 12 ((null))
#     Event code 13 ((null))
#     Event code 14 ((null))
#   Event type 1 (EV_KEY)
#     Event code 272 (BTN_LEFT)
#     Event code 325 (BTN_TOOL_FINGER)
#     Event code 328 (BTN_TOOL_QUINTTAP)
#     Event code 330 (BTN_TOUCH)
#     Event code 333 (BTN_TOOL_DOUBLETAP)
#     Event code 334 (BTN_TOOL_TRIPLETAP)
#     Event code 335 (BTN_TOOL_QUADTAP)
#   Event type 3 (EV_ABS)
#     Event code 0 (ABS_X)
#       Value   2919
#       Min     1024
#       Max     5112
#       Fuzz       0
#       Flat       0
#       Resolution 42
#     Event code 1 (ABS_Y)
#       Value   3711
#       Min     2024
#       Max     4832
#       Fuzz       0
#       Flat       0
#       Resolution 42
#     Event code 24 (ABS_PRESSURE)
#       Value      0
#       Min        0
#       Max      255
#       Fuzz       0
#       Flat       0
#       Resolution 0
#     Event code 28 (ABS_TOOL_WIDTH)
#       Value      0
#       Min        0
#       Max       15
#       Fuzz       0
#       Flat       0
#       Resolution 0
# Properties:
#   Property  type 0 (INPUT_PROP_POINTER)
#   Property  type 2 (INPUT_PROP_BUTTONPAD)
#   Property  type 4 (INPUT_PROP_TOPBUTTONPAD)
</pre>
We have a BTN_LEFT again and a set of other buttons that I'll explain in a
second. But first we look at the EV_ABS output. We have the same naming
system as above. ABS_X and ABS_Y are the x and y axis on the device,
ABS_PRESSURE is an (arbitrary) ranged pressure value.
<p></p>
<p>
Absolute axes have a bit more
state than just a simple bit. Specifically, they have a minimum and maximum 
(not all hardware has the top-left sensor position on 0/0, it can
be an arbitrary position, specified by the minimum). Notable here is that
the axis ranges are simply the ones announced by the device - there is no
guarantee that the values fall within this range and indeed a lot of
touchpad devices tend to send values slightly outside that range.
Fuzz and flat can be safely ignored, but resolution is interesting. It is
given in units per millimeter and thus tells us the size of the device. in
the above case: (5112 - 1024)/42 means the device is 97mm wide. The
resolution is quite commonly wrong, 
a lot of <a href=https://github.com/systemd/systemd/blob/master/hwdb/60-evdev.hwdb>axis
overrides</a> need the resolution changed
to the correct value.
</p>
<p>
The axis description also has a current value listed. The kernel only sends
events when the value changes, so even if the actual hardware keeps sending
events, you may never see them in the output if the value remains the same.
In other words, holding a finger perfectly still on a touchpad creates
plenty of hardware events, but you won't see anything coming out of the
event node.
</p>
<p>
Finally, we have properties on this device. These are used to indicate
general information about the device that's not otherwise obvious. In this
case INPUT_PROP_POINTER tells us that we need a pointer for this device (it
is a touchpad after all, a touchscreen would instead have INPUT_PROP_DIRECT
set). INPUT_PROP_BUTTONPAD means that this is a so-called clickpad, it does
not have separate physical buttons but instead the whole touchpad clicks.
Ignore INPUT_PROP_TOPBUTTONPAD because it only applies to the Lenovo *40
series of devices.
</p>
<p>Ok, back to the buttons: aside from BTN_LEFT, we have BTN_TOUCH. This one
signals that the user is touching the surface of the touchpad (with some
in-kernel defined minimum pressure value). It's not just for finger-touches,
it's also used for graphics tablet stylus touchpes (so really, it's more
"contact" than "touch" but meh).
</p>
<p>
The BTN_TOOL_FINGER event tells us that a finger is in detectable range. This
gives us two bits of information: first, we have a finger (a tablet would have
e.g. BTN_TOOL_PEN) and second, we may have a finger in proximity without
touching. On many touchpads, BTN_TOOL_FINGER and BTN_TOUCH come in the same
event, but others can detect a finger hovering over the touchpad too (in which
case you'd also hope for ABS_DISTANCE being available on the touchpad).
</p>
<p>
Finally, the BTN_TOOL_DOUBLETAP up to BTN_TOOL_QUINTTAP tell us whether the
device can detect 2 through to 5 fingers on the touchpad. This doesn't actually
<i>track</i> the fingers, it merely tells you "3 fingers down" in the case of
BTN_TOOL_TRIPLETAP.
</p>
<b>Exercise:</b> Look at your touchpad's description and figure out if the size
of the touchpad is correct based on the axis information [1]. Check how many
fingers your touchpad can detect and whether it can do pressure or distance detection. 
<p></p>
<h2>The events from absolute devices</h2>
<p>
Events from absolute axes are not really any different than events from
relative devices which we already covered. The same type/code combination with
a value and a timestamp, all framed by EV_SYN SYN_REPORT events. Here's an
example of me touching the touchpad:
<pre>E: 0.000001 0001 014a 0001      # EV_KEY / BTN_TOUCH            1
E: 0.000001 0003 0000 3335      # EV_ABS / ABS_X                3335
E: 0.000001 0003 0001 3308      # EV_ABS / ABS_Y                3308
E: 0.000001 0003 0018 0069      # EV_ABS / ABS_PRESSURE         69
E: 0.000001 0001 0145 0001      # EV_KEY / BTN_TOOL_FINGER      1
E: 0.000001 0000 0000 0000      # ------------ SYN_REPORT (0) ---------- +0ms
E: 0.021751 0003 0018 0070      # EV_ABS / ABS_PRESSURE         70
E: 0.021751 0000 0000 0000      # ------------ SYN_REPORT (0) ---------- +21ms
E: 0.043908 0003 0000 3334      # EV_ABS / ABS_X                3334
E: 0.043908 0003 0001 3309      # EV_ABS / ABS_Y                3309
E: 0.043908 0003 0018 0065      # EV_ABS / ABS_PRESSURE         65
E: 0.043908 0000 0000 0000      # ------------ SYN_REPORT (0) ---------- +22ms
E: 0.052469 0001 014a 0000      # EV_KEY / BTN_TOUCH            0
E: 0.052469 0003 0018 0000      # EV_ABS / ABS_PRESSURE         0
E: 0.052469 0001 0145 0000      # EV_KEY / BTN_TOOL_FINGER      0
E: 0.052469 0000 0000 0000      # ------------ SYN_REPORT (0) ---------- +9ms
</pre>
In the first event you see BTN_TOOL_FINGER and BTN_TOUCH set (this touchpad
doesn't detect hovering fingers). An x/y coordinate pair and a pressure value.
The pressure changes in the second event, the third event changes pressure and
location. Finally, we have BTN_TOOL_FINGER and BTN_TOUCH released on finger up,
and the pressure value goes back to 0. Notice how the second event didn't
contain any x/y coordinates? As I said above, the kernel only sends updates on
absolute axes when the value changed. <p></p>
<p>
<p>
Ok, let's look at a three-finger tap (again, minus the ABS_MT_ bits):
<pre>E: 0.000001 0001 014a 0001      # EV_KEY / BTN_TOUCH            1
E: 0.000001 0003 0000 2149      # EV_ABS / ABS_X                2149
E: 0.000001 0003 0001 3747      # EV_ABS / ABS_Y                3747
E: 0.000001 0003 0018 0066      # EV_ABS / ABS_PRESSURE         66
E: 0.000001 0001 014e 0001      # EV_KEY / BTN_TOOL_TRIPLETAP   1
E: 0.000001 0000 0000 0000      # ------------ SYN_REPORT (0) ---------- +0ms
E: 0.034209 0003 0000 2148      # EV_ABS / ABS_X                2148
E: 0.034209 0003 0018 0064      # EV_ABS / ABS_PRESSURE         64
E: 0.034209 0000 0000 0000      # ------------ SYN_REPORT (0) ---------- +34ms
[...]
E: 0.138510 0003 0000 4286      # EV_ABS / ABS_X                4286
E: 0.138510 0003 0001 3350      # EV_ABS / ABS_Y                3350
E: 0.138510 0003 0018 0055      # EV_ABS / ABS_PRESSURE         55
E: 0.138510 0001 0145 0001      # EV_KEY / BTN_TOOL_FINGER      1
E: 0.138510 0001 014e 0000      # EV_KEY / BTN_TOOL_TRIPLETAP   0
E: 0.138510 0000 0000 0000      # ------------ SYN_REPORT (0) ---------- +23ms
E: 0.147834 0003 0000 4287      # EV_ABS / ABS_X                4287
E: 0.147834 0003 0001 3351      # EV_ABS / ABS_Y                3351
E: 0.147834 0003 0018 0037      # EV_ABS / ABS_PRESSURE         37
E: 0.147834 0000 0000 0000      # ------------ SYN_REPORT (0) ---------- +9ms
E: 0.157151 0001 014a 0000      # EV_KEY / BTN_TOUCH            0
E: 0.157151 0003 0018 0000      # EV_ABS / ABS_PRESSURE         0
E: 0.157151 0001 0145 0000      # EV_KEY / BTN_TOOL_FINGER      0
E: 0.157151 0000 0000 0000      # ------------ SYN_REPORT (0) ---------- +10ms
</pre>
In the first event, the touchpad detected all three fingers at the same time.
So get BTN_TOUCH, x/y/pressure and BTN_TOOL_TRIPLETAP set. Note that the
various BTN_TOOL_* bits are mutually exclusive. BTN_TOOL_FINGER means
"exactly 1 finger down" and you can't have exactly 1 finger down when you have
three fingers down. In the second event x and pressure update (y has no event,
it stayed the same).
<p></p>
<p>
In the event after the break, we switch from three fingers to one finger.
BTN_TOOL_TRIPLETAP is released, BTN_TOOL_FINGER is set. That's very common.
Humans aren't robots, you can't release all fingers at exactly the same time, so
depending on the hardware scanout rate you have intermediate states where one
finger has left already, others are still down. In this case I released two
fingers between scanouts, one was still down. It's not uncommon to see a full
cycle from BTN_TOOL_FINGER to BTN_TOOL_DOUBLETAP to BTN_TOOL_TRIPLETAP on finger
down or the reverse on finger up.
</p>
<b>Exercise:</b> test out the pressure values on your touchpad and see how close
you can get to the actual announced range. Check how accurate the multifinger
detection is by tapping with two, three, four and five fingers. (In both cases,
you'll likely find that it's very much hit and miss).
 <p></p> 
<h2>Multitouch and slots</h2>
<p>
Now we're at the most complicated topic regarding evdev devices. In the
case of multitouch devices, we need to send multiple touches on the same
axes. So we need an additional dimension and that is called <b>multitouch
slots</b> (there is another, older multitouch protocol that doesn't use
slots but it is so rare now that you don't need to bother).
</p>
<p>
First: all axes that are multitouch-capable are repeated as ABS_MT_foo axis.
So if you have ABS_X, you also get ABS_MT_POSITION_X and both axes have the
same axis ranges and resolutions. The reason here is
backwards-compatibility: if a device only sends multitouch events, older
programs only listening to the ABS_X etc. events won't work. Some axes may
only be available for single-touch (ABS_MT_TOOL_WIDTH in this case).
<p>
<p>
Let's have a look at my touchpad, this time without the axes removed:
<pre># Input device name: "SynPS/2 Synaptics TouchPad"
# Input device ID: bus 0x11 vendor 0x02 product 0x07 version 0x1b1
# Supported events:
#   Event type 0 (EV_SYN)
#     Event code 0 (SYN_REPORT)
#     Event code 1 (SYN_CONFIG)
#     Event code 2 (SYN_MT_REPORT)
#     Event code 3 (SYN_DROPPED)
#     Event code 4 ((null))
#     Event code 5 ((null))
#     Event code 6 ((null))
#     Event code 7 ((null))
#     Event code 8 ((null))
#     Event code 9 ((null))
#     Event code 10 ((null))
#     Event code 11 ((null))
#     Event code 12 ((null))
#     Event code 13 ((null))
#     Event code 14 ((null))
#   Event type 1 (EV_KEY)
#     Event code 272 (BTN_LEFT)
#     Event code 325 (BTN_TOOL_FINGER)
#     Event code 328 (BTN_TOOL_QUINTTAP)
#     Event code 330 (BTN_TOUCH)
#     Event code 333 (BTN_TOOL_DOUBLETAP)
#     Event code 334 (BTN_TOOL_TRIPLETAP)
#     Event code 335 (BTN_TOOL_QUADTAP)
#   Event type 3 (EV_ABS)
#     Event code 0 (ABS_X)
#       Value   5112
#       Min     1024
#       Max     5112
#       Fuzz       0
#       Flat       0
#       Resolution 41
#     Event code 1 (ABS_Y)
#       Value   2930
#       Min     2024
#       Max     4832
#       Fuzz       0
#       Flat       0
#       Resolution 37
#     Event code 24 (ABS_PRESSURE)
#       Value      0
#       Min        0
#       Max      255
#       Fuzz       0
#       Flat       0
#       Resolution 0
#     Event code 28 (ABS_TOOL_WIDTH)
#       Value      0
#       Min        0
#       Max       15
#       Fuzz       0
#       Flat       0
#       Resolution 0
#     Event code 47 (ABS_MT_SLOT)
#       Value      0
#       Min        0
#       Max        1
#       Fuzz       0
#       Flat       0
#       Resolution 0
#     Event code 53 (ABS_MT_POSITION_X)
#       Value      0
#       Min     1024
#       Max     5112
#       Fuzz       8
#       Flat       0
#       Resolution 41
#     Event code 54 (ABS_MT_POSITION_Y)
#       Value      0
#       Min     2024
#       Max     4832
#       Fuzz       8
#       Flat       0
#       Resolution 37
#     Event code 57 (ABS_MT_TRACKING_ID)
#       Value      0
#       Min        0
#       Max    65535
#       Fuzz       0
#       Flat       0
#       Resolution 0
#     Event code 58 (ABS_MT_PRESSURE)
#       Value      0
#       Min        0
#       Max      255
#       Fuzz       0
#       Flat       0
#       Resolution 0
# Properties:
#   Property  type 0 (INPUT_PROP_POINTER)
#   Property  type 2 (INPUT_PROP_BUTTONPAD)
#   Property  type 4 (INPUT_PROP_TOPBUTTONPAD)
</pre>
We have an x and y position for multitouch as well as a pressure axis.
There are also two special multitouch axes that aren't really axes.
<b>ABS_MT_SLOT</b> and <b>ABS_MT_TRACKING_ID</b>. The former specifies which
slot is currently active, the latter is used to track touch points.
<p></p>
<p>
Slots are a static property of a device. My touchpad, as you can see above
ony supports 2 slots (min 0, max 1) and thus can track 2 fingers at a
time. Whenever the first finger is set down it's coordinates will be tracked
in slot 0, the second finger will be tracked in slot 1. When the finger in
slot 0 is lifted, the second finger continues to be tracked in slot 1, and
if a new finger is set down, it will be tracked in slot 0. Sounds more
complicated than it is, think of it as an array of possible touchpoints.
</p>
<p>
The tracking ID is an incrementing number that lets us tell touch
points apart and also tells us when a touch starts and when it ends. The two
values are either -1 or a positive number. Any positive number means "new touch"
and -1 means "touch ended". So when you put two fingers down and lift them
again, you'll get a tracking ID of 1 in slot 0, a tracking ID of 2 in slot
1, then a tracking ID of -1 in both slots to signal they ended. The tracking
ID value itself is meaningless, it simply increases as touches are created.
</p>
<p>
Let's look at a single tap:
<pre>E: 0.000001 0003 0039 0387 # EV_ABS / ABS_MT_TRACKING_ID   387
E: 0.000001 0003 0035 2560 # EV_ABS / ABS_MT_POSITION_X    2560
E: 0.000001 0003 0036 2905 # EV_ABS / ABS_MT_POSITION_Y    2905
E: 0.000001 0003 003a 0059 # EV_ABS / ABS_MT_PRESSURE      59
E: 0.000001 0001 014a 0001 # EV_KEY / BTN_TOUCH            1
E: 0.000001 0003 0000 2560 # EV_ABS / ABS_X                2560
E: 0.000001 0003 0001 2905 # EV_ABS / ABS_Y                2905
E: 0.000001 0003 0018 0059 # EV_ABS / ABS_PRESSURE         59
E: 0.000001 0001 0145 0001 # EV_KEY / BTN_TOOL_FINGER      1
E: 0.000001 0000 0000 0000 # ------------ SYN_REPORT (0) ---------- +0ms
E: 0.021690 0003 003a 0067 # EV_ABS / ABS_MT_PRESSURE      67
E: 0.021690 0003 0018 0067 # EV_ABS / ABS_PRESSURE         67
E: 0.021690 0000 0000 0000 # ------------ SYN_REPORT (0) ---------- +21ms
E: 0.033482 0003 003a 0068 # EV_ABS / ABS_MT_PRESSURE      68
E: 0.033482 0003 0018 0068 # EV_ABS / ABS_PRESSURE         68
E: 0.033482 0000 0000 0000 # ------------ SYN_REPORT (0) ---------- +12ms
E: 0.044268 0003 0035 2561 # EV_ABS / ABS_MT_POSITION_X    2561
E: 0.044268 0003 0000 2561 # EV_ABS / ABS_X                2561
E: 0.044268 0000 0000 0000 # ------------ SYN_REPORT (0) ---------- +11ms
E: 0.054093 0003 0035 2562 # EV_ABS / ABS_MT_POSITION_X    2562
E: 0.054093 0003 003a 0067 # EV_ABS / ABS_MT_PRESSURE      67
E: 0.054093 0003 0000 2562 # EV_ABS / ABS_X                2562
E: 0.054093 0003 0018 0067 # EV_ABS / ABS_PRESSURE         67
E: 0.054093 0000 0000 0000 # ------------ SYN_REPORT (0) ---------- +10ms
E: 0.064891 0003 0035 2569 # EV_ABS / ABS_MT_POSITION_X    2569
E: 0.064891 0003 0036 2903 # EV_ABS / ABS_MT_POSITION_Y    2903
E: 0.064891 0003 003a 0059 # EV_ABS / ABS_MT_PRESSURE      59
E: 0.064891 0003 0000 2569 # EV_ABS / ABS_X                2569
E: 0.064891 0003 0001 2903 # EV_ABS / ABS_Y                2903
E: 0.064891 0003 0018 0059 # EV_ABS / ABS_PRESSURE         59
E: 0.064891 0000 0000 0000 # ------------ SYN_REPORT (0) ---------- +10ms
E: 0.073634 0003 0039 -001 # EV_ABS / ABS_MT_TRACKING_ID   -1
E: 0.073634 0001 014a 0000 # EV_KEY / BTN_TOUCH            0
E: 0.073634 0003 0018 0000 # EV_ABS / ABS_PRESSURE         0
E: 0.073634 0001 0145 0000 # EV_KEY / BTN_TOOL_FINGER      0
E: 0.073634 0000 0000 0000 # ------------ SYN_REPORT (0) ---------- +9ms
</pre>
We have a tracking ID (387) signalling finger down, as well as a position
plus pressure. then some updates and eventually a tracking ID of -1
(signalling finger up). Notice how there is no ABS_MT_SLOT here - the kernel
buffers those too so while you stay in the same slot (0 in this case) you
don't see any events for it. Also notice how you get both single-finger as
well as multitouch in the same event stream. This is for backwards
compatibility [2]
<p></p>
<p>
Ok, time for a two-finger tap:
<pre>E: 0.000001 0003 0039 0496 # EV_ABS / ABS_MT_TRACKING_ID   496
E: 0.000001 0003 0035 2609 # EV_ABS / ABS_MT_POSITION_X    2609
E: 0.000001 0003 0036 3791 # EV_ABS / ABS_MT_POSITION_Y    3791
E: 0.000001 0003 003a 0054 # EV_ABS / ABS_MT_PRESSURE      54
E: 0.000001 0003 002f 0001 # EV_ABS / ABS_MT_SLOT          1
E: 0.000001 0003 0039 0497 # EV_ABS / ABS_MT_TRACKING_ID   497
E: 0.000001 0003 0035 3012 # EV_ABS / ABS_MT_POSITION_X    3012
E: 0.000001 0003 0036 3088 # EV_ABS / ABS_MT_POSITION_Y    3088
E: 0.000001 0003 003a 0056 # EV_ABS / ABS_MT_PRESSURE      56
E: 0.000001 0001 014a 0001 # EV_KEY / BTN_TOUCH            1
E: 0.000001 0003 0000 2609 # EV_ABS / ABS_X                2609
E: 0.000001 0003 0001 3791 # EV_ABS / ABS_Y                3791
E: 0.000001 0003 0018 0054 # EV_ABS / ABS_PRESSURE         54
E: 0.000001 0001 014d 0001 # EV_KEY / BTN_TOOL_DOUBLETAP   1
E: 0.000001 0000 0000 0000 # ------------ SYN_REPORT (0) ---------- +0ms
E: 0.012909 0003 002f 0000 # EV_ABS / ABS_MT_SLOT          0
E: 0.012909 0003 0039 -001 # EV_ABS / ABS_MT_TRACKING_ID   -1
E: 0.012909 0003 002f 0001 # EV_ABS / ABS_MT_SLOT          1
E: 0.012909 0003 0039 -001 # EV_ABS / ABS_MT_TRACKING_ID   -1
E: 0.012909 0001 014a 0000 # EV_KEY / BTN_TOUCH            0
E: 0.012909 0003 0018 0000 # EV_ABS / ABS_PRESSURE         0
E: 0.012909 0001 014d 0000 # EV_KEY / BTN_TOOL_DOUBLETAP   0
E: 0.012909 0000 0000 0000 # ------------ SYN_REPORT (0) ---------- +12ms
</pre>
This was a really quick two-finger tap that illustrates the tracking IDs nicely.
In the first event we get a touch down, then an ABS_MT_SLOT event. This
tells us that subsequent events belong to the other slot, so it's the other
finger. There too we get a tracking ID + position. In the next event we get
an ABS_MT_SLOT to switch back to slot 0. Tracking ID of -1 means that touch
ended, and then we see the touch in slot 1 ended too. 
<p></p>
<p>
Time for a two-finger scroll:
<pre>E: 0.000001 0003 0039 0557 # EV_ABS / ABS_MT_TRACKING_ID   557
E: 0.000001 0003 0035 2589 # EV_ABS / ABS_MT_POSITION_X    2589
E: 0.000001 0003 0036 3363 # EV_ABS / ABS_MT_POSITION_Y    3363
E: 0.000001 0003 003a 0048 # EV_ABS / ABS_MT_PRESSURE      48
E: 0.000001 0003 002f 0001 # EV_ABS / ABS_MT_SLOT          1
E: 0.000001 0003 0039 0558 # EV_ABS / ABS_MT_TRACKING_ID   558
E: 0.000001 0003 0035 3512 # EV_ABS / ABS_MT_POSITION_X    3512
E: 0.000001 0003 0036 3028 # EV_ABS / ABS_MT_POSITION_Y    3028
E: 0.000001 0003 003a 0044 # EV_ABS / ABS_MT_PRESSURE      44
E: 0.000001 0001 014a 0001 # EV_KEY / BTN_TOUCH            1
E: 0.000001 0003 0000 2589 # EV_ABS / ABS_X                2589
E: 0.000001 0003 0001 3363 # EV_ABS / ABS_Y                3363
E: 0.000001 0003 0018 0048 # EV_ABS / ABS_PRESSURE         48
E: 0.000001 0001 014d 0001 # EV_KEY / BTN_TOOL_DOUBLETAP   1
E: 0.000001 0000 0000 0000 # ------------ SYN_REPORT (0) ---------- +0ms
E: 0.027960 0003 002f 0000 # EV_ABS / ABS_MT_SLOT          0
E: 0.027960 0003 0035 2590 # EV_ABS / ABS_MT_POSITION_X    2590
E: 0.027960 0003 0036 3395 # EV_ABS / ABS_MT_POSITION_Y    3395
E: 0.027960 0003 003a 0046 # EV_ABS / ABS_MT_PRESSURE      46
E: 0.027960 0003 002f 0001 # EV_ABS / ABS_MT_SLOT          1
E: 0.027960 0003 0035 3511 # EV_ABS / ABS_MT_POSITION_X    3511
E: 0.027960 0003 0036 3052 # EV_ABS / ABS_MT_POSITION_Y    3052
E: 0.027960 0003 0000 2590 # EV_ABS / ABS_X                2590
E: 0.027960 0003 0001 3395 # EV_ABS / ABS_Y                3395
E: 0.027960 0003 0018 0046 # EV_ABS / ABS_PRESSURE         46
E: 0.027960 0000 0000 0000 # ------------ SYN_REPORT (0) ---------- +27ms
E: 0.051720 0003 002f 0000 # EV_ABS / ABS_MT_SLOT          0
E: 0.051720 0003 0035 2609 # EV_ABS / ABS_MT_POSITION_X    2609
E: 0.051720 0003 0036 3447 # EV_ABS / ABS_MT_POSITION_Y    3447
E: 0.051720 0003 002f 0001 # EV_ABS / ABS_MT_SLOT          1
E: 0.051720 0003 0036 3080 # EV_ABS / ABS_MT_POSITION_Y    3080
E: 0.051720 0003 0000 2609 # EV_ABS / ABS_X                2609
E: 0.051720 0003 0001 3447 # EV_ABS / ABS_Y                3447
E: 0.051720 0000 0000 0000 # ------------ SYN_REPORT (0) ---------- +24ms
[...]
E: 0.272034 0003 002f 0000 # EV_ABS / ABS_MT_SLOT          0
E: 0.272034 0003 0039 -001 # EV_ABS / ABS_MT_TRACKING_ID   -1
E: 0.272034 0003 002f 0001 # EV_ABS / ABS_MT_SLOT          1
E: 0.272034 0003 0039 -001 # EV_ABS / ABS_MT_TRACKING_ID   -1
E: 0.272034 0001 014a 0000 # EV_KEY / BTN_TOUCH            0
E: 0.272034 0003 0018 0000 # EV_ABS / ABS_PRESSURE         0
E: 0.272034 0001 014d 0000 # EV_KEY / BTN_TOOL_DOUBLETAP   0
E: 0.272034 0000 0000 0000 # ------------ SYN_REPORT (0) ---------- +30ms
</pre>
Note that "scroll" is something handled in userspace, so what you see here
is just a two-finger move. Everything in there i something we've already
seen, but pay attention to the two middle events: as updates come in for
each finger, the ABS_MT_SLOT changes before the upates are sent. The kernel
filter for identical events is still in effect, so in the third event we
don't get an update for the X position on slot 1. The filtering is
per-touchpoint, so in this case this means that slot 1 position x is still
on 3511, just as it was in the previous event.
<p></p>
<p>
That's all you have to remember, really. If you think of evdev as a
serialised way of sending an array of touchpoints, with the slots as the
indices then it should be fairly clear. The rest is then just about actually
looking at the touch positions and making sense of them.
</p>
<p><b>Exercise:</b> do a pinch gesture on your touchpad. See if you can
track the two fingers moving closer together. Then do the same but only move
one finger. See how the non-moving finger gets less updates.
</p>
<p>That's it. There are a few more details to evdev but much of that is just
more event types and codes. The few details you really have to worry about
when processing events are either documented in libevdev or abstracted away
completely. The above should be enough to understand what your device does,
and what goes wrong when your device isn't working. Good luck.
</p>
<p>
<small>
[1] If not, file a bug against systemd's hwdb and CC me so we can put
corrections in<br>
[2] We treat some MT-capable touchpads as single-touch devices in libinput
because the MT data is garbage<br>
</small>
</p>
<div style=clear:both></div>
</div>
<div class=post-footer>
<div class="post-footer-line post-footer-line-1">
<span class="post-author vcard">
Posted by
<span class=fn itemprop=author itemscope itemtype=http://schema.org/Person>
<a class=g-profile href=https://www.blogger.com/profile/17204066043271384535 rel=author title="author profile" data-gapiscan=true data-onload=true data-gapiattached=true>
<span itemprop=name>Peter Hutterer</span>
</a>
</span>
</span>
<span class=post-timestamp>
at
<a class=timestamp-link href=http://who-t.blogspot.com/2016/09/understanding-evdev.html rel=bookmark title="permanent link"><abbr class=published itemprop=datePublished title=2016-09-19T13:50:00+10:00>1:50 PM</abbr></a>
</span>
<span class=reaction-buttons>
</span>
<span class=post-comment-link>
</span>
<span class="post-backlinks post-comment-link">
</span>
<span class=post-icons>
<span class=item-action>
<a href="https://www.blogger.com/email-post.g?blogID=6112936277054198647&amp;postID=8060802352152647757" title="Email Post">
<img alt class=icon-action src="data:image/gif;base64,R0lGODlhEgANAOMAAIqKioCAgOXl5f////Ly8urq6uTk5AAAAMzMzLS0tBoaGjMzM2ZmZk1NTf///////ywAAAAAEgANAAAEWRDISSsIk+jN+QUIQAxkaRIgVoSjWaKIoa6iOxygIQNFz56Lg27X89UOisMiqZv1AAnRgdFYHoROqEAAQCqZxIJ2SxYsA03euLw9CBJozJpdhmMC+Lx+j48AADs=" width=18 height=13>
</a>
</span>
<span class="item-control blog-admin pid-2136076424 sf-hidden">
<a href="https://www.blogger.com/post-edit.g?blogID=6112936277054198647&amp;postID=8060802352152647757&amp;from=pencil" title="Edit Post">
</a>
</span>
</span>
<div class="post-share-buttons goog-inline-block sf-hidden">
</div>
</div>
<div class="post-footer-line post-footer-line-2">
<span class=post-labels>
Labels:
<a href=http://who-t.blogspot.com/search/label/evdev rel=tag>evdev</a>
</span>
</div>
<div class="post-footer-line post-footer-line-3">
<span class=post-location>
</span>
</div>
</div>
</div>
<div class=comments id=comments>
<a name=comments></a>
<h4>14 comments:</h4>
<div id=Blog1_comments-block-wrapper>
<dl class=avatar-comment-indent id=comments-block>
<dt class=comment-author id=c5834603727419934899>
<a name=c5834603727419934899></a>
<div class="avatar-image-container avatar-stock"><span dir=ltr><a href=https://www.blogger.com/profile/09315812426732221936 target rel=nofollow class=avatar-hovercard id=av-5834603727419934899-09315812426732221936><img src='data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="35" height="35"><rect fill-opacity="0"/></svg>' alt title="Olav Vitters" style="background-blend-mode:normal!important;background-clip:content-box!important;background-position:50% 50%!important;background-color:rgba(0,0,0,0)!important;background-image:var(--sf-img-3)!important;background-size:100% 100%!important;background-origin:content-box!important;background-repeat:no-repeat!important" width=35 height=35>
</a></span></div>
<a href=https://www.blogger.com/profile/09315812426732221936 rel=nofollow>Olav Vitters</a>
said...
</dt>
<dd class=comment-body id=Blog1_cmt-5834603727419934899>
<p>
I decided to only read the end. What's a touchpoing? Typo or does it actually mean something.
</p>
</dd>
<dd class=comment-footer>
<span class=comment-timestamp>
<a href="http://who-t.blogspot.com/2016/09/understanding-evdev.html?showComment=1474285641302#c5834603727419934899" title="comment permalink">
September 19, 2016 at 9:47 PM
</a>
<span class="item-control blog-admin pid-1374049465 sf-hidden">
<a class=comment-delete href="https://www.blogger.com/delete-comment.g?blogID=6112936277054198647&amp;postID=5834603727419934899" title="Delete Comment">
</a>
</span>
</span>
</dd>
<dt class="comment-author blog-author" id=c2814346946772241488>
<a name=c2814346946772241488></a>
<div class="avatar-image-container avatar-stock"><span dir=ltr><a href=https://www.blogger.com/profile/17204066043271384535 target rel=nofollow class=avatar-hovercard id=av-2814346946772241488-17204066043271384535><img src='data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="35" height="35"><rect fill-opacity="0"/></svg>' alt title="Peter Hutterer" style="background-blend-mode:normal!important;background-clip:content-box!important;background-position:50% 50%!important;background-color:rgba(0,0,0,0)!important;background-image:var(--sf-img-3)!important;background-size:100% 100%!important;background-origin:content-box!important;background-repeat:no-repeat!important" width=35 height=35>
</a></span></div>
<a href=https://www.blogger.com/profile/17204066043271384535 rel=nofollow>Peter Hutterer</a>
said...
</dt>
<dd class=comment-body id=Blog1_cmt-2814346946772241488>
<p>
just a typo, fixed, thanks.
</p>
</dd>
<dd class=comment-footer>
<span class=comment-timestamp>
<a href="http://who-t.blogspot.com/2016/09/understanding-evdev.html?showComment=1474292025313#c2814346946772241488" title="comment permalink">
September 19, 2016 at 11:33 PM
</a>
<span class="item-control blog-admin pid-2136076424 sf-hidden">
<a class=comment-delete href="https://www.blogger.com/delete-comment.g?blogID=6112936277054198647&amp;postID=2814346946772241488" title="Delete Comment">
</a>
</span>
</span>
</dd>
<dt class=comment-author id=c8548718663844738941>
<a name=c8548718663844738941></a>
<div class="avatar-image-container avatar-stock"><span dir=ltr><a href=https://www.blogger.com/profile/08959077854908625403 target rel=nofollow class=avatar-hovercard id=av-8548718663844738941-08959077854908625403><img src='data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="35" height="35"><rect fill-opacity="0"/></svg>' alt title=Unknown style="background-blend-mode:normal!important;background-clip:content-box!important;background-position:50% 50%!important;background-color:rgba(0,0,0,0)!important;background-image:var(--sf-img-3)!important;background-size:100% 100%!important;background-origin:content-box!important;background-repeat:no-repeat!important" width=35 height=35>
</a></span></div>
<a href=https://www.blogger.com/profile/08959077854908625403 rel=nofollow>Unknown</a>
said...
</dt>
<dd class=comment-body id=Blog1_cmt-8548718663844738941>
<p>
Just wondering - I know you said most of the stuff should be implemented by the client, but what about the circular scrolling? Does it fall to the client part as well (since libinput already handles edge/two finger scrolling)?
</p>
</dd>
<dd class=comment-footer>
<span class=comment-timestamp>
<a href="http://who-t.blogspot.com/2016/09/understanding-evdev.html?showComment=1474293921215#c8548718663844738941" title="comment permalink">
September 20, 2016 at 12:05 AM
</a>
<span class="item-control blog-admin pid-1708280142 sf-hidden">
<a class=comment-delete href="https://www.blogger.com/delete-comment.g?blogID=6112936277054198647&amp;postID=8548718663844738941" title="Delete Comment">
</a>
</span>
</span>
</dd>
<dt class=comment-author id=c3747975269633423047>
<a name=c3747975269633423047></a>
<div class="avatar-image-container avatar-stock"><span dir=ltr><a href=https://www.blogger.com/profile/13206790143698555345 target rel=nofollow class=avatar-hovercard id=av-3747975269633423047-13206790143698555345><img src='data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="35" height="35"><rect fill-opacity="0"/></svg>' alt title=djb style="background-blend-mode:normal!important;background-clip:content-box!important;background-position:50% 50%!important;background-color:rgba(0,0,0,0)!important;background-image:var(--sf-img-3)!important;background-size:100% 100%!important;background-origin:content-box!important;background-repeat:no-repeat!important" width=35 height=35>
</a></span></div>
<a href=https://www.blogger.com/profile/13206790143698555345 rel=nofollow>djb</a>
said...
</dt>
<dd class=comment-body id=Blog1_cmt-3747975269633423047>
<p>
This hurts my brain, which is why I know it's a great technical write-up. :D<br><br>Thanks for taking the time to write this - and obviously for helping to keep it all working behind the scenes (under the fingers).
</p>
</dd>
<dd class=comment-footer>
<span class=comment-timestamp>
<a href="http://who-t.blogspot.com/2016/09/understanding-evdev.html?showComment=1474320709971#c3747975269633423047" title="comment permalink">
September 20, 2016 at 7:31 AM
</a>
<span class="item-control blog-admin pid-1516829319 sf-hidden">
<a class=comment-delete href="https://www.blogger.com/delete-comment.g?blogID=6112936277054198647&amp;postID=3747975269633423047" title="Delete Comment">
</a>
</span>
</span>
</dd>
<dt class="comment-author blog-author" id=c3298881868125996201>
<a name=c3298881868125996201></a>
<div class="avatar-image-container avatar-stock"><span dir=ltr><a href=https://www.blogger.com/profile/17204066043271384535 target rel=nofollow class=avatar-hovercard id=av-3298881868125996201-17204066043271384535><img src='data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="35" height="35"><rect fill-opacity="0"/></svg>' alt title="Peter Hutterer" style="background-blend-mode:normal!important;background-clip:content-box!important;background-position:50% 50%!important;background-color:rgba(0,0,0,0)!important;background-image:var(--sf-img-3)!important;background-size:100% 100%!important;background-origin:content-box!important;background-repeat:no-repeat!important" width=35 height=35>
</a></span></div>
<a href=https://www.blogger.com/profile/17204066043271384535 rel=nofollow>Peter Hutterer</a>
said...
</dt>
<dd class=comment-body id=Blog1_cmt-3298881868125996201>
<p>
Mitja: note that "client" as seen from the evdev protocol is the userspace process reading i (e.g. libinput), not an X or Wayland client. And yes, with touchpads almost everything including basic pointer motion is implemented in the client
</p>
</dd>
<dd class=comment-footer>
<span class=comment-timestamp>
<a href="http://who-t.blogspot.com/2016/09/understanding-evdev.html?showComment=1474382867372#c3298881868125996201" title="comment permalink">
September 21, 2016 at 12:47 AM
</a>
<span class="item-control blog-admin pid-2136076424 sf-hidden">
<a class=comment-delete href="https://www.blogger.com/delete-comment.g?blogID=6112936277054198647&amp;postID=3298881868125996201" title="Delete Comment">
</a>
</span>
</span>
</dd>
<dt class=comment-author id=c4626756769285099424>
<a name=c4626756769285099424></a>
<div class="avatar-image-container avatar-stock"><span dir=ltr><a href=https://www.blogger.com/profile/00152837355495611998 target rel=nofollow class=avatar-hovercard id=av-4626756769285099424-00152837355495611998><img src='data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="35" height="35"><rect fill-opacity="0"/></svg>' alt title=Unknown style="background-blend-mode:normal!important;background-clip:content-box!important;background-position:50% 50%!important;background-color:rgba(0,0,0,0)!important;background-image:var(--sf-img-3)!important;background-size:100% 100%!important;background-origin:content-box!important;background-repeat:no-repeat!important" width=35 height=35>
</a></span></div>
<a href=https://www.blogger.com/profile/00152837355495611998 rel=nofollow>Unknown</a>
said...
</dt>
<dd class=comment-body id=Blog1_cmt-4626756769285099424>
<p>
Thanks for the info,<br>You mention the abs parameter 'resolution' but the function 'input_set_abs_params' does not have this variable passed into it. How can one set this parameter?
</p>
</dd>
<dd class=comment-footer>
<span class=comment-timestamp>
<a href="http://who-t.blogspot.com/2016/09/understanding-evdev.html?showComment=1478185291135#c4626756769285099424" title="comment permalink">
November 4, 2016 at 1:01 AM
</a>
<span class="item-control blog-admin pid-196525137 sf-hidden">
<a class=comment-delete href="https://www.blogger.com/delete-comment.g?blogID=6112936277054198647&amp;postID=4626756769285099424" title="Delete Comment">
</a>
</span>
</span>
</dd>
<dt class="comment-author blog-author" id=c1388411210432071848>
<a name=c1388411210432071848></a>
<div class="avatar-image-container avatar-stock"><span dir=ltr><a href=https://www.blogger.com/profile/17204066043271384535 target rel=nofollow class=avatar-hovercard id=av-1388411210432071848-17204066043271384535><img src='data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="35" height="35"><rect fill-opacity="0"/></svg>' alt title="Peter Hutterer" style="background-blend-mode:normal!important;background-clip:content-box!important;background-position:50% 50%!important;background-color:rgba(0,0,0,0)!important;background-image:var(--sf-img-3)!important;background-size:100% 100%!important;background-origin:content-box!important;background-repeat:no-repeat!important" width=35 height=35>
</a></span></div>
<a href=https://www.blogger.com/profile/17204066043271384535 rel=nofollow>Peter Hutterer</a>
said...
</dt>
<dd class=comment-body id=Blog1_cmt-1388411210432071848>
<p>
Aidan: that's for in-kernel code, right? If so, it needs to be set separately with input_abs_set_res(), have a look at some of the other drivers. Resolution came quite late (2.6.30) and I guess there's never been a cleanup for those functions to merge them.
</p>
</dd>
<dd class=comment-footer>
<span class=comment-timestamp>
<a href="http://who-t.blogspot.com/2016/09/understanding-evdev.html?showComment=1478206855571#c1388411210432071848" title="comment permalink">
November 4, 2016 at 7:00 AM
</a>
<span class="item-control blog-admin pid-2136076424 sf-hidden">
<a class=comment-delete href="https://www.blogger.com/delete-comment.g?blogID=6112936277054198647&amp;postID=1388411210432071848" title="Delete Comment">
</a>
</span>
</span>
</dd>
<dt class=comment-author id=c6435693309612600078>
<a name=c6435693309612600078></a>
<div class="avatar-image-container avatar-stock"><span dir=ltr><a href=https://www.blogger.com/profile/00152837355495611998 target rel=nofollow class=avatar-hovercard id=av-6435693309612600078-00152837355495611998><img src='data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="35" height="35"><rect fill-opacity="0"/></svg>' alt title=Unknown style="background-blend-mode:normal!important;background-clip:content-box!important;background-position:50% 50%!important;background-color:rgba(0,0,0,0)!important;background-image:var(--sf-img-3)!important;background-size:100% 100%!important;background-origin:content-box!important;background-repeat:no-repeat!important" width=35 height=35>
</a></span></div>
<a href=https://www.blogger.com/profile/00152837355495611998 rel=nofollow>Unknown</a>
said...
</dt>
<dd class=comment-body id=Blog1_cmt-6435693309612600078>
<p>
Thanks Peter,<br>Done! That integer division does not bring great accuracy. Maybe I should scale up the max_x and max_y then I could get them closer to reality. Hmm, then I will have steps in the data according to whatever scale factor I might use. Any implications in this from an Apps perspective?
</p>
</dd>
<dd class=comment-footer>
<span class=comment-timestamp>
<a href="http://who-t.blogspot.com/2016/09/understanding-evdev.html?showComment=1478388549576#c6435693309612600078" title="comment permalink">
November 6, 2016 at 9:29 AM
</a>
<span class="item-control blog-admin pid-196525137 sf-hidden">
<a class=comment-delete href="https://www.blogger.com/delete-comment.g?blogID=6112936277054198647&amp;postID=6435693309612600078" title="Delete Comment">
</a>
</span>
</span>
</dd>
<dt class="comment-author blog-author" id=c4659100563551545623>
<a name=c4659100563551545623></a>
<div class="avatar-image-container avatar-stock"><span dir=ltr><a href=https://www.blogger.com/profile/17204066043271384535 target rel=nofollow class=avatar-hovercard id=av-4659100563551545623-17204066043271384535><img src='data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="35" height="35"><rect fill-opacity="0"/></svg>' alt title="Peter Hutterer" style="background-blend-mode:normal!important;background-clip:content-box!important;background-position:50% 50%!important;background-color:rgba(0,0,0,0)!important;background-image:var(--sf-img-3)!important;background-size:100% 100%!important;background-origin:content-box!important;background-repeat:no-repeat!important" width=35 height=35>
</a></span></div>
<a href=https://www.blogger.com/profile/17204066043271384535 rel=nofollow>Peter Hutterer</a>
said...
</dt>
<dd class=comment-body id=Blog1_cmt-4659100563551545623>
<p>
Aidan: libinput uses the resolution to convert to physical distances. pointer acceleration and other things are based on the phys. distance, so the more correct the resolution is, the more correct the feel from the device will be. On the X/Wayland client side, I don't think it matters too much but there could be specialised cases where it matters (some CAD app or something maybe). Not for touchpads though, that only affects graphics tablets. 
</p>
</dd>
<dd class=comment-footer>
<span class=comment-timestamp>
<a href="http://who-t.blogspot.com/2016/09/understanding-evdev.html?showComment=1478467385448#c4659100563551545623" title="comment permalink">
November 7, 2016 at 7:23 AM
</a>
<span class="item-control blog-admin pid-2136076424 sf-hidden">
<a class=comment-delete href="https://www.blogger.com/delete-comment.g?blogID=6112936277054198647&amp;postID=4659100563551545623" title="Delete Comment">
</a>
</span>
</span>
</dd>
<dt class=comment-author id=c2171114401619883476>
<a name=c2171114401619883476></a>
<div class="avatar-image-container avatar-stock"><span dir=ltr><a href=https://www.blogger.com/profile/10661636579329649996 target rel=nofollow class=avatar-hovercard id=av-2171114401619883476-10661636579329649996><img src='data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="35" height="35"><rect fill-opacity="0"/></svg>' alt title=Hi-Angel style="background-blend-mode:normal!important;background-clip:content-box!important;background-position:50% 50%!important;background-color:rgba(0,0,0,0)!important;background-image:var(--sf-img-3)!important;background-size:100% 100%!important;background-origin:content-box!important;background-repeat:no-repeat!important" width=35 height=35>
</a></span></div>
<a href=https://www.blogger.com/profile/10661636579329649996 rel=nofollow>Hi-Angel</a>
said...
</dt>
<dd class=comment-body id=Blog1_cmt-2171114401619883476>
<p>
How does kernel know if a device has e.g. BTTN_LEFT? I.e. is it written into HID standard that e.g. a particular code a device would send is the BTTN_LEFT?<br><br>Also I'm wondering, does "force feedback" aka rumble of gamepads handled by evdev protocol too?
</p>
</dd>
<dd class=comment-footer>
<span class=comment-timestamp>
<a href="http://who-t.blogspot.com/2016/09/understanding-evdev.html?showComment=1489488750852#c2171114401619883476" title="comment permalink">
March 14, 2017 at 8:52 PM
</a>
<span class="item-control blog-admin pid-1595219353 sf-hidden">
<a class=comment-delete href="https://www.blogger.com/delete-comment.g?blogID=6112936277054198647&amp;postID=2171114401619883476" title="Delete Comment">
</a>
</span>
</span>
</dd>
<dt class="comment-author blog-author" id=c5782064604793434775>
<a name=c5782064604793434775></a>
<div class="avatar-image-container avatar-stock"><span dir=ltr><a href=https://www.blogger.com/profile/17204066043271384535 target rel=nofollow class=avatar-hovercard id=av-5782064604793434775-17204066043271384535><img src='data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="35" height="35"><rect fill-opacity="0"/></svg>' alt title="Peter Hutterer" style="background-blend-mode:normal!important;background-clip:content-box!important;background-position:50% 50%!important;background-color:rgba(0,0,0,0)!important;background-image:var(--sf-img-3)!important;background-size:100% 100%!important;background-origin:content-box!important;background-repeat:no-repeat!important" width=35 height=35>
</a></span></div>
<a href=https://www.blogger.com/profile/17204066043271384535 rel=nofollow>Peter Hutterer</a>
said...
</dt>
<dd class=comment-body id=Blog1_cmt-5782064604793434775>
<p>
Yagamy: depends on the kernel driver, HID has mappings from HID to evdev, other drivers just set it manually depending on what bits are set in the respective protocols.<br><br>evdev does have a force-feedback interface but I've never used it, so I can't really explain much about it.
</p>
</dd>
<dd class=comment-footer>
<span class=comment-timestamp>
<a href="http://who-t.blogspot.com/2016/09/understanding-evdev.html?showComment=1489525272109#c5782064604793434775" title="comment permalink">
March 15, 2017 at 7:01 AM
</a>
<span class="item-control blog-admin pid-2136076424 sf-hidden">
<a class=comment-delete href="https://www.blogger.com/delete-comment.g?blogID=6112936277054198647&amp;postID=5782064604793434775" title="Delete Comment">
</a>
</span>
</span>
</dd>
<dt class=comment-author id=c3079629221472429268>
<a name=c3079629221472429268></a>
<div class="avatar-image-container avatar-stock"><span dir=ltr><a href=https://www.blogger.com/profile/10661636579329649996 target rel=nofollow class=avatar-hovercard id=av-3079629221472429268-10661636579329649996><img src='data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="35" height="35"><rect fill-opacity="0"/></svg>' alt title=Hi-Angel style="background-blend-mode:normal!important;background-clip:content-box!important;background-position:50% 50%!important;background-color:rgba(0,0,0,0)!important;background-image:var(--sf-img-3)!important;background-size:100% 100%!important;background-origin:content-box!important;background-repeat:no-repeat!important" width=35 height=35>
</a></span></div>
<a href=https://www.blogger.com/profile/10661636579329649996 rel=nofollow>Hi-Angel</a>
said...
</dt>
<dd class=comment-body id=Blog1_cmt-3079629221472429268>
<p>
FTR as the next question I am curious about is "doesn't libinput handle gamepads?", the answer is here https://lists.freedesktop.org/archives/wayland-devel/2015-January/019462.html<br><br>TL;DR: handling it in libinput makes no sense, and apps like games are apparently using evdev directly.<br><br>Also the non-asked subquestion I was wondering about is: how could kernel know the arrangement of buttons on a gamepad to assign to buttons rational names, like it did with BTTN_LEFT for mouse. The answer is: it don't. There seems to be no way to tell, and, although I didn't look yet at evdev output for gamepad, but apparently the names would be pretty random, like js1, js2, js3, etc.
</p>
</dd>
<dd class=comment-footer>
<span class=comment-timestamp>
<a href="http://who-t.blogspot.com/2016/09/understanding-evdev.html?showComment=1489658443952#c3079629221472429268" title="comment permalink">
March 16, 2017 at 8:00 PM
</a>
<span class="item-control blog-admin pid-1595219353 sf-hidden">
<a class=comment-delete href="https://www.blogger.com/delete-comment.g?blogID=6112936277054198647&amp;postID=3079629221472429268" title="Delete Comment">
</a>
</span>
</span>
</dd>
<dt class="comment-author blog-author" id=c3332492293746809673>
<a name=c3332492293746809673></a>
<div class="avatar-image-container avatar-stock"><span dir=ltr><a href=https://www.blogger.com/profile/17204066043271384535 target rel=nofollow class=avatar-hovercard id=av-3332492293746809673-17204066043271384535><img src='data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="35" height="35"><rect fill-opacity="0"/></svg>' alt title="Peter Hutterer" style="background-blend-mode:normal!important;background-clip:content-box!important;background-position:50% 50%!important;background-color:rgba(0,0,0,0)!important;background-image:var(--sf-img-3)!important;background-size:100% 100%!important;background-origin:content-box!important;background-repeat:no-repeat!important" width=35 height=35>
</a></span></div>
<a href=https://www.blogger.com/profile/17204066043271384535 rel=nofollow>Peter Hutterer</a>
said...
</dt>
<dd class=comment-body id=Blog1_cmt-3332492293746809673>
<p>
Yagamy: the js1 devices are joydev devices and don't speak the evdev protocol, it's a different kernel driver (similar to evdev0 vs mouse0 - same physical device but different device nodes with different protocols).<br><br>The kernel knows the button mappings for some devices, primarily where there's a custom driver. otherwise it relies on HID mappings (+quirks) or guesswork
</p>
</dd>
<dd class=comment-footer>
<span class=comment-timestamp>
<a href="http://who-t.blogspot.com/2016/09/understanding-evdev.html?showComment=1489701035592#c3332492293746809673" title="comment permalink">
March 17, 2017 at 7:50 AM
</a>
<span class="item-control blog-admin pid-2136076424 sf-hidden">
<a class=comment-delete href="https://www.blogger.com/delete-comment.g?blogID=6112936277054198647&amp;postID=3332492293746809673" title="Delete Comment">
</a>
</span>
</span>
</dd>
<dt class=comment-author id=c43389583521227323>
<a name=c43389583521227323></a>
<div class="avatar-image-container avatar-stock"><span dir=ltr><a href=https://www.blogger.com/profile/17660264942485899240 target rel=nofollow class=avatar-hovercard id=av-43389583521227323-17660264942485899240><img src='data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="35" height="35"><rect fill-opacity="0"/></svg>' alt title=Unknown style="background-blend-mode:normal!important;background-clip:content-box!important;background-position:50% 50%!important;background-color:rgba(0,0,0,0)!important;background-image:var(--sf-img-3)!important;background-size:100% 100%!important;background-origin:content-box!important;background-repeat:no-repeat!important" width=35 height=35>
</a></span></div>
<a href=https://www.blogger.com/profile/17660264942485899240 rel=nofollow>Unknown</a>
said...
</dt>
<dd class=comment-body id=Blog1_cmt-43389583521227323>
<p>
<br><br> Hi,<br><br> I set some calibration/settings on input device (turn device wheel to left. I did this with write() function) while this happens input system gathers data. So when I first call libevdev_next_event it gives me old garbage data. But I dont want those.<br><br> How can I flush/clear buffered data with libevdev? Is there any way?<br><br> (Execuse me for my english I am not native)<br><br> Yours Sincerely..<br>
</p>
</dd>
<dd class=comment-footer>
<span class=comment-timestamp>
<a href="http://who-t.blogspot.com/2016/09/understanding-evdev.html?showComment=1547199409070#c43389583521227323" title="comment permalink">
January 11, 2019 at 7:36 PM
</a>
</span>
</dd>
</dl>
</div>
</div>
</div>
 </div></div>
 
</div>
</div></div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
