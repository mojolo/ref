<html><head><title>System Configuration (Mac OS X for Unix Geeks)</title><link rel="stylesheet" type="text/css" href="../style/style1.css" />

<meta name="DC.Creator" content="Brian Jepson and Ernest E. Rothman" /><meta name="DC.Format" content="text/xml" scheme="MIME" /><meta name="DC.Language" content="en-US" /><meta name="DC.Publisher" content="O'Reilly &amp; Associates, Inc." /><meta name="DC.Source" scheme="ISBN" content="0-596-00356-0" /><meta name="DC.Subject.Keyword" content="stuff" /><meta name="DC.Title" content="Mac OS X for Unix Geeks" /><meta name="DC.Type" content="Text.Monograph" />

</head><body bgcolor="#ffffff">

<img src="gifs/smbanner.gif" usemap="#banner-map" border="0" alt="Book Home" /><map name="banner-map"><area shape="rect" coords="1,-2,616,66" href="index.htm" alt="Mac OS X for Unix Geeks" /><area shape="rect" coords="629,-11,726,25" href="jobjects/fsearch.htm" alt="Search this book" /></map>

<div class="navbar"><table width="684" border="0"><tr><td align="left" valign="top" width="228"><a href="ch08_02.htm"><img src="../gifs/txtpreva.gif" alt="Previous" border="0" /></a></td><td align="center" valign="top" width="228" /><td align="right" valign="top" width="228"><a href="ch09_01.htm"><img src="../gifs/txtnexta.gif" alt="Next" border="0" /></a></td></tr></table></div>



<h2 class="sect1">8.3. System Configuration</h2>

<p><a name="mosxgeeks-IDXTERM-528" />Although you can perform most system
configuration through the <a name="IXT-8-687" />System Preferences program, the
<em class="filename">defaults</em> command lets you poke around under the
hood. You can get even further under the hood with the
<em class="filename">nvram</em><a name="IXT-8-688" /> command (perhaps further than most
people would need or want to get).
</p>

<a name="mosxgeeks-CHP-8-SECT-3.1" /><div class="sect2">
<h3 class="sect2">8.3.1. defaults</h3>

<p><a name="mosxgeeks-IDXTERM-531" />When you customize your Mac using the
System Preferences, all of those changes and settings are stored in
what's known as the defaults system. Everything that
you've done to make your Mac your own is stored as
XML data in the form of a<a name="IXT-8-689" /> <a name="IXT-8-690" /> <em class="emphasis">property list</em> (or
<em class="filename">plist</em>). This property list is, in turn, stored
in <em class="filename">~/Library/Preferences</em>.
</p>

<p>Every time you change one of those settings, that particular property
list is updated. For the initiated, there are two other ways to alter
the property lists. The first is by using the PropertyListEditor
application (<em class="filename">/Developer/Applications</em>) and the
other is by using the <em class="filename">defaults</em> command in the
Terminal. Whether you use System Preferences, PropertyListEditor, or
the <em class="filename">defaults</em> command, any changes you make
affect the current user.
</p>
<a name="mosxgeeks-CHP-8-SECT-3.1.1" /><div class="sect3">
<h3 class="sect3">8.3.1.1. Syntax</h3>

<blockquote><pre class="code">defaults [-currentHost | -host <em class="replaceable"><tt>name</em>] <em class="replaceable">command</tt></em></pre></blockquote>

</div>
<a name="mosxgeeks-CHP-8-SECT-3.1.2" /><div class="sect3">
<h3 class="sect3">8.3.1.2. Options</h3>

<dl>
<dt><i><em class="filename">-currentHost</em></tt></i></dt>
<dd>
Performs operations on the local machine.</p>
</dd>



<dt><i><em class="filename">-host</em></tt> <tt><em class="replaceable"><tt>name</tt></em></tt></i></dt>
<dd>
Performs operations on the specified host.</p>
</dd>

</dl>

</div>
<a name="mosxgeeks-CHP-8-SECT-3.1.3" /><div class="sect3">
<h3 class="sect3">8.3.1.3. Commands</h3>

<dl>
<dt><i><em class="filename">read </em></tt></i></dt>
<dd>
Prints out all of your current settings.</p>
</dd>



<dt><i><em class="filename">read</em></tt> <tt><em class="replaceable"><tt>domain</tt></em></tt> </i></dt>
<dd>
Prints out your settings for the specified domain, such as
<em class="filename">com.apple.dock</em>.
</p>
</dd>



<dt><i><em class="filename">read</em></tt> <tt><em class="replaceable"><tt>domain key</tt></em></tt> </i></dt>
<dd>
Prints out the value of the specified key. For example, to see the
current Dock orientation, use:
</p>


<blockquote><pre class="code">defaults read com.apple.dock orientation.</pre></blockquote>
</dd>


<dt><i><em class="filename">read-type</em></tt> <tt><em class="replaceable"><tt>domain key</tt></em></tt> </i></dt>
<dd>
Prints out the data type of the specified key. For example,
<em class="filename">defaults read-type com.apple.dock orientation</em>
tells you that the type of the <em class="filename">orientation</em> key
is <em class="filename">string</em>.
</p>
</dd>



<dt><i><em class="filename">write</em></tt> <tt><em class="replaceable"><tt>domain key value</tt></em></tt> </i></dt>
<dd>
Writes a value to the specified key.</p>
</dd>



<dt><i><em class="filename">rename</em></tt> <tt><em class="replaceable"><tt>domain old_key new_key</tt></em></tt> </i></dt>
<dd>
Renames the specified key.</p>
</dd>



<dt><i><em class="filename">delete</em></tt> <tt><em class="replaceable"><tt>domain</tt></em></tt> </i></dt>
<dd>
Deletes the specified domain. So, if you issued the command
<em class="filename">defaults delete com.apple.dock</em></tt>, the Dock would
forget everything. The next time you log in, the
Dock's settings are set to the system default.
</p>
</dd>



<dt><i><em class="filename">delete</em></tt> <tt><em class="replaceable"><tt>domain key</tt></em></tt> </i></dt>
<dd>
Deletes the specified key. So, if you issued the command
<em class="filename">defaults delete com.apple.dock orientation</em>, the
Dock would forget its <em class="filename">orientation</em>. The next time
you log in, the Dock's settings are set to the
system default.
</p>
</dd>



<dt><i><em class="filename">domains </em></tt></i></dt>
<dd>
Lists all the domains in your defaults.</p>
</dd>



<dt><i><em class="filename">find</em></tt> <tt><em class="replaceable"><tt>string</tt></em></tt> </i></dt>
<dd>
Searches all defaults for the specified string.</p>
</dd>



<dt><i><em class="filename">help </em></tt></i></dt>
<dd>
Prints a list of options.</p>
</dd>

</dl>

</div>
<a name="mosxgeeks-CHP-8-SECT-3.1.4" /><div class="sect3">
<h3 class="sect3">8.3.1.4. Values</h3>

<p>A value may take one of the following forms:</p>

<dl>
<dt><i><tt><em class="replaceable"><tt>string</tt></em></tt></i></dt>
<dd>
Specifies a string value. For example, <em class="filename">defaults write
com.apple.dock orientation right</em>.
</p>
</dd>



<dt><i><em class="filename">-</em></tt><tt><em class="replaceable"><tt>type</em></tt><em class="filename"> </em></tt><tt><em class="replaceable">value</tt></em></tt></i></dt>
<dd>
Specifies a value of the specified type. The type may be
<em class="filename">string</em></tt>, <em class="filename">float</em></tt>, or
<em class="filename">boolean</em></tt>. For example, <em class="filename">defaults write
com.apple.dock autohide -boolean true</em></tt>.
</p>
</dd>



<dt><i><em class="filename">-array [-add]</em></tt> <tt><em class="replaceable"><tt>value [value ...]</tt></em></tt></i></dt>
<dd>
Creates or adds to a list of defaults. For example, you can create a
list of your favorite colors with <em class="filename">defaults write
personal.favorites colors -array red, blue</em>. Use
<em class="filename">-add</em> to add values to an existing array.
</p>
</dd>



<dt><i><em class="filename">-dict [-add]</em></tt> <tt><em class="replaceable"><tt>key value [key value...]</tt></em></tt></i></dt>
<dd>
Creates or adds to a dictionary list. For example, you can create a
dictionary of preferred pet foods with <em class="filename">defaults write
personal.pets food -dict cat salmon dog steak</em></tt>.
</p>
</dd>

</dl>

<a name="ch08-20-fm2xml" /><blockquote><b>WARNING:</b> 
Using the <em class="filename">defaults</em></tt> command is not for the
foolhardy. If you manage to mangle your settings, the easiest way to
correct the problem is to go back to that
application's <a name="IXT-8-691" />Preferences pane and reset your
preferences. In some cases, you can use <em class="filename">defaults
delete</em></tt><a name="IXT-8-692" />, which will be reset to the same
defaults when you next log in. Since the
<em class="filename">defaults</em></tt> command affects only the current user,
you could also create a user just for testing random
<em class="filename">defaults</em></tt> tips you pick up on the Internet.
</p>
</blockquote>

</div>
<a name="mosxgeeks-CHP-8-SECT-3.1.5" /><div class="sect3">
<h3 class="sect3">8.3.1.5. Examples</h3>

<dl>
<dt><i>View all of the user defaults on your system</i></dt>
<dd>
<blockquote><pre class="code">% <b class="emphasis-bold">defaults domains</b></pre></blockquote>

<p>This will print a listing of all of the <em class="filename">domains</em>
in the user's defaults system. The list
you'll see is run together with spaces in
between--not quite the prettiest way to view the information.
</p>
</dd>



<dt><i>View the settings for your Terminal</i></dt>
<dd>
<blockquote><pre class="code">% <b class="emphasis-bold">defaults read com.apple.Terminal</b></pre></blockquote>

<p>This command reads the settings from the
<em class="filename">com.apple.Terminal.plist</em></tt> file, found in
<em class="filename">~/Library/Preferences</em></tt>. This listing is rather
long, so you might want to pipe the output to
<em class="filename">less</em></tt> or <em class="filename">more</em></tt> to view the
contents one screen at a time:
</p>


<blockquote><pre class="code">% <b class="emphasis-bold">defaults read com.apple.Terminal | more</b></pre></blockquote>
</dd>


<dt><i>Change your Dock's default location to the top of the screen</i></dt>
<dd>
<blockquote><pre class="code">% <b class="emphasis-bold">defaults write com.apple.Dock orientation top</b></pre></blockquote>

<p>This moves the Dock to the top of the screen underneath the menu bar.
After changing that setting, you'll need to logout
from the system and then log back in to see the Dock under the menu
bar.<a name="IXTR3-702" />
</p>
</dd>

</dl>
</div>
</div>
<a name="mosxgeeks-CHP-8-SECT-3.2" /><div class="sect2">
<h3 class="sect2">8.3.2. nvram</h3>

<p><a name="mosxgeeks-IDXTERM-537" /> <a name="mosxgeeks-IDXTERM-538" />The
<em class="filename">nvram</em> utility modifies Open Firmware variables,
which control the <a name="IXT-8-693" />
<a name="IXT-8-694" />boot-time behavior of your
Macintosh. To list all Open Firmware variables, use <em class="filename">nvram
-p</em>. The Apple Open Firmware page is <a href="http://bananajr6000.apple.com/">http://bananajr6000.apple.com/</a>. 
</p>

<p>To change a variable, you must run <em class="filename">nvram </em>as
<em class="filename">root </em>or as the superuser. To set a variable, use
<em class="filename">variable=</em><em class="replaceable"><tt>value</tt></em>. For
example, to configure Mac OS X to boot verbosely, use <em class="filename">nvram
boot-args=-v</em>. (Booting into Mac OS 9 or earlier will reset
this.) <a href="ch08_03.htm#mosxgeeks-CHP-8-TABLE-7">Table 8-7</a> lists Open Firmware variables.
Some variables use the Open Firmware Device Tree notation (see the
technotes available at the Apple Open Firmware page).
</p>

<a name="ch08-22-fm2xml" /><blockquote><b>WARNING:</b> 
Be careful changing the <em class="filename">nvram </em>utility, since
incorrect settings can turn a G4 iMac into a $2000 doorstop. If you
render your computer unbootable, you can reset Open Firmware by
zapping the PRAM. To zap the PRAM, hold down
Option-<img src="figs/command.gif" alt="Figure " />-P-R as you start the computer,
and then release the keys when you hear a second startup chime. (If
your two hands are busy holding down the other buttons and you have
trouble reaching the power button, remember that you can press it
with your nose.)
</p>
</blockquote>

<a name="mosxgeeks-CHP-8-TABLE-7" /><h4 class="objtitle">Table 8-7. nvram variables </h4><table border="1" cellpadding="3">



<tr>
<th>
<p>Variable</p>
</th>
<th>
<p>Description</p>
</th>
</tr>


<tr>
<td>
<p><tt class="literal">auto-boot?</tt></p>
</td>
<td>
<p>The automatic boot settings. If <tt class="literal">true</tt> (the
default), Open Firmware will automatically boot an operating system.
If <tt class="literal">false</tt>, the process will stop at the Open
Firmware prompt. Be careful using this with Old World (unsupported)
machines and third-party graphics adapters, since the display and
keyboard may not be initialized until the operating system starts (in
which case, you will not have access to Open Firmware).
</p>
</td>
</tr>
<tr>
<td>
<p><tt class="literal">boot-args</tt></p>
</td>
<td>
<p>The arguments that are passed to the boot loader. </p>
</td>
</tr>
<tr>
<td>
<p><tt class="literal">boot-command</tt></p>
</td>
<td>
<p>The command that starts the boot process. The default is
<em class="filename">mac-boot</em>, an Open Firmware command that examines
the <tt class="literal">boot-device</tt> for a Mac OS startup.
</p>
</td>
</tr>
<tr>
<td>
<p><tt class="literal">boot-device</tt></p>
</td>
<td>
<p>The device to boot from. The syntax is
<em class="replaceable"><tt>device</em><tt class="literal">:[</tt><em class="replaceable">partition</em><tt class="literal">],</tt><em class="replaceable">path</em><tt class="literal">:</tt><em class="replaceable">filename</tt></em>,
and a common default is <tt class="literal">hd:,\\:tbxi</tt>. In the path,
<tt class="literal">\\</tt> is an abbreviation for
<em class="filename">/System/Library/CoreServices</em>, and
<tt class="literal">tbxi</tt> is the file type of the
<em class="filename">BootX</em> boot loader. (Run
<em class="filename">/Developer/Tools/GetFileInfo</em> on
<em class="filename">BootX</em> to see its type.)
</p>
</td>
</tr>
<tr>
<td>
<p><tt class="literal">boot-file</tt></p>
</td>
<td>
<p>The name of the boot loader. (This is often blank, since
<tt class="literal">boot-command</tt> and <tt class="literal">boot-device</tt>
are usually all that are needed.)
</p>
</td>
</tr>
<tr>
<td>
<p><tt class="literal">boot-screen</tt></p>
</td>
<td>
<p>The image to display on the boot screen.</p>
</td>
</tr>
<tr>
<td>
<p><tt class="literal">boot-script</tt></p>
</td>
<td>
<p>A variable that can contain an Open Firmware boot script.</p>
</td>
</tr>
<tr>
<td>
<p><tt class="literal">console-screen</tt></p>
</td>
<td>
<p>A variable that specifies the console output device, using an Open
Firmware Device Tree name.
</p>
</td>
</tr>
<tr>
<td>
<p><tt class="literal">default-client-ip</tt></p>
</td>
<td>
<p>An IP address for diskless booting.</p>
</td>
</tr>
<tr>
<td>
<p><tt class="literal">default-gateway-ip</tt></p>
</td>
<td>
<p>A gateway address for diskless booting.</p>
</td>
</tr>
<tr>
<td>
<p><tt class="literal">default-mac-address?</tt></p>
</td>
<td>
<p>Description not available at time of writing; see errata page at
<a href="http://www.oreilly.com/catalog/mosxgeeks">http://www.oreilly.com/catalog/mosxgeeks</a>.
</p>
</td>
</tr>
<tr>
<td>
<p><tt class="literal">default-router-ip</tt></p>
</td>
<td>
<p>A router address for diskless booting.</p>
</td>
</tr>
<tr>
<td>
<p><tt class="literal">default-server-ip</tt></p>
</td>
<td>
<p>An IP address for diskless booting.</p>
</td>
</tr>
<tr>
<td>
<p><tt class="literal">default-subnet-mask</tt></p>
</td>
<td>
<p>A default subnet mask for diskless booting.</p>
</td>
</tr>
<tr>
<td>
<p><tt class="literal">diag-device</tt></p>
</td>
<td>
<p>A private variable; not usable for security reasons.</p>
</td>
</tr>
<tr>
<td>
<p><tt class="literal">diag-file</tt></p>
</td>
<td>
<p>A private variable; not usable for security reasons.</p>
</td>
</tr>
<tr>
<td>
<p><tt class="literal">diag-switch?</tt></p>
</td>
<td>
<p>A private variable; not usable for security reasons.</p>
</td>
</tr>
<tr>
<td>
<p><tt class="literal">fcode-debug?</tt></p>
</td>
<td>
<p>A variable that determines whether the Open Firmware Forth
interpreter will display extra debugging information.
</p>
</td>
</tr>
<tr>
<td>
<p><tt class="literal">input-device</tt></p>
</td>
<td>
<p>The input device to use for the Open Firmware console.</p>
</td>
</tr>
<tr>
<td>
<p><tt class="literal">input-device-1</tt></p>
</td>
<td>
<p>A secondary input device (so you can have a screen and serial console
at the same time). Use <em class="filename">scca</em> for the first serial
port.
</p>
</td>
</tr>
<tr>
<td>
<p><tt class="literal">little-endian?</tt></p>
</td>
<td>
<p>The CPU endian-ness. If <tt class="literal">true</tt>, initializes the
PowerPC chip as little-endian. The default is
<tt class="literal">false</tt>.
</p>
</td>
</tr>
<tr>
<td>
<p><tt class="literal">load-base</tt></p>
</td>
<td>
<p>A private variable; not usable for security reasons.</p>
</td>
</tr>
<tr>
<td>
<p><tt class="literal">mouse-device</tt></p>
</td>
<td>
<p>The mouse device using an Open Firmware Device Tree name.</p>
</td>
</tr>
<tr>
<td>
<p><tt class="literal">nvramrc</tt></p>
</td>
<td>
<p>A sequence of commands to execute at boot time (if
<em class="filename">use-nvramc?</em> is set to <tt class="literal">true</tt>).
</p>
</td>
</tr>
<tr>
<td>
<p><tt class="literal">oem-banner</tt></p>
</td>
<td>
<p>A custom banner to display at boot time.</p>
</td>
</tr>
<tr>
<td>
<p><tt class="literal">oem-banner?</tt></p>
</td>
<td>
<p>The <tt class="literal">oem</tt> banner settings. Set to
<tt class="literal">true</tt> to enable the <tt class="literal">oem</tt> banner.
The default is <tt class="literal">false</tt>.
</p>
</td>
</tr>
<tr>
<td>
<p><tt class="literal">oem-logo</tt></p>
</td>
<td>
<p>A 64-by-64 bit array containing a custom black-and-white logo to
display at boot time. This should be specified in hex.
</p>
</td>
</tr>
<tr>
<td>
<p><tt class="literal">oem-logo?</tt></p>
</td>
<td>
<p>The <tt class="literal">oem</tt> logo settings. Set to
<tt class="literal">true</tt> to enable the <tt class="literal">oem</tt> logo.
The default is <tt class="literal">false</tt>.
</p>
</td>
</tr>
<tr>
<td>
<p><tt class="literal">output-device</tt></p>
</td>
<td>
<p>The device to use as the system console. The default is
<tt class="literal">screen</tt>.
</p>
</td>
</tr>
<tr>
<td>
<p><tt class="literal">output-device-1</tt></p>
</td>
<td>
<p>A secondary output device (so you can have everything go to both the
screen and a serial console). Use <em class="filename">scca</em> for the
first serial port.
</p>
</td>
</tr>
<tr>
<td>
<p><tt class="literal">pci-probe-mask</tt></p>
</td>
<td>
<p>A private variable; not usable for security reasons.</p>
</td>
</tr>
<tr>
<td>
<p><tt class="literal">ram-size</tt></p>
</td>
<td>
<p>The amount of RAM currently installed. For example, 256 MB is shown
as <tt class="literal">0x10000000</tt>.
</p>
</td>
</tr>
<tr>
<td>
<p><tt class="literal">real-base</tt></p>
</td>
<td>
<p>The starting physical address that is available to Open Firmware.</p>
</td>
</tr>
<tr>
<td>
<p><tt class="literal">real-mode?</tt></p>
</td>
<td>
<p>The address translation settings. If <tt class="literal">true</tt>, Open
Firmware will use real-mode address translation. Otherwise, it uses
virtual-mode address translation.
</p>
</td>
</tr>
<tr>
<td>
<p><tt class="literal">real-size</tt></p>
</td>
<td>
<p>The size of the physical address space available to Open Firmware.</p>
</td>
</tr>
<tr>
<td>
<p><tt class="literal">screen-#columns</tt></p>
</td>
<td>
<p>The number of columns for the system console.</p>
</td>
</tr>
<tr>
<td>
<p><tt class="literal">screen-#rows</tt></p>
</td>
<td>
<p>The number of rows for the system console.</p>
</td>
</tr>
<tr>
<td>
<p><tt class="literal">scroll-lock</tt></p>
</td>
<td>
<p>Set by page checking output words to prevent Open Firmware text from
scrolling off the top of the screen.
</p>
</td>
</tr>
<tr>
<td>
<p><tt class="literal">selftest-#megs</tt></p>
</td>
<td>
<p>The number of MB of RAM to test at boot time. The default is
<tt class="literal">0</tt>. 
</p>
</td>
</tr>
<tr>
<td>
<p><tt class="literal">use-generic?</tt></p>
</td>
<td>
<p>The device node naming settings. Specifies whether to use generic
device node names such as 'screen',
as opposed to Apple hardware code names.
</p>
</td>
</tr>
<tr>
<td>
<p><tt class="literal">use-nvramrc?</tt></p>
</td>
<td>
<p>The command settings. If this is <tt class="literal">true</tt>, Open
Firmware uses the commands in <em class="filename">nvramrc</em> at boot
time.
</p>
</td>
</tr>
<tr>
<td>
<p><tt class="literal">virt-base</tt></p>
</td>
<td>
<p>The starting virtual address that is available to Open Firmware.</p>
</td>
</tr>
<tr>
<td>
<p><tt class="literal">virt-size</tt></p>
</td>
<td>
<p>The size of the virtual address space<a name="IXTR3-703" /> <a name="IXTR3-704" /> available
to<a name="IXTR3-705" />
Open Firmware.<a name="IXTR3-706" /> <a name="IXTR3-707" /> <a name="IXTR3-708" /> 
</p>
</td>
</tr>

</table><p>




</div>


<hr width="684" align="left" />
<div class="navbar"><table width="684" border="0"><tr><td align="left" valign="top" width="228"><a href="ch08_02.htm"><img src="../gifs/txtpreva.gif" alt="Previous" border="0" /></a></td><td align="center" valign="top" width="228"><a href="index.htm"><img src="../gifs/txthome.gif" alt="Home" border="0" /></a></td><td align="right" valign="top" width="228"><a href="ch09_01.htm"><img src="../gifs/txtnexta.gif" alt="Next" border="0" /></a></td></tr><tr><td align="left" valign="top" width="228">8.2. Kernel Utilities</td><td align="center" valign="top" width="228"><a href="index/index.htm"><img src="../gifs/index.gif" alt="Book Index" border="0" /></a></td><td align="right" valign="top" width="228">9. The X Window System</td></tr></table></div>
<hr width="684" align="left" />

<img src="../gifs/navbar.gif" usemap="#library-map" border="0" alt="Library Navigation Links" />
<p><p><font size="-1"><a href="copyrght.htm">Copyright &copy; 2003</a> O'Reilly &amp; Associates. All rights reserved.</font></p>

<map name="library-map">
<area shape="rect" coords="1,0,88,96" href="../index.htm"><area shape="rect" coords="90,0,165,96" href="../upt/index.htm"><area shape="rect" coords="168,1,253,107" href="../mac/index.htm"><area shape="rect" coords="255,0,335,97" href="../korn/index.htm"><area shape="rect" coords="337,0,415,109" href="../unixnut/index.htm"><area shape="rect" coords="417,0,512,122" href="../sedawk/index.htm"><area shape="rect" coords="514,0,605,105" href="../lunix/index.htm"><area shape="rect" coords="611,2,694,121" href="../vi/index.htm">
</map>

</body></html>