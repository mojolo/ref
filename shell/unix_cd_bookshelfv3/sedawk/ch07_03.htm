<html><head><title>Awk's Programming Model (sed & awk, Second Edition)</title><link rel="stylesheet" type="text/css" href="../style/style1.css" />

<meta name="DC.Creator" content="Dale Dougherty and Arnold Robbins" /><meta name="DC.Format" content="text/xml" scheme="MIME" /><meta name="DC.Language" content="en-US" /><meta name="DC.Publisher" content="O'Reilly &amp; Associates, Inc." /><meta name="DC.Source" scheme="ISBN" content="1-56592-225-5" /><meta name="DC.Subject.Keyword" content="stuff" /><meta name="DC.Title" content="sed &amp; awk, Second Edition" /><meta name="DC.Type" content="Text.Monograph" />

</head><body bgcolor="#ffffff">

<img src="gifs/smbanner.gif" usemap="#banner-map" border="0" alt="sed &amp; awk" /><map name="banner-map"><area shape="rect" coords="1,-2,616,66" href="index.htm" alt="sed &amp; awk" /><area shape="rect" coords="629,-11,726,25" href="jobjects/fsearch.htm" alt="Search this book" /></map>

<div class="navbar"><table width="684" border="0"><tr><td align="left" valign="top" width="228"><a href="ch07_02.htm"><img src="../gifs/txtpreva.gif" alt="Previous" border="0" /></a></td><td align="center" valign="top" width="228" /><td align="right" valign="top" width="228"><a href="ch07_04.htm"><img src="../gifs/txtnexta.gif" alt="Next" border="0" /></a></td></tr></table></div>



<h2 class="sect1">7.3. Awk's Programming Model</h2>

<p>
<a name="IXT-7-265808" />
<a name="IXT-7-265809" />
It's important to understand the basic model that awk offers the
programmer.  Part of the reason why awk is easier to learn than many
programming languages is that it offers such a well-defined and useful
model to the programmer.</p>

<p>
<a name="IXT-7-265810" />
<a name="IXT-7-265811" />
<a name="IXT-7-265812" />
An awk program
consists of what we will call a <em class="emphasis">main input loop</em>.
A <em class="emphasis">loop</em> is a routine that is executed over and
over again until some condition exists that terminates it.  You don't
write this loop, it is given--it exists as the framework within
which the code that you do write will be executed.  The main input
loop in awk is a routine that reads one line of input from a file and
makes it available for processing.  The actions you write to do the
processing assume that there is a line of input available.  In another
programming language, you would have to create the main input loop as
part of your program.  It would have to open the input file and read
one line at a time.  This is not necessarily a lot of work, but it
illustrates a basic awk shortcut that makes it easier for you to write
your program.</p>

<p>The main input loop is executed as many times as there are lines of
input.  As you saw in the "Hello, world" examples, this loop does not
execute until there is a line of input.  It terminates when there is
no more input to be read.</p>

<p>Awk allows you to write two special routines that can be executed
<em class="emphasis">before</em> any input is read and
<em class="emphasis">after</em> all input is read.  These are the
procedures associated with the <b class="emphasis-bold">BEGIN</b> and
<b class="emphasis-bold">END</b> rules, respectively.  In other words, you can
do some preprocessing before the main input loop is ever executed and
you can do some postprocessing after the main input loop has
terminated.  The <b class="emphasis-bold">BEGIN</b> and <b class="emphasis-bold">END</b>
procedures are optional.</p>

<p>You can think of an awk script as having potentially three major
parts: what happens before, what happens during, and what happens
after processing the input.  <a href="ch07_03.htm#sedawk-ch-7-fig-1">Figure 7.1</a> shows
the relationship of these parts in the flow of control of an awk
script.</p>

<a name="sedawk-ch-7-fig-1" /><div class="figure"><img src="figs/sed_0701.gif" alt="Figure 7.1" width="503" /></div><h4 class="objtitle">Figure 7.1. Flow and control in awk scripts</h4><p>Of these three parts, the main input loop or "what happens during
processing" is where most of the work gets done.  Inside the main
input loop, your instructions are written as a series of
pattern/action procedures.  A pattern is a rule for testing the input
line to determine whether or not the action should be applied to it.
The actions, as we shall see, can be quite complex, consisting of
statements, functions, and expressions.</p>

<p>The main thing to remember is that each pattern/action procedure sits
in the main input loop, which takes care of reading the input line.
The procedures that you write will be applied to each input line, one
line at a time.</p>


<hr width="684" align="left" />
<div class="navbar"><table width="684" border="0"><tr><td align="left" valign="top" width="228"><a href="ch07_02.htm"><img src="../gifs/txtpreva.gif" alt="Previous" border="0" /></a></td><td align="center" valign="top" width="228"><a href="index.htm"><img src="../gifs/txthome.gif" alt="Home" border="0" /></a></td><td align="right" valign="top" width="228"><a href="ch07_04.htm"><img src="../gifs/txtnexta.gif" alt="Next" border="0" /></a></td></tr><tr><td align="left" valign="top" width="228">7.2. Hello, World</td><td align="center" valign="top" width="228"><a href="index/index.htm"><img src="../gifs/index.gif" alt="Book Index" border="0" /></a></td><td align="right" valign="top" width="228">7.4. Pattern Matching</td></tr></table></div>
<hr width="684" align="left" />

<img src="../gifs/navbar.gif" usemap="#library-map" border="0" alt="Library Navigation Links" />
<p><p><font size="-1"><a href="copyrght.htm">Copyright &copy; 2003</a> O'Reilly &amp; Associates. All rights reserved.</font></p>

<map name="library-map">
<area shape="rect" coords="1,0,88,96" href="../index.htm"><area shape="rect" coords="90,0,165,96" href="../upt/index.htm"><area shape="rect" coords="168,1,253,107" href="../mac/index.htm"><area shape="rect" coords="255,0,335,97" href="../korn/index.htm"><area shape="rect" coords="337,0,415,109" href="../unixnut/index.htm"><area shape="rect" coords="417,0,512,122" href="../sedawk/index.htm"><area shape="rect" coords="514,0,605,105" href="../lunix/index.htm"><area shape="rect" coords="611,2,694,121" href="../vi/index.htm">
</map>

</body></html>