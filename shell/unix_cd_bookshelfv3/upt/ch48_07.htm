<html><head><title>Intruder Detection (Unix Power Tools, 3rd Edition)</title><link rel="stylesheet" type="text/css" href="../style/style1.css" />

<meta name="DC.Creator" content="Shelley Powers, Jerry Peek, Tim O'Reilly, Mike Loukides and  " /><meta name="DC.Format" content="text/xml" scheme="MIME" /><meta name="DC.Language" content="en-US" /><meta name="DC.Publisher" content="O'Reilly &amp; Associates, Inc." /><meta name="DC.Source" scheme="ISBN" content="0-596-00330-7" /><meta name="DC.Subject.Keyword" content="stuff" /><meta name="DC.Title" content="UNIX Power Tools, 3rd Edition" /><meta name="DC.Type" content="Text.Monograph" />

</head><body bgcolor="#ffffff">

<img src="gifs/smbanner.gif" usemap="#banner-map" border="0" alt="Unix Power Tools" /><map name="banner-map"><area shape="rect" coords="1,-2,616,66" href="index.htm" alt="Unix Power Tools" /><area shape="rect" coords="629,-11,726,25" href="jobjects/fsearch.htm" alt="Search this book" /></map>

<div class="navbar"><table width="684" border="0"><tr><td align="left" valign="top" width="228"><a href="ch48_06.htm"><img src="../gifs/txtpreva.gif" alt="Previous" border="0" /></a></td><td align="center" valign="top" width="228" /><td align="right" valign="top" width="228"><a href="ch48_08.htm"><img src="../gifs/txtnexta.gif" alt="Next" border="0" /></a></td></tr></table></div>



<h2 class="sect1">48.7. Intruder Detection</h2>

<p><a name="IXT-48-1943" /> <a name="IXT-48-1944" />From the
<a name="IXT-48-1945" />CERT Intruder detection checklist at
<a href="http://www.cert.org/tech_tips/intruder_detection_checklist.html">http://www.cert.org/tech_tips/intruder_detection_checklist.html</a>
comes a variety of helpful steps to take to determine if your system
has had an intruder.
</p>

<p>Check logfiles first, and then check for any unusual <b class="emphasis-bold">setgid</b> (<a href="ch49_05.htm#upt3-CHP-49-SECT-5">Section 49.5</a>) or
<em class="filename">setuid</em> files.
</p>

<p><a name="IXT-48-1946" />A key symptom that
something is wrong with your system is when something appears that
doesn't belong. This includes files, directories,
users, and groups. Unfortunately, these are also almost impossible to
detect unless they occur in obviously incorrect locations.
</p>

<p>You can search for modified files based on a time range using the
<b class="emphasis-bold">find</b> (<a name="IXT-48-1947" /><a href="ch09_01.htm#upt3-CHP-9-SECT-1">Section 9.1</a>) command. For
instance, the following two commands will find all files that have
been changed in the last two days excluding today. The results are
piped to <em class="emphasis">cat</em> for easier reading:
</p>

<blockquote><pre class="code">&gt; find /  -mtime -2 -mtime +1 -exec ls -ld {} \; | cat
&gt; find /  -ctime -2 -ctime +1 -exec ls -ldc {} \; | cat</pre></blockquote>

<p>Running these commands as root will ensure you have access to all
files and directories. Note that depending on the size of your
system, the command can take a considerable amount of time.
</p>

<p>Also check for hidden files, those beginning with a period. The
following command searches every directory but NFS mounted ones for
files beginning with a period (.):
</p>

<blockquote><pre class="code">find / -name ".*" -print -xdev | cat -v</pre></blockquote>

<p>In addition, review critical files such as
<em class="filename">/etc/passwd</em> and the <b class="emphasis-bold">crontab file</b> (<a href="ch25_03.htm#upt3-CHP-25-SECT-3">Section 25.3</a>),
checking for new and unusual entries. You might want to keep off-disk
copies of the files to use for comparison; online versions can also
be compromised.
</p>

<p>Check binaries for possible changes and replacements -- including
backups -- and changes to files such as
<em class="filename">xinetd.conf</em>, allowing services such as telnet
that were originally disallowed.
</p>

<p>In other words, according to CERT, knowing your system and checking
for changes using built-in utilities can be the best approach to take
to detect intrusion.
</p>

<p> <em class="emphasis">-- SP</em></p>



<hr width="684" align="left" />
<div class="navbar"><table width="684" border="0"><tr><td align="left" valign="top" width="228"><a href="ch48_06.htm"><img src="../gifs/txtpreva.gif" alt="Previous" border="0" /></a></td><td align="center" valign="top" width="228"><a href="index.htm"><img src="../gifs/txthome.gif" alt="Home" border="0" /></a></td><td align="right" valign="top" width="228"><a href="ch48_08.htm"><img src="../gifs/txtnexta.gif" alt="Next" border="0" /></a></td></tr><tr><td align="left" valign="top" width="228">48.6. Beware of Sluggish Performance</td><td align="center" valign="top" width="228"><a href="index/index.htm"><img src="../gifs/index.gif" alt="Book Index" border="0" /></a></td><td align="right" valign="top" width="228">48.8. Importance of MOTD</td></tr></table></div>
<hr width="684" align="left" />

<img src="../gifs/navbar.gif" usemap="#library-map" border="0" alt="Library Navigation Links" />
<p><p><font size="-1"><a href="copyrght.htm">Copyright &copy; 2003</a> O'Reilly &amp; Associates. All rights reserved.</font></p>

<map name="library-map">
<area shape="rect" coords="1,0,88,96" href="../index.htm"><area shape="rect" coords="90,0,165,96" href="../upt/index.htm"><area shape="rect" coords="168,1,253,107" href="../mac/index.htm"><area shape="rect" coords="255,0,335,97" href="../korn/index.htm"><area shape="rect" coords="337,0,415,109" href="../unixnut/index.htm"><area shape="rect" coords="417,0,512,122" href="../sedawk/index.htm"><area shape="rect" coords="514,0,605,105" href="../lunix/index.htm"><area shape="rect" coords="611,2,694,121" href="../vi/index.htm">
</map>

</body></html>