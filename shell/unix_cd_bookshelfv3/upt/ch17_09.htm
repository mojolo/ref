<html><head><title>Confirming Substitutions in vi (Unix Power Tools, 3rd Edition)</title><link rel="stylesheet" type="text/css" href="../style/style1.css" />

<meta name="DC.Creator" content="Shelley Powers, Jerry Peek, Tim O'Reilly, Mike Loukides and  " /><meta name="DC.Format" content="text/xml" scheme="MIME" /><meta name="DC.Language" content="en-US" /><meta name="DC.Publisher" content="O'Reilly &amp; Associates, Inc." /><meta name="DC.Source" scheme="ISBN" content="0-596-00330-7" /><meta name="DC.Subject.Keyword" content="stuff" /><meta name="DC.Title" content="UNIX Power Tools, 3rd Edition" /><meta name="DC.Type" content="Text.Monograph" />

</head><body bgcolor="#ffffff">

<img src="gifs/smbanner.gif" usemap="#banner-map" border="0" alt="Unix Power Tools" /><map name="banner-map"><area shape="rect" coords="1,-2,616,66" href="index.htm" alt="Unix Power Tools" /><area shape="rect" coords="629,-11,726,25" href="jobjects/fsearch.htm" alt="Search this book" /></map>

<div class="navbar"><table width="684" border="0"><tr><td align="left" valign="top" width="228"><a href="ch17_08.htm"><img src="../gifs/txtpreva.gif" alt="Previous" border="0" /></a></td><td align="center" valign="top" width="228" /><td align="right" valign="top" width="228"><a href="ch17_10.htm"><img src="../gifs/txtnexta.gif" alt="Next" border="0" /></a></td></tr></table></div>



<h2 class="sect1">17.9. Confirming Substitutions in vi</h2>

<p><a name="IXT-17-1433" /><a name="IXT-17-1434" /><a name="IXT-17-1435" />It makes sense to be overly careful when
using a
<a name="IXT-17-1436" />search-and-replace command.
<a name="IXT-17-1437" />It sometimes happens that what
you get is not what you expected. You can
<a name="IXT-17-1438" />undo any
<a name="IXT-17-1439" /> <a name="IXT-17-1440" />search-and-replace command by
entering <tt class="literal">u</tt>, provided that the command was intended
for the most recent edit you made. But you don't always catch
undesired changes until it is too late to undo them. Another way to
protect your edited file is to save the file with
<tt class="literal">:w</tt> before performing a global replacement. Then at
least you can quit the file without saving your edits and go back to
where you were before the change was made. You can also read back in
the previous version of the buffer with <b class="emphasis-bold">:e!</b> (<a href="ch17_03.htm#upt3-CHP-17-SECT-3">Section 17.3</a>).
</p>

<p>It's wise to be cautious and know exactly what is going to be changed
in your file. If you'd like to see what the search turns up and
confirm each replacement before it is made, add the
<tt class="literal">c</tt> option (for confirm) at the end of the
substitute command:
</p>

<blockquote><pre class="code"><tt class="userinput"><b>:1,30s/his/the/gc</b></tt></pre></blockquote>

<p>The item to be substituted is highlighted so that placement of the
cursor on the first character is marked by a series of carets
(<tt class="literal">^^^^</tt>).
</p>

<blockquote><pre class="code">copyists at his school
            ^^^_</pre></blockquote>

<p>If you want to make the replacement, you must enter
<tt class="literal">y</tt> (for yes) and press RETURN. If you don't want to
make a change, simply press RETURN.
</p>

<p>The combination of the <em class="emphasis">vi</em> commands,
<tt class="literal">n</tt> (repeat last search) and dot (.) (repeat last
command), is also an extraordinarily useful and quick way to page
through a file and make repetitive changes that you may not want to
make globally. So, for example, if your editor has told you that
you're using <em class="emphasis">which</em> when you should be using
<em class="emphasis">that</em>, you can spot-check every occurrence of
<em class="emphasis">which</em>, changing only those that are incorrect.
</p>

<p>This often turns out to be faster than using a global substitution
with confirmation. It also lets you see other lines near the text
you're checking, which is hard to do with <tt class="literal">:s///c</tt>
in original <i class="command">vi</i>. <i class="command">vi</i> clones have
improved the situation. For instance, in <i class="command">vim</i>,
<tt class="literal">:s///c</tt> runs in fullscreen mode; it also lets you
type CTRL-y and CTRL-e to scroll the screen up or down to see context
before you approve or deny each substitution.
</p>

<p>--<em class="emphasis">DD, TOR, from <em class="emphasis">Learning the vi Editor</em>
(O'Reilly, 1998)</em>
</p>



<hr width="684" align="left" />
<div class="navbar"><table width="684" border="0"><tr><td align="left" valign="top" width="228"><a href="ch17_08.htm"><img src="../gifs/txtpreva.gif" alt="Previous" border="0" /></a></td><td align="center" valign="top" width="228"><a href="index.htm"><img src="../gifs/txthome.gif" alt="Home" border="0" /></a></td><td align="right" valign="top" width="228"><a href="ch17_10.htm"><img src="../gifs/txtnexta.gif" alt="Next" border="0" /></a></td></tr><tr><td align="left" valign="top" width="228">17.8. Using Search Patterns and Global Commands</td><td align="center" valign="top" width="228"><a href="index/index.htm"><img src="../gifs/index.gif" alt="Book Index" border="0" /></a></td><td align="right" valign="top" width="228">17.10. Keep Your Original File, Write to a New File</td></tr></table></div>
<hr width="684" align="left" />

<img src="../gifs/navbar.gif" usemap="#library-map" border="0" alt="Library Navigation Links" />
<p><p><font size="-1"><a href="copyrght.htm">Copyright &copy; 2003</a> O'Reilly &amp; Associates. All rights reserved.</font></p>

<map name="library-map">
<area shape="rect" coords="1,0,88,96" href="../index.htm"><area shape="rect" coords="90,0,165,96" href="../upt/index.htm"><area shape="rect" coords="168,1,253,107" href="../mac/index.htm"><area shape="rect" coords="255,0,335,97" href="../korn/index.htm"><area shape="rect" coords="337,0,415,109" href="../unixnut/index.htm"><area shape="rect" coords="417,0,512,122" href="../sedawk/index.htm"><area shape="rect" coords="514,0,605,105" href="../lunix/index.htm"><area shape="rect" coords="611,2,694,121" href="../vi/index.htm">
</map>

</body></html>