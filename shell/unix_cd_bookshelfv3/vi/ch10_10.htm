<html><head><title>Interesting Features (Learning the vi Editor, Sixth Edition)</title><link rel="stylesheet" type="text/css" href="../style/style1.css" />

<meta name="DC.Creator" content="Linda Lamb and Arnold Robbins" /><meta name="DC.Format" content="text/xml" scheme="MIME" /><meta name="DC.Language" content="en-US" /><meta name="DC.Publisher" content="O'Reilly &amp; Associates, Inc." /><meta name="DC.Source" scheme="ISBN" content="1-56592-426-6" /><meta name="DC.Subject.Keyword" content="stuff" /><meta name="DC.Title" content="Learning the vi Editor, Sixth Edition" /><meta name="DC.Type" content="Text.Monograph" />

</head><body bgcolor="#ffffff">

<img src="gifs/smbanner.gif" usemap="#banner-map" border="0" alt="Book Home" /><map name="banner-map"><area shape="rect" coords="1,-2,616,66" href="index.htm" alt="Learning the vi Editor" /><area shape="rect" coords="629,-11,726,25" href="jobjects/fsearch.htm" alt="Search this book" /></map>

<div class="navbar"><table width="684" border="0"><tr><td align="left" valign="top" width="228"><a href="ch10_09.htm"><img src="../gifs/txtpreva.gif" alt="Previous" border="0" /></a></td><td align="center" valign="top" width="228" /><td align="right" valign="top" width="228"><a href="ch10_11.htm"><img src="../gifs/txtnexta.gif" alt="Next" border="0" /></a></td></tr></table></div>



<h2 class="sect1">10.10. Interesting Features</h2>

<p>
<a name="ch10.interesting" />
<em class="emphasis">elvis</em> has a number of interesting features:</p>

<dl>
<dt><i>Internationalization support</i></dt><dd>
<a name="IXT-10-281571" />
Like <em class="emphasis">nvi</em></tt>,
<em class="emphasis">elvis</em></tt> also has a home-grown method for
allowing translations of messages into different languages.
<a name="IXT-10-281572" />
The <em class="filename">elvis.msg</em></tt> file is searched for along
the <tt class="literal">elvispath</tt> and loaded into a buffer named
<tt class="literal">Elvis messages</tt>.</p>

<p>Messages have the form
"<em class="emphasis">terse message</em></tt><tt class="literal">:</tt><em class="emphasis">long message.</em></tt>"
Before printing a message, <em class="emphasis">elvis</em></tt> looks up the
terse form, and if there is a corresponding long form, that
message is used.
Otherwise, the terse message is used.</p></dd>


<dt><i>Display modes</i></dt><dd>This is perhaps the most interesting of <em class="emphasis">elvis</em></tt>'
features.
For certain kinds of files, <em class="emphasis">elvis</em>
formats the file content on the screen, giving a surprisingly good
approximation of a WYSIWYG effect.
<em class="emphasis">elvis</em> can also use the same formatting for
printing the buffer to several kinds of printers.
Display modes get their own subsection, below.</p></dd>


<?troff .wcon_off?><dt><i>Pre- and post-operation command files</i></dt><dd><em class="emphasis">elvis</em></tt> loads four files (if they exist),
that allow you to customize its behavior before and after
reading and writing a file.
This feature also gets its own subsection, below.</p></dd>


<dt><i>Open mode</i></dt><dd>
<a name="IXT-10-281573" />
<em class="emphasis">elvis</em> is the only one of the clones that
actually implements <em class="emphasis">vi</em>'s open mode.
(Think of open mode as like <em class="emphasis">vi</em>, but with only
a one-line window.


The "advantage" to open mode is that it can be used
on terminals that don't have cursor motion capabilities.)</p></dd>


<dt><i>Security</i></dt><dd>
<a name="IXT-10-281574" />
<a name="IXT-10-281575" />
<a name="IXT-10-281576" />
The <tt class="literal">:safer</tt> command sets the <tt class="literal">safer</tt>
option for execution of non-home-directory <em class="filename">.exrc</em></tt>
files, or any other untrusted files. When <tt class="literal">safer</tt>
is set, "certain commands are disabled, wildcard
expansion in filenames is disabled, and certain options are locked (including
the <tt class="literal">safer</tt> option itself)".
The <em class="emphasis">elvis</em></tt> documentation is no more
specific than this; don't blindly trust <em class="emphasis">elvis</em></tt> to
provide complete security for you.</p></dd>


<dt><i>Built-in calculator</i></dt><dd>
<a name="IXT-10-281577" />
<a name="IXT-10-281578" />
<a name="IXT-10-281579" />
<a name="IXT-10-281580" />
<em class="emphasis">elvis</em> extends the <em class="emphasis">ex</em> command
language with a built-in calculator (sometimes referred to as
an expression evaluator in the documentation). It understands C
expression syntax, and is most used in the <tt class="literal">:if</tt>,
<tt class="literal">:calc</tt>, and <tt class="literal">:eval</tt> commands.
See the online help for the details, as well as the sample
initialization files in the <em class="emphasis">elvis</em> distribution
for examples.</p></dd>


<dt><i>Macro debugger (2.1)</i></dt><dd><em class="emphasis">elvis</em></tt> 2.1 has a debugger for <em class="emphasis">vi</em></tt>
macros (the <tt class="literal">:map</tt> command). This can be useful when
writing complicated input or command maps.</p></dd>

</dl>

<a name="vi6-ch-10-sect-10.1" /><div class="sect2">
<h3 class="sect2">10.10.1. Display Modes</h3>

<p>
<a name="ch10.display1" />
<a name="ch10.display2" />
<a name="ch10.display3" />
<a name="ch10.display4" />
<a name="ch10.display5" />
<a name="ch10.display6" />
<a name="ch10.display7" />
<em class="emphasis">elvis</em></tt> has several display modes.
Depending on the kind of file, <em class="emphasis">elvis</em></tt>
produces a formatted version of the file,
producing a WYSIWYG effect.
The display modes are outlined in <a href="ch10_10.htm#vi6-ch-10-tab-11">Table 10.11</a>.</p>

<a name="vi6-ch-10-tab-11" /><h4 class="objtitle">Table 10.11. elvis Display Modes</h4><table border="1" cellpadding="3">

<tr>
<th>Mode</th>
<th>Display Appearance</th>
</tr>




<tr>
<td><tt class="literal">normal</tt></td>
<td><p><em class="emphasis" />No formatting,
<a name="IXT-10-281581" />
displays your text as it exists in the file.</p></td>
</tr>

<tr>
<td><tt class="literal">syntax</tt></td>
<td><p><em class="emphasis" />Like <tt class="literal">normal</tt>,
<a name="IXT-10-281582" />
but with syntax coloring turned on.</p></td>
</tr>

<tr>
<td><tt class="literal">hex</tt></td>
<td><p><em class="emphasis" />An interactive hex dump,
reminiscent of mainframe hex dumps.
<a name="IXT-10-281583" />
This is good for editing binary files.</p></td>
</tr>

<tr>
<td><tt class="literal">html</tt></td>
<td><p><em class="emphasis" />A simple Web
page formatter. The tag commands can be used to
<a name="ch10.mode1" />
follow links and return.</p></td>
</tr>

<tr>
<td><tt class="literal">man</tt></td>
<td><p><em class="emphasis" />Simple man page formatter.
Like the output of
<a name="ch10.mode2" />
<tt class="literal">nroff</tt> -<tt class="literal">man</tt>.</p></td>
</tr>


</table><p>

<p>
<a name="IXT-10-281584" />
<a name="IXT-10-281585" />
The <tt class="literal">:normal</tt> command will switch the display from
one of the formatted views to <tt class="literal">normal</tt> mode.
Use <tt class="literal">:display</tt> <tt><em class="replaceable"><tt>mode</tt></em></tt>
to switch back. As a shortcut, the <tt class="literal">^W d</tt>
command will toggle the display modes for the window.</p>

<p>Of the available modes, <tt class="literal">html</tt> and <tt class="literal">man</tt>
are the most WYSIWYG in nature.
The online documentation clearly defines the subset of both
markup languages that <em class="emphasis">elvis</em></tt> understands.</p>

<?troff .Nd 10?><p><em class="emphasis">elvis</em></tt> uses
the <tt class="literal">html</tt> mode for displaying its online
help, which is written in HTML and has <em class="emphasis">many</em></tt>
cross-referencing links within it.</p>

<p>The example below shows <em class="emphasis">elvis</em></tt> editing one of the
HTML help files. The screen is split. Both windows show the
same buffer; the bottom window is using the <tt class="literal">html</tt>
display mode, while the top is using the <tt class="literal">normal</tt>
display mode:</p>


<blockquote><pre class="code">&lt;html&gt;&lt;head&gt;
&lt;title&gt;Elvis 2.0 Sessions&lt;/title&gt;
&lt;/head&gt;&lt;body&gt;

&lt;h1&gt;10. SESSIONS, INITIALIZATION, AND RECOVERY&lt;/h1&gt;

This section of the manual describes the life-cycle of an
edit session. We begin with the definition of an
&lt;a href="#SESSION"&gt;edit session&lt;/a&gt; and
what that means to elvis.
This is followed by sections discussing
&lt;a href="#INIT"&gt;initialization&lt;/a&gt;
and &lt;a href="#RECOVER"&gt;recovery after a crash.&lt;/a&gt;
_____________________________________________________________________


<b class="emphasis-bold">10.0 SESSIONS, INITIALIZATION, AND RECOVERY</b>

        This section of the manual describes the life-cycle of an
        edit session. We begin with the definition of an <b class="emphasis-bold">edit
        session</b> and what that means to elvis. This is
        followed by sections discussing <b class="emphasis-bold">initialization</b> and 
        <b class="emphasis-bold">recovery after a crash.</b>

    <b class="emphasis-bold">10.1 Sessions</b></pre></blockquote>

<p>The <tt class="literal">man</tt> mode is also interesting, since
normally you have to format and print a man page to be sure you've
done a decent job of laying it out.
The following quote from the online help seems appropriate.</p>


<p>Troff source was never designed to be interactively edited, and although
I did the best I could, attempting to edit in <tt class="literal">man</tt> mode
is still a disorienting experience.
I suggest you get in the habit of using <tt class="literal">normal</tt> mode
when making changes, and
<tt class="literal">man</tt> mode to preview the effect of those changes.
The <tt class="literal">^W d</tt> command makes switching between modes
a pretty easy thing to do.</p>


<p>As an interesting adjunct, both the <tt class="literal">html</tt>
and <tt class="literal">man</tt> modes also work with the
<tt class="literal">:color</tt> command described in
<a href="ch10_09.htm#vi6-ch-10-sect-9.2">Section 10.9.2</a>.
This is particularly nice with <tt class="literal">man</tt> mode.
For example,
by default on a Linux console, only bold text (.B)
is distinguishable
from normal text. But with syntax coloring on, both bold and
italic (.I) text become distinct.
The mode commands are summarized in
<a href="ch10_10.htm#vi6-ch-10-tab-12">Table 10.12</a>.
<a name="IXT-10-281586" />
<a name="IXT-10-281587" /></p>

<a name="vi6-ch-10-tab-12" /><h4 class="objtitle">Table 10.12. elvis Display Mode Commands</h4><table border="1" cellpadding="3">

<tr>
<th>Command</th>
<th>Function</th>
</tr>




<tr>
<td><tt class="literal">di</tt>[<tt class="literal">splay</tt>] [<tt><em class="replaceable"><tt>mode</em></tt> [<tt><em class="replaceable">lang</tt></em></tt>]]</td>
<td><p><em class="emphasis" />Change the display mode
<a name="IXT-10-281588" />
<a name="IXT-10-281589" />
to <em class="emphasis">mode</em></tt>.
Use <em class="emphasis">lang</em></tt> for <tt class="literal">syntax</tt> mode.</p></td>
</tr>

<tr>
<td><tt class="literal">no[<tt class="literal">rmal</tt>]</tt></td>
<td><p><em class="emphasis" />Same as
<a name="IXT-10-281590" />
<a name="IXT-10-281591" />
<tt class="literal">:display normal</tt>,
but much easier to type.</p></td>
</tr>


</table><p>

<p>
<a name="IXT-10-281592" />
Associated with each window is the <tt class="literal">bufdisplay</tt>
option, which should be set to one of the supported display modes.
<a name="IXT-10-281593" />
The standard <em class="filename">elvis.arf</em></tt> file (see the
next subsection) will look at the extension of the buffer's
filename and attempt to set the display to a more interesting mode
than <tt class="literal">normal</tt>.</p>

<p>Finally, <em class="emphasis">elvis</em></tt> can also apply its WYSIWYG formatting
to printing the contents of a buffer.
<a name="IXT-10-281594" />
<a name="IXT-10-281595" />
<a name="IXT-10-281596" />
The <tt class="literal">:lpr</tt> command formats a line range (or the
whole buffer, by default) for printing.
You can print to a file or down a pipe to a command.
By default, <em class="emphasis">elvis</em></tt> prints to a pipe
that executes the system print spooling command.</p>

<p>The <tt class="literal">:lpr</tt> command is controlled by several
options, described in <a href="ch10_10.htm#vi6-ch-10-tab-13">Table 10.13</a>.</p>

<a name="vi6-ch-10-tab-13" /><h4 class="objtitle">Table 10.13. elvis Options for Print Management</h4><table border="1" cellpadding="3">

<tr>
<th>Option</th>
<th>Function</th>
</tr>




<tr>
<td><tt class="literal">lptype</tt>, <tt class="literal">lp</tt></td>
<td><p><em class="emphasis" />The printer type.
<a name="IXT-10-281597" /></p></td>
</tr>

<tr>
<td><tt class="literal">lpconvert</tt>, <tt class="literal">lpcvt</tt></td>
<td><p><em class="emphasis" />If set, convert Latin-8 extended
ASCII to PC-8 extended ASCII.
<a name="IXT-10-281598" /></p></td>
</tr>

<tr>
<td><tt class="literal">lpcrlf</tt>, <tt class="literal">lpc</tt></td>
<td><p><em class="emphasis" />The printer needs CR-LF to
end each line.
<a name="IXT-10-281599" /></p></td>
</tr>

<tr>
<td><tt class="literal">lpout</tt>, <tt class="literal">lpo</tt></td>
<td><p><em class="emphasis" />The file or command
to print to.
<a name="IXT-10-281600" /></p></td>
</tr>

<tr>
<td><tt class="literal">lpcolumns</tt>, <tt class="literal">lpcols</tt></td>
<td><p><em class="emphasis" />The printer's width.
<a name="IXT-10-281601" /></p></td>
</tr>

<tr>
<td><tt class="literal">lpwrap</tt>, <tt class="literal">lpw</tt></td>
<td><p><em class="emphasis" />Simulate line wrapping.
<a name="IXT-10-281602" /></p></td>
</tr>

<tr>
<td><tt class="literal">lplines</tt>, <tt class="literal">lprows</tt></td>
<td><p><em class="emphasis" />The length of
the printer's page.
<a name="IXT-10-281603" />
<a name="IXT-10-281604" /></p></td>
</tr>

<tr>
<td><tt class="literal">lpformfeed</tt>, <tt class="literal">lpff</tt></td>
<td><p><em class="emphasis" />Send a form-feed after the
last page.
<a name="IXT-10-281605" /></p></td>
</tr>

<tr>
<td><tt class="literal">lppaper</tt>, <tt class="literal">lpp</tt></td>
<td><p><em class="emphasis" />The size of the paper (letter, a4, etc.).
<a name="IXT-10-281606" />
This only matters for PostScript printers.</p></td>
</tr>


</table><p>

<?troff .wcon_off?><p>Most of the options are self-explanatory.
<em class="emphasis">elvis</em></tt> supports several printer types,
as described in
<a href="ch10_10.htm#vi6-ch-10-tab-14">Table 10.14</a>.</p>

<a name="vi6-ch-10-tab-14" /><h4 class="objtitle">Table 10.14. Values for the <tt class="literal">lptype</tt> Option</h4><table border="1" cellpadding="3">

<tr>
<th>Name</th>
<th>Printer Type</th>
</tr>




<tr>
<td><tt class="literal">ps</tt></td>
<td><p><em class="emphasis" />PostScript,
<a name="IXT-10-281607" />
one logical page per sheet of paper.</p></td>
</tr>

<tr>
<td><tt class="literal">ps2</tt></td>
<td><p><em class="emphasis" />PostScript,
two logical pages per sheet of paper.</p></td>
</tr>

<tr>
<td><tt class="literal">epson</tt></td>
<td><p><em class="emphasis" />Most dot-matrix printers,
<a name="IXT-10-281608" />
no graphic characters supported.</p></td>
</tr>

<tr>
<td><tt class="literal">pana</tt></td>
<td><p><em class="emphasis" />Panasonic dot-matrix printers.
<a name="IXT-10-281609" /></p></td>
</tr>

<tr>
<td><tt class="literal">ibm</tt></td>
<td><p><em class="emphasis" />Dot-matrix printers with IBM
<a name="IXT-10-281610" />
graphic characters.</p></td>
</tr>

<tr>
<td><tt class="literal">hp</tt></td>
<td><p><em class="emphasis" />Hewlett-Packard printers,
<a name="IXT-10-281611" />
and most non-PostScript laser printers.</p></td>
</tr>

<tr>
<td><tt class="literal">cr</tt></td>
<td><p><em class="emphasis" />Line printers,
<a name="IXT-10-281612" />
overtyping is done with carriage-return.</p></td>
</tr>

<tr>
<td><tt class="literal">bs</tt></td>
<td><p><em class="emphasis" />Overtyping is
done via backspace characters.
<a name="IXT-10-281613" />
This setting is the closest to traditional
UNIX <em class="emphasis">nroff</em></tt>.</p></td>
</tr>

<tr>
<td><tt class="literal">dumb</tt></td>
<td><p><em class="emphasis" />Plain ASCII,
<a name="IXT-10-281614" />
no font control.</p></td>
</tr>


</table><p>

<p>If you have a PostScript printer, by all means use an <tt class="literal">lptype</tt>
of <tt class="literal">ps</tt> or <tt class="literal">ps2</tt>. Use the latter to
save paper, which is particularly handy when printing drafts.</p>

<a name="IXT-10-281615" />
<a name="IXT-10-281616" />
<a name="IXT-10-281617" />
<a name="IXT-10-281618" />
<a name="IXT-10-281619" />
<a name="IXT-10-281620" />
<a name="IXT-10-281621" />
</div>




<a name="vi6-ch-10-sect-10.2" /><div class="sect2">
<h3 class="sect2">10.10.2. Pre- and Post-Operation Control Files</h3>

<p>
<a name="IXT-10-281622" />
<a name="IXT-10-281623" />
<em class="emphasis">elvis</em></tt> gives you the ability to control its
actions at four points when reading and writing files:
before and after reading a file, and before and
after writing a file.
It does this by executing the contents of four <em class="emphasis">ex</em></tt>
scripts at those respective points.
These scripts are searched for using the directories listed in the
<tt class="literal">elvispath</tt> option.</p>

<dl>
<dt><i><em class="filename">elvis.brf</em></tt></i></dt><dd>
<a name="IXT-10-281624" />
This file is executed Before Reading a File.
The default version looks at the file's extension,
and attempts to guess whether or not the file is binary.
If it is, the <tt class="literal">binary</tt> option is turned on,
to prevent <em class="emphasis">elvis</em> from converting newlines
(which may be actual CR-LF pairs in the file) into
linefeeds internally.</p></dd>


<dt><i><em class="filename">elvis.arf</em></tt></i></dt><dd>
<a name="IXT-10-281625" />
This file is executed After Reading a File.
The default version examines the file's extension
in order to turn on syntax highlighting.</p></dd>


<dt><i><em class="filename">elvis.bwf</em></tt></i></dt><dd>
<a name="IXT-10-281626" />
This file is executed Before Writing a File,
in particular, before completely replacing an original file
with the contents of the buffer.
The default version implements copying the original file to
a file with a <em class="filename">.bak</em> extension.
You must set the <tt class="literal">backup</tt> option for this to work.</p></dd>


<dt><i><em class="filename">elvis.awf</em></tt></i></dt><dd>
<a name="IXT-10-281627" />
This file is executed After Writing a File.
There is no default file for this,
although it might be a good place to add hooks into
a source code control system.
</p></dd>

</dl>

<p>The use of command files to control these actions is quite powerful.
It allows you to easily tailor <em class="emphasis">elvis</em></tt>'
behavior to suit your needs; in other editors
these kinds of features
are much more hardwired into the code.</p>
</div>




<a name="IXT-10-281628" />


<hr width="684" align="left" />
<div class="navbar"><table width="684" border="0"><tr><td align="left" valign="top" width="228"><a href="ch10_09.htm"><img src="../gifs/txtpreva.gif" alt="Previous" border="0" /></a></td><td align="center" valign="top" width="228"><a href="index.htm"><img src="../gifs/txthome.gif" alt="Home" border="0" /></a></td><td align="right" valign="top" width="228"><a href="ch10_11.htm"><img src="../gifs/txtnexta.gif" alt="Next" border="0" /></a></td></tr><tr><td align="left" valign="top" width="228">10.9. Programming Assistance</td><td align="center" valign="top" width="228"><a href="index/index.htm"><img src="../gifs/index.gif" alt="Book Index" border="0" /></a></td><td align="right" valign="top" width="228">10.11. elvis Futures</td></tr></table></div>
<hr width="684" align="left" />

<img src="../gifs/navbar.gif" usemap="#library-map" border="0" alt="Library Navigation Links" />
<p><p><font size="-1"><a href="copyrght.htm">Copyright &copy; 2003</a> O'Reilly &amp; Associates. All rights reserved.</font></p>

<map name="library-map">
<area shape="rect" coords="1,0,88,96" href="../index.htm"><area shape="rect" coords="90,0,165,96" href="../upt/index.htm"><area shape="rect" coords="168,1,253,107" href="../mac/index.htm"><area shape="rect" coords="255,0,335,97" href="../korn/index.htm"><area shape="rect" coords="337,0,415,109" href="../unixnut/index.htm"><area shape="rect" coords="417,0,512,122" href="../sedawk/index.htm"><area shape="rect" coords="514,0,605,105" href="../lunix/index.htm"><area shape="rect" coords="611,2,694,121" href="../vi/index.htm">
</map>

</body></html>