<html><head><title>Programming Assistance (Learning the vi Editor, Sixth Edition)</title><link rel="stylesheet" type="text/css" href="../style/style1.css" />

<meta name="DC.Creator" content="Linda Lamb and Arnold Robbins" /><meta name="DC.Format" content="text/xml" scheme="MIME" /><meta name="DC.Language" content="en-US" /><meta name="DC.Publisher" content="O'Reilly &amp; Associates, Inc." /><meta name="DC.Source" scheme="ISBN" content="1-56592-426-6" /><meta name="DC.Subject.Keyword" content="stuff" /><meta name="DC.Title" content="Learning the vi Editor, Sixth Edition" /><meta name="DC.Type" content="Text.Monograph" />

</head><body bgcolor="#ffffff">

<img src="gifs/smbanner.gif" usemap="#banner-map" border="0" alt="Book Home" /><map name="banner-map"><area shape="rect" coords="1,-2,616,66" href="index.htm" alt="Learning the vi Editor" /><area shape="rect" coords="629,-11,726,25" href="jobjects/fsearch.htm" alt="Search this book" /></map>

<div class="navbar"><table width="684" border="0"><tr><td align="left" valign="top" width="228"><a href="ch11_08.htm"><img src="../gifs/txtpreva.gif" alt="Previous" border="0" /></a></td><td align="center" valign="top" width="228" /><td align="right" valign="top" width="228"><a href="ch11_10.htm"><img src="../gifs/txtnexta.gif" alt="Next" border="0" /></a></td></tr></table></div>



<h2 class="sect1">11.9. Programming Assistance</h2>

<a name="ch11.prog1" />
<a name="ch11.prog2" />
<a name="ch11.prog3" /><p><em class="emphasis">vim</em> has extensive facilities for both the edit-compile-debug
cycle and syntax highlighting.</p>

<a name="vi6-ch-11-sect-9.1" /><div class="sect2">
<h3 class="sect2">11.9.1. Edit-Compile Speedup</h3>

<p>
<a name="IXT-11-281838" />
<a name="IXT-11-281839" />
<a name="IXT-11-281840" />
The facilities in <em class="emphasis">vim</em> were inspired by
the "quick fix" mode of the Manx Aztec C compiler
for the Amiga.
In fact, the <em class="emphasis">vim</em> documentation refers to this
feature as "quick fix" mode.
The features are quite flexible, allowing you to
tailor them to your programming environment (see <a href="ch11_09.htm#vi6-ch-11-tab-12">Table 11.12</a>).</p>

<a name="vi6-ch-11-tab-12" /><h4 class="objtitle">Table 11.12. vim Program Development Commands</h4><table border="1" cellpadding="3">

<tr>
<th>Command</th>
<th>Function</th>
</tr>





<tr>
<td><tt class="literal">mak</tt>[<tt class="literal">e</tt>] [<em class="replaceable"><tt>arguments</tt></em>]</td>
<td><p>Run <em class="emphasis">make</em>, based
<a name="IXT-11-281841" />
on the settings of several options as described below, then go to the
location of the first error.</p></td>
</tr>

<tr>
<td><tt class="literal">cf</tt>[<tt class="literal">ile</tt>][<tt class="literal">!</tt>] [<em class="replaceable"><tt>errorfile</tt></em>]</td>
<td><p>Read the error file and
<a name="IXT-11-281842" />
jump to the first error. With an <em class="emphasis">errorfile</em>,
use that file for errors and set the <tt class="literal">errorfile</tt>
option to it.
The <tt class="literal">!</tt> forces <em class="emphasis">vim</em> to move to
another buffer if the current one
has been modified but not saved.</p></td>
</tr>

<tr>
<td><tt class="literal">cl</tt>[<tt class="literal">ist</tt>][<tt class="literal">!</tt>]</td>
<td><p>List the errors that
include a filename.
<a name="IXT-11-281843" />
With <tt class="literal">!</tt>, list all errors.</p></td>
</tr>

<tr>
<td>[<em class="replaceable"><tt>count</tt></em>]<tt class="literal">cn</tt>[<tt class="literal">ext</tt>][<tt class="literal">!</tt>]</td>
<td><p>Display the
<em class="emphasis">count</em>th next error that
includes a filename. If there are no filenames at
<a name="IXT-11-281844" />
all, go to the <em class="emphasis">count</em>th next error.</p></td>
</tr>


<tr>
<td>[<em class="replaceable"><tt>count</tt></em>]<tt class="literal">cN</tt>[<tt class="literal">ext</tt>][<tt class="literal">!</tt>]</td>
<td rowspan="1"><p>Display the
<em class="emphasis">count</em>th previous error that
includes a filename. If there are no filenames at
<a name="IXT-11-281845" />
all, go to the <em class="emphasis">count</em>th previous error.</p></td>
</tr>

<tr>
<td>[<em class="replaceable"><tt>count</tt></em>]<tt class="literal">cp</tt>[<tt class="literal">revious</tt>][<tt class="literal">!</tt>]
<a name="IXT-11-281846" /></td>
</tr>


<tr>
<td><tt class="literal">clast</tt>[<tt class="literal">!</tt>] [<em class="replaceable"><tt>n</tt></em>]</td>
<td><p>Display error
<em class="emphasis">n</em> if supplied.
<a name="IXT-11-281847" />
Otherwise, display the last error.</p></td>
</tr>

<tr>
<td><tt class="literal">crewind</tt>[<tt class="literal">!</tt>] [<em class="replaceable"><tt>n</tt></em>]</td>
<td><p>Display error
<em class="emphasis">n</em> if supplied.
<a name="IXT-11-281848" />
Otherwise, display the first error.</p></td>
</tr>

<tr>
<td><tt class="literal">cc</tt>[<tt class="literal">!</tt>] [<em class="replaceable"><tt>n</tt></em>]</td>
<td><p>Displays error <em class="emphasis">n</em>
<a name="IXT-11-281849" />
if supplied, otherwise redisplays the current error.</p></td>
</tr>

<tr>
<td><tt class="literal">cq</tt>[<tt class="literal">uit</tt>]</td>
<td><p>Quit with an error code,
<a name="IXT-11-281850" />
so that the compiler will not compile the same file again.
This is intended primarily for use with the Amiga compiler.</p></td>
</tr>


</table><p><p>

<p>Like <em class="emphasis">elvis</em>,
as you move through the errors
<em class="emphasis">vim</em> also compensates for changes in the file,
so that when you go to the next error, you end up on the correct
line.</p>

<p>
<a name="IXT-11-281851" />
The <em class="emphasis">vim</em> options that control the <tt class="literal">:make</tt>
command are presented in
<a href="ch11_09.htm#vi6-ch-11-tab-13">Table 11.13</a>.</p>

<a name="vi6-ch-11-tab-13" /><h4 class="objtitle">Table 11.13. vim Program Development Options</h4><table border="1" cellpadding="3">

<tr>
<th>Option</th>
<th>Value</th>
<th>Function</th>
</tr>




<tr>
<td><tt class="literal">shell</tt></td>
<td><tt class="literal">/bin/sh</tt></td>
<td><p>The shell to use to execute
<a name="IXT-11-281852" />
the command for rebuilding your program.</p></td>
</tr>

<tr>
<td><tt class="literal">makeprg</tt></td>
<td><tt class="literal">make</tt></td>
<td><p>The program that will actually
<a name="IXT-11-281853" />
handle all the recompilation.</p></td>
</tr>

<tr>
<td><tt class="literal">shellpipe</tt></td>
<td><tt class="literal">2&gt;&amp;1| tee</tt></td>
<td><p>Whatever is needed to cause
the shell to save both standard output and standard error
<a name="IXT-11-281854" />
from the compilation in the error file.</p></td>
</tr>

<tr>
<td><tt class="literal">makeef</tt></td>
<td><tt class="literal">/tmp/vim##.err</tt></td>
<td><p>The name of a file which will
contain the compiler output. The <tt class="literal">##</tt> causes
<a name="IXT-11-281855" />
<em class="emphasis">vim</em> to create unique filenames.</p></td>
</tr>

<tr>
<td><tt class="literal">errorformat</tt></td>
<td><tt class="literal">%f:%l:\ %m</tt></td>
<td><p>A description of what
<a name="IXT-11-281856" />
error messages from the compiler look like. This example
value is for GCC, the GNU C compiler.</p></td>
</tr>


</table><p><p>

<p>When you execute <tt class="literal">:make</tt>,
<em class="emphasis">vim</em> constructs a command by concatenating
the various pieces described above.
Any arguments you supply are passed to <em class="emphasis">make</em>
in the appropriate place.
It then echoes this command to your screen.
For example, if you type
<tt class="literal">:make -k</tt>, you might see something like this:</p>

<blockquote><pre class="code">:!make -k 2&gt;&amp;1| tee /tmp/vim34215.err
...</pre></blockquote>

<p>By using the <em class="emphasis">tee</em>(1) program, the output from
<em class="emphasis">make</em> and the compiler is saved in the error file
(<em class="filename">/tmp/vim34215.err</em>), and also sent to standard
output, in this case your screen.</p>

<p>When the <em class="emphasis">make</em> finishes, <em class="emphasis">vim</em> reads
the error file, and goes to the location of the first error.
It uses the value of the <tt class="literal">errorformat</tt> option
to parse the contents of the error file, in order to find file
names and line numbers.
(The format of this variable is described in full in
<tt class="literal">:help errorformat</tt>.)
You can then use the <tt class="literal">:cc</tt>
command to see the error messages, and the <tt class="literal">:cnext</tt>
command to move to the next error.</p>
</div>




<a name="vi6-ch-11-sect-9.2" /><div class="sect2">
<h3 class="sect2">11.9.2. Syntax Highlighting</h3>

<p>
<a name="IXT-11-281857" />
<a name="IXT-11-281858" />
<a name="IXT-11-281859" />
Highlighting in <em class="emphasis">vim</em> is based primarily on colors.
To enable syntax highlighting, put <tt class="literal">syntax on</tt>
into your <em class="filename">.vimrc</em> file.
This will cause <em class="emphasis">vim</em> to read
<a name="IXT-11-281860" />
the <em class="filename">syntax.vim</em> file, which defines the default
highlight coloring and then sets things up to use highlighting
appropriate to each language.</p>

<p><em class="emphasis">vim</em> has a very powerful sub-language for
defining syntax highlighting. The <em class="filename">syntax.txt</em>
help file in <em class="emphasis">vim</em> 5.1 that describes it
is over 1,500 lines long. Therefore, we won't attempt
to give all the details here. Instead, the sample file
below should give you some taste for what <em class="emphasis">vim</em> can
do. The example consists of portions of the syntax file for Awk:</p>

<blockquote><pre class="code">" Vim syntax file
" Language:	awk, nawk, gawk, mawk
" Maintainer:	Antonio Colombo &lt;antonio.colombo@jrc.org&gt;
" Last change:	1997 November 29

" Remove any old syntax stuff hanging around
syn clear

" A bunch of useful Awk keywords
syn keyword awkStatement        break continue delete exit
...

syn keyword awkFunction         atan2 close cos exp int log rand sin \
                                sqrt srand
...

syn keyword awkConditional      if else
syn keyword awkRepeat           while for do

syn keyword awkPatterns         BEGIN END
syn keyword awkVariables        ARGC ARGV FILENAME FNR FS NF NR
...

" Octal format character.
syn match   awkSpecialCharacter contained "\\[0-7]\{1,3\}"
" Hex   format character.
syn match   awkSpecialCharacter contained "\\x[0-9A-Fa-f]\+"

syn match   awkFieldVars        "\$[0-9]\+"

syn match   awkCharClass        contained "\[:[^:\]]*:\]"
syn match   awkRegExp	contained "/\^"ms=s+1
syn match   awkRegExp	contained "\$/"me=e-1
syn match   awkRegExp	contained "[?.*{}|+]"
...

" Numbers, allowing signs (both -, and +)
" Integer number.
syn match  awkNumber            "[+-]\=\&lt;[0-9]\+\&gt;"
" Floating point number.
syn match  awkFloat             "[+-]\=\&lt;[0-9]\+\.[0-9]+\&gt;"
...

syn match  awkComment	"#.*" contains=awkTodo

if !exists("did_awk_syntax_inits")
  let did_awk_syntax_inits = 1
  " The default methods for highlighting.  Can be overridden later
  hi link awkConditional        Conditional
  hi link awkFunction           Function
  hi link awkRepeat             Repeat
  hi link awkStatement          Statement
  ...
  hi link awkNumber             Number
  hi link awkFloat              Float
  ...

  hi link awkComment            Comment
  ...
endif

let b:current_syntax = "awk"</pre></blockquote>

<p>The file above uses <tt class="literal">syntax keyword</tt> to give names
to certain classes of keywords (such as real Awk keywords and built-in
functions), and <tt class="literal">syntax match</tt>
to give names to regular expressions that match certain kinds of
objects (such as numbers).
Then the <tt class="literal">hi link</tt> statements link the named classes
of objects to the predefined highlighting conventions.</p>

<p>The <em class="filename">syntax.vim</em> file predefines the standard
conventions, with a number of lines like these:</p>

<blockquote><pre class="code">hi Comment	term=bold ctermfg=Cyan guifg=#80a0ff
hi Constant	term=underline ctermfg=Magenta guifg=#ffa0a0
hi Special	term=bold ctermfg=LightRed guifg=Orange
hi Identifier	term=underline ctermfg=DarkCyan guifg=#40ffff
...</pre></blockquote>

<p>The first argument defines the class, and the rest define what kind
of highlighting to do on what kind of terminal. <tt class="literal">term</tt>
is for a normal terminal, <tt class="literal">cterm</tt> is for a color
terminal (in this case, the ForeGround color), and <tt class="literal">gui</tt>
is for <em class="emphasis">vim</em>'s GUI interface.</p>

<p>In <em class="emphasis">vim</em>, the syntax colors are global
attributes. Changing the <tt class="literal">Comment</tt> color
changes the color for all comments in all windows, no
matter what programming language you're editing.</p>

<p>Since the syntax descriptions use attribute linking, you can
make language-specific changes. For example, to change the comment
color for Awk, you can define attributes for <tt class="literal">awkComment</tt>,
like this:</p>

<blockquote><pre class="code">hi awkComment guifg=Green</pre></blockquote>

<p><em class="emphasis">vim</em> comes with a large number of syntax descriptions
for different languages. The coloring for Awk is
slightly psychedelic (lots of red and pink), although the coloring
for context diffs is actually rather pleasant,
as is the color scheme for UNIX mailbox files.
The HTML mode is also pretty interesting.
Overall, it's quite a lot of fun to use.</p>
</div>




<a name="IXT-11-281861" />
<a name="IXT-11-281862" />
<a name="IXT-11-281863" />


<hr width="684" align="left" />
<div class="navbar"><table width="684" border="0"><tr><td align="left" valign="top" width="228"><a href="ch11_08.htm"><img src="../gifs/txtpreva.gif" alt="Previous" border="0" /></a></td><td align="center" valign="top" width="228"><a href="index.htm"><img src="../gifs/txthome.gif" alt="Home" border="0" /></a></td><td align="right" valign="top" width="228"><a href="ch11_10.htm"><img src="../gifs/txtnexta.gif" alt="Next" border="0" /></a></td></tr><tr><td align="left" valign="top" width="228">11.8. Improved Editing Facilities</td><td align="center" valign="top" width="228"><a href="index/index.htm"><img src="../gifs/index.gif" alt="Book Index" border="0" /></a></td><td align="right" valign="top" width="228">11.10. Interesting Features</td></tr></table></div>
<hr width="684" align="left" />

<img src="../gifs/navbar.gif" usemap="#library-map" border="0" alt="Library Navigation Links" />
<p><p><font size="-1"><a href="copyrght.htm">Copyright &copy; 2003</a> O'Reilly &amp; Associates. All rights reserved.</font></p>

<map name="library-map">
<area shape="rect" coords="1,0,88,96" href="../index.htm"><area shape="rect" coords="90,0,165,96" href="../upt/index.htm"><area shape="rect" coords="168,1,253,107" href="../mac/index.htm"><area shape="rect" coords="255,0,335,97" href="../korn/index.htm"><area shape="rect" coords="337,0,415,109" href="../unixnut/index.htm"><area shape="rect" coords="417,0,512,122" href="../sedawk/index.htm"><area shape="rect" coords="514,0,605,105" href="../lunix/index.htm"><area shape="rect" coords="611,2,694,121" href="../vi/index.htm">
</map>

</body></html>