<html><head><title>The vi Text Editor (Learning the vi Editor, Sixth Edition)</title><link rel="stylesheet" type="text/css" href="../style/style1.css" />

<meta name="DC.Creator" content="Linda Lamb and Arnold Robbins" /><meta name="DC.Format" content="text/xml" scheme="MIME" /><meta name="DC.Language" content="en-US" /><meta name="DC.Publisher" content="O'Reilly &amp; Associates, Inc." /><meta name="DC.Source" scheme="ISBN" content="1-56592-426-6" /><meta name="DC.Subject.Keyword" content="stuff" /><meta name="DC.Title" content="Learning the vi Editor, Sixth Edition" /><meta name="DC.Type" content="Text.Monograph" />

</head><body bgcolor="#ffffff">

<img src="gifs/smbanner.gif" usemap="#banner-map" border="0" alt="Book Home" /><map name="banner-map"><area shape="rect" coords="1,-2,616,66" href="index.htm" alt="Learning the vi Editor" /><area shape="rect" coords="629,-11,726,25" href="jobjects/fsearch.htm" alt="Search this book" /></map>

<div class="navbar"><table width="684" border="0"><tr><td align="left" valign="top" width="228"><a href="part1.htm"><img src="../gifs/txtpreva.gif" alt="Previous" border="0" /></a></td><td align="center" valign="top" width="228" /><td align="right" valign="top" width="228"><a href="ch01_02.htm"><img src="../gifs/txtnexta.gif" alt="Next" border="0" /></a></td></tr></table></div>


<h1 class="chapter">Chapter 1. The vi Text Editor</h1>
<div class="htmltoc"><h4 class="tochead">Contents:</h4><p>
<a href="ch01_01.htm#sect1">Opening and Closing Files </a><br />
<a href="ch01_02.htm">Quitting Without Saving Edits </a><br /></p></div><p>UNIX has a number of editors that can process the contents of text files,
whether those files contain data, source code, or sentences.
<a name="IXT-1-280225" />
<a name="IXT-1-280226" />
<a name="IXT-1-280227" />
<a name="IXT-1-280228" />
There are line editors, such as <em class="emphasis">ed</em> and <em class="emphasis">ex</em>, which
display a line of the file on the screen;
and there are screen editors, such as <em class="emphasis">vi</em> and <em class="emphasis">emacs</em>,
which display a part of the file on your terminal screen.
<a name="IXT-1-280229" />
Text editors based on the X Window System are also commonly available,
and are becoming increasing popular.
Both GNU <em class="emphasis">emacs</em> and its derivative <em class="emphasis">xemacs</em>
provide multiple X windows;
an interesting alternative is the <em class="emphasis">sam</em> editor from
Bell Labs.
All but one of the <em class="emphasis">vi</em> clones described in
<a href="part2.htm">Part II</a> of this book also provide X-based interfaces.</p><p>
<a name="IXT-1-280230" />
<em class="emphasis">vi</em> is the most useful standard text editor on your system.
(<em class="emphasis">vi</em> is short for <em class="emphasis">vi</em>sual editor and is pronounced "vee-eye.")
<a name="IXT-1-280231" />
Unlike <em class="emphasis">emacs</em>, it is available in nearly identical form on
almost every UNIX system, thus providing a kind of text-editing
<em class="emphasis">lingua franca</em>.<a href="#FOOTNOTE-3">[3]</a>
The same might be said of <em class="emphasis">ed</em> and
<em class="emphasis">ex</em>, but screen editors are generally much easier to use.
With a screen editor, you can scroll the page, move the cursor, delete
lines, insert characters, and more, while seeing the results of your
edits as you make them.
Screen editors are very popular, since they
allow you to make changes as you read through a file, like you
would edit a printed copy, only faster.</p><blockquote class="footnote">

<a name="FOOTNOTE-3" /><p> [3]Actually, these days, GNU <em class="emphasis">emacs</em> is pretty much the
universal version of <em class="emphasis">emacs</em>; the only problem is
it doesn't come standard with most commercial UNIX systems;
you must retrieve and install it yourself.</p>

</blockquote><p>To many beginners, <em class="emphasis">vi</em> looks unintuitive and
cumbersome&#8212;instead of using special
control keys for word processing functions and just letting you type
normally, it uses all of the regular keyboard keys for issuing
commands. When the keyboard keys are issuing commands, <em class="emphasis">vi</em> is
said to be in <em class="emphasis">command mode</em>.
You must be in a special <em class="emphasis">insert mode</em> before you can type actual
text on the screen.
In addition, there seem to be so many commands.</p><p>
<a name="IXT-1-280232" />
<a name="IXT-1-280233" />
<a name="IXT-1-280234" />
<a name="ch01.command" />
Once you start learning, however, you realize that <em class="emphasis">vi</em> is well designed.
You need only a few keystrokes to tell <em class="emphasis">vi</em> to do complex tasks.
As you learn
<em class="emphasis">vi</em>, you learn shortcuts that transfer more and more of the
editing work to the computer&#8212;where it belongs.</p><p><em class="emphasis">vi</em> (like any text editor) is not a "what you see is
what you get" word processor.
If you want to produce formatted documents, you must type in
codes that are used by another formatting program to control the
appearance of the printed copy.
If you want to indent several paragraphs,
for instance, you put a code where the indent begins and ends.
<a name="IXT-1-280235" />
Formatting codes allow you to experiment with or change the appearance
of your printed files, and in many ways, give you much more
control over the appearance of your documents than a word
processor.
<a name="IXT-1-280236" />
UNIX supports the <em class="emphasis">troff</em> formatting package.<a href="#FOOTNOTE-4">[4]</a>
The

and

formatters are popular, commonly available alternatives.</p><blockquote class="footnote">

<a name="FOOTNOTE-4" /><p> [4]<em class="emphasis">troff</em> is for laser printers and typesetters.
Its "twin brother" is <em class="emphasis">nroff</em>,
for line printers and terminals.
Both accept the same input language.
<a name="IXT-1-280237" />
Following common UNIX convention, we refer to both
with the name <em class="emphasis">troff</em>.</p>

</blockquote><p>(<em class="emphasis">vi</em> does support some simple formatting mechanisms.
For example, you can tell it to automatically wrap when you come to
the end of a line, or to automatically indent new lines.)</p><p>As with any skill, the more editing you do, the easier the basics become, and
the more you can accomplish.
Once you are used to all the powers you have while editing with
<em class="emphasis">vi</em>, you may never want to return to any "simpler" editor.</p><p>What are the components of editing? 
First, you want to
<em class="emphasis">insert</em> text (a forgotten word or a missing sentence), and
you want to <em class="emphasis">delete</em> text (a stray character or an
entire paragraph).
You also need to <em class="emphasis">change</em> letters and words
(to correct misspellings or to reflect a change of mind about a term).
You might want to <em class="emphasis">move</em> text from one place to another
part of your file.
And, on occasion, you want to <em class="emphasis">copy</em>
text to duplicate it in another part of your file.</p><p>
<a name="IXT-1-280238" />
Unlike many word processors, <em class="emphasis">vi</em>'s
command mode is the initial or "default" mode.
Complex, interactive edits can be performed with only a few keystrokes.
(And to insert raw text, you simply give any of the several
"insert" commands and then type away.)</p><p>One or two characters are used for the basic commands.
For example:</p><dl>
<dt><tt class="literal">i</tt></dt><dd>insert</p></dd>


<dt><tt class="literal">cw</tt></dt><dd>change word</p></dd>

</dl><p>Using letters as commands, you can edit a file with great speed.
You don't have to memorize banks of function keys or stretch your
fingers to reach awkward combinations of keys.
Most of the commands can be remembered by the letter that
performs them, and nearly all commands follow similar
patterns and are related to each other.</p><p>In general, <em class="emphasis">vi</em> commands:</p><ul><li><p>Are case-sensitive (uppercase and lowercase keystrokes
mean different things;  <tt class="literal">I</tt> is different from <tt class="literal">i</tt>).
<a name="IXT-1-280239" /></p></li><li><p>Are not shown (or "echoed") on the screen when you type them.
<a name="IXT-1-280240" /></p></li><li><p>Do not require a
<span class="keycap">RETURN</span> after the command.</p></li></ul><p>
<a name="IXT-1-280241" />
<a name="IXT-1-280242" />
There is also a group of commands that echo on the bottom
line of the screen. Bottom-line commands are preceded by
different symbols.
<a name="IXT-1-280243" />
<a name="IXT-1-280244" />
<a name="IXT-1-280245" />
<a name="IXT-1-280246" />
The slash (<tt class="literal">/</tt>) and the question mark (<tt class="literal">?</tt>)
begin search commands, and are discussed
in <a href="ch03_01.htm">Chapter 3</a>.
<a name="IXT-1-280247" />
<a name="IXT-1-280248" />
<a name="IXT-1-280249" />
<a name="IXT-1-280250" />
A colon (<tt class="literal">:</tt>) begins all <em class="emphasis">ex</em> commands.  <em class="emphasis">ex</em> commands
are those that are used by the <em class="emphasis">ex</em> line editor.
The <em class="emphasis">ex</em> editor is available to you when you use <em class="emphasis">vi</em>, because
<em class="emphasis">ex</em> is the underlying editor, and
<em class="emphasis">vi</em> is really just its "visual" mode.
<em class="emphasis">ex</em> commands and concepts are discussed fully in
<a href="ch05_01.htm">Chapter 5</a>,
but this chapter introduces you to the
<em class="emphasis">ex</em> commands to quit a file without saving edits.
<a name="IXT-1-280251" /></p><div class="sect1"><a name="vi6-ch-1-sect-1" />
<h2 class="sect1"><a name="sect1" />1.1. Opening and Closing Files </h2>

<p>You can use <em class="emphasis">vi</em> to edit any text file.
<em class="emphasis">vi</em> copies the file to be
edited into a <em class="emphasis">buffer</em> (an area temporarily set aside in memory),
displays the buffer (though you can see only one screenful at a
<a name="IXT-1-280252" />
<a name="IXT-1-280253" />
time), and
lets you add, delete, and change text.
When you save your edits,
<em class="emphasis">vi</em> copies the edited buffer back into a permanent file, replacing
the old file of the same name.
Remember that you are always working on a <em class="emphasis">copy</em> of your file in
the buffer, and that your edits will not affect your original file
until you save the buffer. Saving your edits is also called
"writing the buffer," or more
commonly, "writing your file."
<a name="IXT-1-280254" /></p>

<a name="vi6-ch-1-sect-1.1" /><div class="sect2">
<h3 class="sect2">1.1.1. Opening a File </h3>

<p>
<a name="ch01.open1" />
<a name="ch01.open2" />
<a name="IXT-1-280255" />
<a name="IXT-1-280256" />
<img src="figs/VI.icon.lcv.gif" alt="Figure " width="30" /><img src="figs/VI.icon.lci.gif" alt="Figure " width="30" />
<tt class="literal">vi</tt> is the UNIX command that invokes the <em class="emphasis">vi</em> editor for
an existing file or for a brand new file.
The syntax for the <tt class="literal">vi</tt> command is:</p>

<blockquote><pre class="code">$ <tt class="userinput"><b>vi</b></tt> [<em class="replaceable"><tt>filename</tt></em>]</pre></blockquote>

<p>The brackets shown on the above command line indicate that the
filename is optional.
The brackets should not be typed.
The <tt class="literal">$</tt> is the UNIX prompt.
If the filename is omitted,
<em class="emphasis">vi</em> will open an unnamed buffer.
You can assign the name when you write the buffer into a file.
For right now, though,
let's stick to naming the file on the command line.</p>

<p>
<a name="IXT-1-280257" />
A filename must be unique inside its directory.
On older System V UNIX
systems, it cannot exceed 14 characters in length (most common UNIX
systems allow much longer names).
<a name="IXT-1-280258" />
<a name="IXT-1-280259" />
A filename can include any 8-bit
character except a slash (/), which is reserved as the separator
between files
and directories in a pathname,
and ASCII NUL, the character with all zero bits.
<a name="IXT-1-280260" />
<a name="IXT-1-280261" />
You can even include spaces in a filename by typing a backslash
(\) before the space.
In practice, though, filenames generally consist of any combination of
uppercase and lowercase letters, numbers, and the characters
dot (.) and underscore (_).
<a name="IXT-1-280262" />
Remember that UNIX is
case-sensitive: lowercase letters are distinct from uppercase letters.
Also remember that you must press
<span class="keycap">RETURN</span> to tell UNIX that you are finished issuing your command.</p>

<p> 
When you want to open a new file in a directory, give a new
filename with the <tt class="literal">vi</tt> command.
For example, if you want to open a new
file called <em class="filename">practice</em> in the current directory, you would enter:</p>

<blockquote><pre class="code">$ <tt class="userinput"><b>vi practice</b></tt></pre></blockquote>

<p>Since this is a new file, the buffer is empty and the screen appears
as follows:</p>

<blockquote><pre class="code">~
~
~
"practice" [New file].</pre></blockquote>

<p>
<a name="IXT-1-280263" />
<a name="IXT-1-280264" />
The tildes (~) down the left-hand column of the screen indicate
that there is no text in the file, not even blank lines.
<a name="IXT-1-280265" />
<a name="IXT-1-280266" />
The prompt line
(also called the status line)
at the bottom of the screen echoes the name and status of the file.</p>

<p>You can also edit any existing text file in a directory by specifying
its filename.
<a name="IXT-1-280267" />
Suppose that there is a UNIX file with the pathname <em class="filename">/home/john/letter</em>.
If you are already in the <em class="filename">/home/john</em> directory, use the relative pathname.
For example:</p>

<blockquote><pre class="code">$ <tt class="userinput"><b>vi letter</b></tt></pre></blockquote>

<p>brings a copy of the file <em class="filename">letter</em> to the screen.</p>

<p>
<a name="IXT-1-280268" />
If you are in another directory, give the full pathname to begin editing:</p>

<blockquote><pre class="code">$ <tt class="userinput"><b>vi /home/john/letter</b></tt></pre></blockquote>
</div>




<a name="vi6-ch-1-sect-1.2" /><div class="sect2">
<h3 class="sect2">1.1.2. Problems Opening Files </h3>

<a name="ch01.troubleopen" />
<a name="IXT-1-280269" />
<a name="IXT-1-280270" />
<a name="IXT-1-280271" />
<ul>
<li><p>
<em class="emphasis">When you invoke </em>vi<em class="emphasis">,
the message <tt class="literal">[open mode]</tt> appears.</em>
<a name="IXT-1-280272" /></p>

<p>
<a name="IXT-1-280273" />
<a name="IXT-1-280274" />
Your terminal type is probably incorrectly identified.
Quit the editing session immediately by typing <tt class="literal">:q</tt>.
Check the environment variable <tt class="literal">$TERM</tt>. It should
be set to the name of your terminal.
Or ask your
system administrator to provide an adequate terminal type setting.</p></li>

<li><p>
<em class="emphasis">You see one of the following messages:</em>
<a name="IXT-1-280275" />
<a name="IXT-1-280276" />
<a name="IXT-1-280277" />
<a name="IXT-1-280278" />
<a name="IXT-1-280279" />
<a name="IXT-1-280280" /></p>



<blockquote><pre class="code">  Visual needs addressable cursor or upline capability
  Bad termcap entry
  Termcap entry too long
  <em class="replaceable"><tt>terminal</tt></em>:  Unknown terminal type
  Block device required
  Not a typewriter</pre></blockquote>



<p>
<a name="IXT-1-280281" />
<a name="IXT-1-280282" />
Your terminal type is either undefined, or there's probably something
wrong with your <em class="emphasis">terminfo</em> or <em class="emphasis">termcap</em> entry.
Enter <tt class="literal">:q</tt> to quit.
Check your <tt class="literal">$TERM</tt> environment variable, or
ask your system administrator to select
a terminal type for your environment.</p></li>

<li><p>
<em class="emphasis">A <tt class="literal">[new file]</tt> message appears when you think a file already
exists.</em>
<a name="IXT-1-280283" /></p>

<p>
You are probably in the wrong directory.
Enter <tt class="literal">:q</tt> to quit.  Then check to see that you are in the
correct directory for that file (enter <tt class="literal">pwd</tt> at the UNIX prompt).
If you are in the right directory, check the list of files in the directory
(with <tt class="literal">ls</tt>)
to see whether the file exists under a slightly different name.</p></li>

<li><p>
<em class="emphasis">You invoke </em>vi<em class="emphasis">, but you get a colon prompt
(indicating that you're in </em>ex<em class="emphasis"> line-editing mode).</em>
<a name="IXT-1-280284" />
<a name="IXT-1-280285" />
<a name="IXT-1-280286" /></p>

<p>
You probably typed an interrupt before <em class="emphasis">vi</em> could draw the screen.
Enter <em class="emphasis">vi</em> by typing <tt class="literal">vi</tt> at the <em class="emphasis">ex</em> prompt (<tt class="literal">:</tt>).</p></li>

<li><p>
<em class="emphasis">One of the following messages appears:</em>
<a name="IXT-1-280287" />
<a name="IXT-1-280288" />
<a name="IXT-1-280289" />
<a name="IXT-1-280290" /></p>



<blockquote><pre class="code">  [Read only]
  File is read only
  Permission denied</pre></blockquote>



<p>
"Read only" means that you can only look at the file; you cannot
save any changes you make.
<a name="IXT-1-280291" />
You may have invoked <em class="emphasis">vi</em> in <em class="emphasis">view mode</em> (with <tt class="literal">view</tt> or
<tt class="literal">vi -R</tt>), or you do not have write permission for the file.
See <a href="ch01_02.htm#vi6-ch-1-sect-2.1">Section 1.2.1</a> below.</p></li>

<li><p>
<em class="emphasis">One of the following messages appears:</em>
<a name="IXT-1-280292" />
<a name="IXT-1-280293" />
<a name="IXT-1-280294" />
<a name="IXT-1-280295" />
<a name="IXT-1-280296" />
<a name="IXT-1-280297" /></p>



<blockquote><pre class="code">  Bad file number
  Block special file
  Character special file
  Directory
  Executable
  Non-ascii file
  <em class="replaceable"><tt>file</tt></em> non-ASCII</pre></blockquote>



<p>
The file you've called up to edit is not a regular text file.
Type <tt class="literal">:q!</tt> to quit, then check the file you wish to edit,
perhaps with the <tt class="literal">file</tt> command.</p></li>

<li><p>
<em class="emphasis">When you type <tt class="literal">:q</tt> because of one of the above difficulties,
the message appears:</em>
<a name="IXT-1-280298" /></p>



<blockquote><pre class="code">  No write since last change (:quit! overrides).</pre></blockquote>



<p>
You have modified the file without realizing it.
Type <tt class="literal">:q!</tt> to leave <em class="emphasis">vi</em>.
Your changes from this session will not be saved in the file.</p></li>
</ul>
</div>




<a name="vi6-ch-1-sect-1.3" /><div class="sect2">
<h3 class="sect2">1.1.3. Modus Operandi </h3>

<p>
<a name="IXT-1-280299" />
As mentioned earlier,
the concept of the current "mode"
is fundamental to the way <em class="emphasis">vi</em> works.
<a name="IXT-1-280300" />
<a name="IXT-1-280301" />
There are two modes, <em class="emphasis">command mode</em>
and <em class="emphasis">insert mode</em>.
You start out in command mode, where every keystroke represents a
command.
In insert mode, everything you type becomes text in your file.</p>

<p>Sometimes, you can accidentally enter insert mode, or conversely, leave
insert mode accidentally. In either case, what you type will likely
affect your files in ways you did not intend.</p>

<p>
<a name="IXT-1-280302" />
<a name="IXT-1-280303" />
Press the
<span class="keycap">ESC</span>
key to force <em class="emphasis">vi</em> to enter command mode.
If you are already in command mode, <em class="emphasis">vi</em> will beep at you when
you press the
<span class="keycap">ESC</span>
key.
(Command mode is thus sometimes referred to as "beep mode.")</p>

<p>Once you are safely in command mode, you can proceed to repair any
accidental changes, and then continue editing your text.</p>
</div>




<a name="vi6-ch-1-sect-1.4" /><div class="sect2">
<h3 class="sect2">1.1.4. Saving and Quitting a File </h3>

<p>
<a name="ch01.saving" />
<a name="ch01.quitting" />
<a name="ch01.exiting" />
<a name="IXT-1-280304" />
<a name="IXT-1-280305" />
<a name="IXT-1-280306" />
You can quit working on a file at any time, save your edits
and return to the UNIX prompt.
The <tt class="literal">vi</tt> command to quit and save edits is <tt class="literal">ZZ</tt>. Note that <tt class="literal">ZZ</tt> is capitalized.</p>

<p>Let's assume that you do create a file called <em class="filename">practice</em> to
practice <em class="emphasis">vi</em> commands, and that you type in six lines of text.
To save the file, first check that you are in
command mode by pressing
<span class="keycap">ESC</span> and then enter <tt class="literal">ZZ</tt>.</p>

<table border="1" cellpadding="3">

<tr>
<th>Keystrokes</th>
<th>Results</th>
</tr>




<tr>
<td><tt class="literal">ZZ</tt></td>
<td><img src="figs/vi.0101.gif" alt="Figure " width="334" /><p>Give the write and save command, <tt class="literal">ZZ</tt>.
Your file is saved as a regular UNIX file.</p></td>
</tr>

<tr>
<td><tt class="literal">ls</tt></td>
<td><img src="figs/vi.0102.gif" alt="Figure " width="334" /><p>Listing the files in the directory shows the new file
<em class="filename">practice</em> that you created.</p></td>
</tr>


</table><p><p>
<p>
<a name="IXT-1-280307" />
<a name="IXT-1-280308" />
<a name="IXT-1-280309" />
You can also save your edits with
<em class="emphasis">ex</em> commands. Type <tt class="literal">:w</tt> to save your file but not quit
<em class="emphasis">vi</em>; type <tt class="literal">:q</tt> to quit if you haven't made any edits; and
type <tt class="literal">:wq</tt> to both save your edits and quit.
(<tt class="literal">:wq</tt> is equivalent to <tt class="literal">ZZ</tt>.)
We'll explain fully how to use commands in <a href="ch05_01.htm">Chapter 5</a>,
<em class="citetitle">Introducing the ex Editor</em>; for
now, you should just memorize a few commands for writing and saving
files.</p>
</div>
</div>

<hr width="684" align="left" />
<div class="navbar"><table width="684" border="0"><tr><td align="left" valign="top" width="228"><a href="part1.htm"><img src="../gifs/txtpreva.gif" alt="Previous" border="0" /></a></td><td align="center" valign="top" width="228"><a href="index.htm"><img src="../gifs/txthome.gif" alt="Home" border="0" /></a></td><td align="right" valign="top" width="228"><a href="ch01_02.htm"><img src="../gifs/txtnexta.gif" alt="Next" border="0" /></a></td></tr><tr><td align="left" valign="top" width="228">I. Basic and Advanced vi</td><td align="center" valign="top" width="228"><a href="index/index.htm"><img src="../gifs/index.gif" alt="Book Index" border="0" /></a></td><td align="right" valign="top" width="228">1.2. Quitting Without Saving Edits </td></tr></table></div>
<hr width="684" align="left" />

<img src="../gifs/navbar.gif" usemap="#library-map" border="0" alt="Library Navigation Links" />
<p><p><font size="-1"><a href="copyrght.htm">Copyright &copy; 2003</a> O'Reilly &amp; Associates. All rights reserved.</font></p>

<map name="library-map">
<area shape="rect" coords="1,0,88,96" href="../index.htm"><area shape="rect" coords="90,0,165,96" href="../upt/index.htm"><area shape="rect" coords="168,1,253,107" href="../mac/index.htm"><area shape="rect" coords="255,0,335,97" href="../korn/index.htm"><area shape="rect" coords="337,0,415,109" href="../unixnut/index.htm"><area shape="rect" coords="417,0,512,122" href="../sedawk/index.htm"><area shape="rect" coords="514,0,605,105" href="../lunix/index.htm"><area shape="rect" coords="611,2,694,121" href="../vi/index.htm">
      </map>

</body></html>