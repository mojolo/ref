<html><head><title>Improved Facilities (Learning the vi Editor, Sixth Edition)</title><link rel="stylesheet" type="text/css" href="../style/style1.css" />

<meta name="DC.Creator" content="Linda Lamb and Arnold Robbins" /><meta name="DC.Format" content="text/xml" scheme="MIME" /><meta name="DC.Language" content="en-US" /><meta name="DC.Publisher" content="O'Reilly &amp; Associates, Inc." /><meta name="DC.Source" scheme="ISBN" content="1-56592-426-6" /><meta name="DC.Subject.Keyword" content="stuff" /><meta name="DC.Title" content="Learning the vi Editor, Sixth Edition" /><meta name="DC.Type" content="Text.Monograph" />

</head><body bgcolor="#ffffff">

<img src="gifs/smbanner.gif" usemap="#banner-map" border="0" alt="Book Home" /><map name="banner-map"><area shape="rect" coords="1,-2,616,66" href="index.htm" alt="Learning the vi Editor" /><area shape="rect" coords="629,-11,726,25" href="jobjects/fsearch.htm" alt="Search this book" /></map>

<div class="navbar"><table width="684" border="0"><tr><td align="left" valign="top" width="228"><a href="ch08_05.htm"><img src="../gifs/txtpreva.gif" alt="Previous" border="0" /></a></td><td align="center" valign="top" width="228" /><td align="right" valign="top" width="228"><a href="ch08_07.htm"><img src="../gifs/txtnexta.gif" alt="Next" border="0" /></a></td></tr></table></div>



<h2 class="sect1">8.6. Improved Facilities</h2>

<p>
<a name="ch08.facil1" />
<a name="ch08.facil2" />
The four clones all provide additional features that make simple
text editing easier and more powerful.</p>

<dl>
<dt><i>Editing the ex command line</i></dt><dd>The ability to edit <em class="emphasis">ex</em></tt> mode commands as you
type them, possibly including a saved history of <em class="emphasis">ex</em></tt>
commands. Also, the ability to complete filenames and possibly other
things, such as commands and options.</p></dd>


<dt><i>No line length limit</i></dt><dd>The ability to edit lines of essentially arbitrary length.
Also, the ability to edit files containing any 8-bit character.</p></dd>


<dt><i>Infinite undo</i></dt><dd>The ability to successively undo all of the changes you've made
to a file.</p></dd>


<dt><i>Incremental searching</i></dt><dd>The ability to search for text while you are typing the search pattern.</p></dd>


<dt><i>Left/right scrolling</i></dt><dd>The ability to let long lines trail off the edge of screen
instead of wrapping.</p></dd>


<dt><i>Visual mode</i></dt><dd>The ability to select arbitrary contiguous chunks of texts upon which
some operation will be done.</p></dd>


<dt><i>Mode indicators</i></dt><dd>A visible indication of insert mode versus command mode,
as well as indicators of the current line and column.</p></dd>

</dl>

<a name="vi6-ch-8-sect-6.1" /><div class="sect2">
<h3 class="sect2">8.6.1. Command-Line History and Completion</h3>

<p>
<a name="IXT-8-281199" />
<a name="IXT-8-281200" />
<a name="IXT-8-281201" />
<a name="IXT-8-281202" />
<a name="IXT-8-281203" />
<a name="IXT-8-281204" />
Users of the <em class="emphasis">csh</em></tt>, <em class="emphasis">tcsh</em></tt>,
<em class="emphasis">ksh</em></tt>, and <em class="emphasis">bash</em></tt> shells have
known for years that being able to recall previous commands, edit them
slightly, and resubmit them makes them more productive.</p>

<p>This is no less true for editor users than it is for shell users;
unfortunately, UNIX <em class="emphasis">vi</em></tt> does not have any facility
to save and recall <em class="emphasis">ex</em></tt> commands.</p>

<p>This lack is remedied in each of the clones. Although each one
provides a different way of saving and recalling the command history,
each one's mechanism is usable and useful.</p>

<p>In addition to a command history, all of the editors can do
some kind of <em class="emphasis">completion</em></tt>.  This is where
you type the beginning of, for example, a filename.
You then type a special character
(such as tab), and the editor completes the filename for you.
All of the editors can do filename completion, some of them
can complete other things as well.
Details are provided in each editor's chapter.</p>
</div>




<a name="vi6-ch-8-sect-6.2" /><div class="sect2">
<h3 class="sect2">8.6.2. Arbitrary Length Lines and Binary Data</h3>

<p>
<a name="IXT-8-281205" />
<a name="IXT-8-281206" />
<a name="IXT-8-281207" />
<a name="IXT-8-281208" />
<a name="IXT-8-281209" />
All four clones can handle lines of any length.<a href="#FOOTNOTE-44">[44]</a>
Historic versions of <em class="emphasis">vi</em></tt> often
had limits of around 1,000 characters per line; longer lines
would be truncated.</p><blockquote class="footnote">

<a name="FOOTNOTE-44" /><p> [44]Well, up to the maximum value of a C <tt class="literal">long</tt>, 2,147,483,647.
</p>

</blockquote>

<p>All four are also 8-bit clean, meaning that they can edit files
containing any 8-bit character. It is even possible to edit
binary and/or executable files, if necessary.
This can be really useful, at times.
You may or may not have to tell each editor that a file is
binary.</p>

<dl>
<dt><i><em class="emphasis">nvi</em></tt></i></dt><dd>
<a name="IXT-8-281210" />
Automatically handles binary data. No special command-line
or <em class="emphasis">ex</em> options are required.</p></dd>


<dt><i><em class="emphasis">elvis</em></tt></i></dt><dd>
<a name="IXT-8-281211" />
Under UNIX, does not treat a binary file differently from any
other file. On other systems, it uses the <em class="filename">elvis.brf</em></tt>
file to set the <tt class="literal">binary</tt> option, to avoid
newline translation issues.
(The <em class="filename">elvis.brf</em></tt> file and <tt class="literal">hex</tt>
display modes are described in
<a href="ch10_10.htm#vi6-ch-10-sect-10">Section 10.10</a>.)</p></dd>


<dt><i><em class="emphasis">vim</em></tt></i></dt><dd>
<a name="IXT-8-281212" />
Does not have a limit on the length of a line.
When <tt class="literal">binary</tt> is not set, <em class="emphasis">vim</em> is
like <em class="emphasis">nvi</em>, and automatically handles binary data.
However, when
editing a binary file, you should either use the
<span class="option">-b</span> command-line option
or <tt class="literal">:set binary</tt>.
These set several other <em class="emphasis">vim</em> options that make it
easier to edit binary files.</p></dd>


<dt><i><em class="emphasis">vile</em></tt></i></dt><dd>
<a name="IXT-8-281213" />
Automatically handles binary data. No special command-line
or <em class="emphasis">ex</em></tt> options are required.</p></dd>

</dl>


<p>
<a name="IXT-8-281214" />
<a name="IXT-8-281215" />
Finally, there is one tricky detail.
Traditional <em class="emphasis">vi</em></tt> always writes the file with a
final newline appended.
When editing a binary file, this might add one character to
the file and cause problems.
<em class="emphasis">nvi</em></tt> and <em class="emphasis">vim</em></tt> are
compatible with <em class="emphasis">vi</em></tt> by default, and add that newline.
In <em class="emphasis">vim</em></tt> you can set the <tt class="literal">binary</tt> option,
so this doesn't happen.
<em class="emphasis">elvis</em></tt> and <em class="emphasis">vile</em></tt> never append
the extra newline.</p>


</div>




<a name="vi6-ch-8-sect-6.3" /><div class="sect2">
<h3 class="sect2">8.6.3. Infinite Undo</h3>

<p>
<a name="IXT-8-281216" />
<a name="IXT-8-281217" />
UNIX <em class="emphasis">vi</em></tt> allows you to undo only
your last change, or to restore the current line to the state it was
in before you started making any changes.
All of the clones provide "infinite undo," the ability
to keep undoing your changes, all the way back to the state the
file was in before you started <em class="emphasis">any</em></tt> editing.</p>
</div>




<a name="vi6-ch-8-sect-6.4" /><div class="sect2">
<h3 class="sect2">8.6.4. Incremental Searching</h3>

<p>
<a name="IXT-8-281218" />
<a name="IXT-8-281219" />
<a name="IXT-8-281220" />
When <em class="emphasis">incremental searching</em></tt> is used, the
editor moves the cursor through
the file, matching text <em class="emphasis">as you type</em></tt>
the search pattern.
When you finally type <span class="keycap">RETURN</span>,
the search is finished.<a href="#FOOTNOTE-45">[45]</a>
If you've never seen it before, it is rather disconcerting at first,
but after a while you get used to it.</p><blockquote class="footnote">

<a name="FOOTNOTE-45" /><p> [45]<em class="emphasis">emacs</em></tt> has always had incremental searching.</p>

</blockquote>

<p><em class="emphasis">elvis</em></tt> does
not support incremental searching.
<a name="IXT-8-281221" />
<a name="IXT-8-281222" />
<a name="IXT-8-281223" />
<em class="emphasis">nvi</em></tt> and <em class="emphasis">vim</em></tt> enable
incremental searching with an option, and <em class="emphasis">vile</em></tt> uses
two special <em class="emphasis">vi</em></tt> mode commands.
<em class="emphasis">vile</em></tt> can be compiled with incremental
searching disabled, but it is enabled by default. 
<a href="ch08_06.htm#vi6-ch-8-tab-6">Table 8.6</a> shows the options each editor provides.</p>

<a name="vi6-ch-8-tab-6" /><h4 class="objtitle">Table 8.6. Incremental Searching</h4><table border="1" cellpadding="3">

<tr>
<th>Editor</th>
<th>Option</th>
<th>Command</th>
<th>Action</th>
</tr>




<tr>
<td><em class="emphasis">nvi</em></tt></td>
<td><tt class="literal">searchincr</tt></td>
<td>&nbsp;</td>
<td><p>The cursor moves through the
<a name="IXT-8-281224" />
file as you type, always being placed on the first character of
the text that matches.</p></td>
</tr>

<tr>
<td><em class="emphasis">vim</em></tt></td>
<td><tt class="literal">incsearch</tt></td>
<td>&nbsp;</td>
<td><p>The cursor moves through the
<a name="IXT-8-281225" />
file as you type.
<em class="emphasis">vim</em></tt> highlights the text that matches what you've
typed so far.</p></td>
</tr>

<tr>
<td><em class="emphasis">vile</em></tt></td>
<td>&nbsp;</td>
<td><tt class="literal">^X S</tt>, <tt class="literal">^X R</tt></td>
<td><p>The cursor moves through the
<a name="IXT-8-281226" />
file as you type, always being placed on the first character of
the text that matches. <tt class="literal">^X S</tt> incrementally searches forward
through the file, while <tt class="literal">^X R</tt> incrementally searches
backward.</p></td>
</tr>


</table><p><p>
</div>




<a name="vi6-ch-8-sect-6.5" /><div class="sect2">
<h3 class="sect2">8.6.5. Left-Right Scrolling</h3>

<p>
<a name="IXT-8-281227" />
<a name="IXT-8-281228" />
<a name="IXT-8-281229" />
<a name="IXT-8-281230" />
<a name="IXT-8-281231" />
<a name="IXT-8-281232" />
By default, <em class="emphasis">vi</em></tt> and most of the clones
wrap long lines around the screen. Thus, a single logical line of the
file may occupy multiple physical lines on your screen.</p>

<p>There are times when it might be preferable if a long line simply
disappeared off the right-hand edge of the screen, instead of wrapping.
Moving onto that line and then moving to the right would "scroll"
the screen sideways. This feature is available in all of the clones.
Typically, a numeric option controls how much to scroll the screen,
and a Boolean option controls whether lines wrap or disappear off
the edge of the screen.
<em class="emphasis">vile</em></tt> also has command keys to perform sideways scrolling
of the entire screen. <a href="ch08_06.htm#vi6-ch-8-tab-7">Table 8.7</a> shows how to use 
horizontal scrolling with each editor.</p>

<a name="vi6-ch-8-tab-7" /><h4 class="objtitle">Table 8.7. Sideways Scrolling</h4><table border="1" cellpadding="3">

<tr>
<th>Editor</th>
<th>Scroll Amount</th>
<th>Option</th>
<th>Action</th>
</tr>




<tr>
<td><em class="emphasis">nvi</em></tt></td>
<td><tt class="literal">sidescroll = 16</tt></td>
<td><tt class="literal">leftright</tt></td>
<td><p>Off by default.
<a name="IXT-8-281233" />
<a name="IXT-8-281234" />
<a name="IXT-8-281235" />
When set, long lines simply go off the edge of the screen.
The screen scrolls left or right by 16 characters at a time.</p></td>
</tr>

<tr>
<td><em class="emphasis">elvis</em></tt></td>
<td><tt class="literal">sidescroll = 8</tt></td>
<td><tt class="literal">wrap</tt></td>
<td><p>Off by default.
<a name="IXT-8-281236" />
<a name="IXT-8-281237" />
When set, long lines simply go off the edge of the screen.
The screen scrolls left or right by 8 characters at a time.</p></td>
</tr>

<tr>
<td><em class="emphasis">vim</em></tt></td>
<td><tt class="literal">sidescroll = 0</tt></td>
<td><tt class="literal">wrap</tt></td>
<td><p>Off by default.
<a name="IXT-8-281238" />
When set, long lines simply go off the edge of the screen.
With <tt class="literal">sidescroll</tt> set to zero, each scroll puts the
cursor in the middle of the screen. Otherwise the screen scrolls by
the desired number of characters.</p></td>
</tr>

<tr>
<td><em class="emphasis">vile</em></tt></td>
<td><tt class="literal">sideways = 0</tt></td>
<td><tt class="literal">linewrap</tt></td>
<td><p>Off by default.
<a name="IXT-8-281239" />
<a name="IXT-8-281240" />
When set, long lines wrap. Thus, the default is to have long
lines go off the edge of the screen.
Long lines are marked at the left and right edges with
<tt class="literal">&lt;</tt> and <tt class="literal">&gt;</tt>.
With <tt class="literal">sideways</tt> set to zero, each scroll moves the
screen by <img src="figs/U2153.gif" alt="Figure " />.  Otherwise the screen scrolls by
the desired number of characters.</p></td>
</tr>

<tr>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td><tt class="literal">horizscroll</tt></td>
<td><p>On by default.
<a name="IXT-8-281241" />
When set, moving the cursor along a long line off-screen
shifts the whole screen. When not set, only the current line
shifts; this may be desirable on slower displays.</p></td>
</tr>


</table><p><p>

<p><em class="emphasis">vile</em></tt> has two additional commands,
<a name="IXT-8-281242" />
<tt class="literal">^X ^R</tt> and
<tt class="literal">^X ^L</tt>.
These two commands scroll the screen right and left, respectively,
leaving the cursor in its current location on the line.
You cannot scroll so far that the cursor position would
go off the screen.</p>
</div>




<a name="vi6-ch-8-sect-6.6" /><div class="sect2">
<h3 class="sect2">8.6.6. Visual Mode</h3>

<p>
<a name="IXT-8-281243" />
<a name="IXT-8-281244" />
Typically, operations in <em class="emphasis">vi</em></tt> apply to units
of text such lines, words, or characters, or to sections of text
from the current cursor position to a position specified by a
search command. For example, <tt class="literal">d/^}</tt> deletes
up to the next line that starts with a right brace.
<em class="emphasis">elvis</em></tt>, <em class="emphasis">vim</em></tt>, and <em class="emphasis">vile</em></tt>
all provide a mechanism to explicitly select a region of text
to which an operation will apply. In particular, it is possible
to select a rectangular block of text and apply an operation
to all the text within the rectangle!
See each editor's respective chapter for the details.</p>
</div>




<a name="vi6-ch-8-sect-6.7" /><div class="sect2">
<h3 class="sect2">8.6.7. Mode Indicators</h3>

<p>
<a name="IXT-8-281245" />
<a name="IXT-8-281246" />
<a name="IXT-8-281247" />
As you know by now, <em class="emphasis">vi</em></tt> has two modes, command mode
and insert mode. Usually, you can't tell by looking at the screen
which mode you're in.
Furthermore, often it's useful to know where in the file you
are, without having to use the <tt class="literal">^G</tt> or
<em class="emphasis">ex</em></tt> <tt class="literal">:=</tt> commands.</p>

<p>
<a name="IXT-8-281248" />
<a name="IXT-8-281249" />
Two options address these issues, <tt class="literal">showmode</tt>
and <tt class="literal">ruler</tt>.  All four clones agree
on the option names and meanings, and even Solaris <em class="emphasis">vi</em></tt>
has the <tt class="literal">showmode</tt> option.</p>

<p><a href="ch08_06.htm#vi6-ch-8-tab-8">Table 8.8</a>
lists the special features in each editor.</p>

<a name="vi6-ch-8-tab-8" /><h4 class="objtitle">Table 8.8. Position and Mode Indicators</h4><table border="1" cellpadding="3">

<tr>
<th>Editor</th>
<th>With ruler, displays</th>
<th>With showmode, displays</th>
</tr>




<tr>
<td><em class="emphasis">nvi</em></tt></td>
<td>row and column</td>
<td><p>insert, change, replace, and command mode indicators
<a name="IXT-8-281250" /></p></td>
</tr>

<tr>
<td><em class="emphasis">elvis</em></tt></td>
<td>row and column</td>
<td><p>input and command mode indicators
<a name="IXT-8-281251" /></p></td>
</tr>

<tr>
<td><em class="emphasis">vim</em></tt></td>
<td>row and column</td>
<td><p>insert, replace, and visual mode indicators
<a name="IXT-8-281252" /></p></td>
</tr>

<tr>
<td><em class="emphasis">vile</em></tt></td>
<td>row, column, and percent of file</td>
<td><p>insert, replace, and overwrite mode indicators
<a name="IXT-8-281253" /></p></td>
</tr>

<tr>
<td><em class="emphasis">vi</em></tt></td>
<td>N/A</td>
<td><p>separate mode indicators for open, input, insert, append, change,
replace, replace one character, and substitute modes</p></td>
</tr>


</table><p><p>

<p>The GUI versions of <em class="emphasis">elvis</em></tt> and <em class="emphasis">vim</em></tt>
change the cursor shape depending upon the current mode.</p>
</div>




<a name="IXT-8-281254" />
<a name="IXT-8-281255" />


<hr width="684" align="left" />
<div class="navbar"><table width="684" border="0"><tr><td align="left" valign="top" width="228"><a href="ch08_05.htm"><img src="../gifs/txtpreva.gif" alt="Previous" border="0" /></a></td><td align="center" valign="top" width="228"><a href="index.htm"><img src="../gifs/txthome.gif" alt="Home" border="0" /></a></td><td align="right" valign="top" width="228"><a href="ch08_07.htm"><img src="../gifs/txtnexta.gif" alt="Next" border="0" /></a></td></tr><tr><td align="left" valign="top" width="228">8.5. Enhanced Tags</td><td align="center" valign="top" width="228"><a href="index/index.htm"><img src="../gifs/index.gif" alt="Book Index" border="0" /></a></td><td align="right" valign="top" width="228">8.7. Programming Assistance</td></tr></table></div>
<hr width="684" align="left" />

<img src="../gifs/navbar.gif" usemap="#library-map" border="0" alt="Library Navigation Links" />
<p><p><font size="-1"><a href="copyrght.htm">Copyright &copy; 2003</a> O'Reilly &amp; Associates. All rights reserved.</font></p>

<map name="library-map">
<area shape="rect" coords="1,0,88,96" href="../index.htm"><area shape="rect" coords="90,0,165,96" href="../upt/index.htm"><area shape="rect" coords="168,1,253,107" href="../mac/index.htm"><area shape="rect" coords="255,0,335,97" href="../korn/index.htm"><area shape="rect" coords="337,0,415,109" href="../unixnut/index.htm"><area shape="rect" coords="417,0,512,122" href="../sedawk/index.htm"><area shape="rect" coords="514,0,605,105" href="../lunix/index.htm"><area shape="rect" coords="611,2,694,121" href="../vi/index.htm">
</map>

</body></html>